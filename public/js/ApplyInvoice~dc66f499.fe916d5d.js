(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ApplyInvoice~dc66f499"],{5281:function(e,t,a){"use strict";var i=a("f977"),n=a.n(i);n.a},b3df:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout_card"},[a("div",{staticClass:"breadcrumb"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("i",{staticClass:"iconfont icon-fapiao"}),e._v(" 发票管理 ")])],1)],1),a("div",{staticClass:"box custom-tabs"},[a("el-tabs",{model:{value:e.tabActiveName,callback:function(t){e.tabActiveName=t},expression:"tabActiveName"}},[a("el-tab-pane",{attrs:{label:"发票列表",name:"invoiceList"}},["invoiceList"===e.tabActiveName?a("invoiceList",{attrs:{currency:e.currency}}):e._e()],1),a("el-tab-pane",{attrs:{label:"发票抬头",name:"invoiceInfo"}},["invoiceInfo"===e.tabActiveName?a("invoiceInfo"):e._e()],1),a("el-tab-pane",{attrs:{label:"收货地址",name:"invoiceAddress"}},["invoiceAddress"===e.tabActiveName?a("invoiceAddress"):e._e()],1)],1)],1)])},n=[],s=(a("96cf"),a("1da1")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("div",{staticClass:"font-12 color-999 mb-10"},[e._v("在此处可查看已开具的发票信息")]),a("el-button",{staticClass:"custom_btn",attrs:{size:"small",type:"success"},on:{click:e.invoiceApply}},[e._v("发票申请")]),a("el-table",{attrs:{height:e.$height-298,data:e.tableData,"row-class-name":"iRowClass","cell-class-name":"iCellClass","header-row-class-name":"iHeaderRowClass","header-cell-class-name":"iHeaderCellClass"},on:{"sort-change":e.sortChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.tableData.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),e.tableData.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"create_time",label:"申请时间",align:"center",width:"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e.$moment(1e3*a.create_time).format("YYYY-MM-DD HH:mm")))]}}])}),a("el-table-column",{attrs:{prop:"title",label:"发票抬头",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"issue_type_zh",label:"发票性质",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"amount",label:"发票总额",width:"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e.currency.prefix+a.amount+e.currency.suffix)+" ")]}}])}),a("el-table-column",{attrs:{prop:"status_zh",label:"发票状态",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"province",label:"邮寄地址"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.province+a.city+a.region+a.detail)+" ")]}}])}),a("el-table-column",{attrs:{prop:"name",label:"快递",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"notes",label:"备注"}}),a("el-table-column",{attrs:{label:"操作",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{staticClass:"table_btn",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getInvoiceDetail(i.id)}}},[e._v("查看")]),"Unpaid"===i.status?a("el-button",{staticClass:"table_btn",attrs:{type:"success",size:"small"},on:{click:function(t){return e.payHandleClick(i.invoice_id)}}},[e._v("支付")]):e._e()]}}])})],1),a("div",{staticClass:"mt-10"},[a("el-pagination",{attrs:{background:"","current-page":e.search.page,"page-size":e.search.limit,"page-sizes":[10,15,20,25],total:e.total,layout:"total,sizes,prev,pager,next","prev-text":e.$t("Previous"),"next-text":e.$t("Nextpage")},on:{"size-change":e.handleSizeChange,"current-change":e.getData,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)},"update:pageSize":function(t){return e.$set(e.search,"limit",t)},"update:page-size":function(t){return e.$set(e.search,"limit",t)}}})],1),a("el-dialog",{attrs:{visible:e.invoiceDetailDialog,title:"发票详情",width:"700px"},on:{"update:visible":function(t){e.invoiceDetailDialog=t}}},[a("div",{staticClass:"custom_body"},[a("div",{staticClass:"mb-10"},[a("label",{staticClass:"color-999"},[e._v("开具类型：")]),a("span",{staticClass:"ml-10"},[e._v(e._s(e.invoiceDetail.voucher.issue_type_zh))])]),a("div",{staticClass:"mb-10 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[e._v("抬头信息：")]),a("span",{staticClass:"ml-10"},[e._v(e._s(e.invoiceDetail.voucher.title))])]),a("div",{staticClass:"fl ml-20",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[e._v("快递信息：")]),a("span",{staticClass:"ml-10"},[e._v(e._s(e.invoiceDetail.voucher.name))])])]),a("div",{staticClass:"mb-20"},[a("label",{staticClass:"color-999"},[e._v("邮寄地址：")]),a("span",{staticClass:"ml-10"},[e._v(e._s(e.invoiceDetail.voucher.province+e.invoiceDetail.voucher.city+e.invoiceDetail.voucher.region+e.invoiceDetail.voucher.detail))])]),a("el-table",{attrs:{data:e.invoiceDetail.invoices,height:"300",border:"","header-row-class-name":"innerTableHeader","row-class-name":"innerTableRowClass","cell-class-name":"innerTableCellClass"},on:{"sort-change":e.sortChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.invoiceDetail.invoices.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),e.invoiceDetail.invoices.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"description",label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.items,(function(t,i){return a("pre",{key:i+"subitem",staticClass:"color-999"},[e._v(e._s(t.description))])}))}}])}),a("el-table-column",{attrs:{prop:"subtotal",label:"金额",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e.currency.prefix)+e._s(parseFloat(a.subtotal).toFixed(2)))]}}])}),a("el-table-column",{attrs:{prop:"taxed",label:"税率",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"taxed_amount",label:"税额",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(e._s(e.currency.prefix)+e._s(parseFloat(a.taxed_amount).toFixed(2)))]}}])})],1),a("div",{staticClass:"flex-between mt-20"},[a("div",[e._v("开发票扣税："+e._s(e.currency.prefix)+e._s(parseFloat(e.invoiceDetail.voucher_amount).toFixed(2))+" + 发票邮寄快递费用"+e._s(e.currency.prefix)+e._s(e.invoiceDetail.voucher.price))]),a("div",[a("el-button",{staticClass:"custom_dialog_btn default",attrs:{size:"small"},on:{click:function(t){e.invoiceDetailDialog=!1}}},[e._v("关闭 ")])],1)])],1)]),a("payNew",{ref:"control",attrs:{title:"支付"},on:{"pay-success":e.successCallBack,close:e.dialogClosed}})],1)},l=[],c=(a("ac1f"),a("841c"),a("3fe4")),o={props:{currency:{type:Object,default:function(){return{prefix:"¥",suffix:"元"}}}},data:function(){return{tableData:[],search:{page:1,limit:10,order:"",sort:"desc"},total:0,tableLoading:!1,invoiceDetailDialog:!1,invoiceDetail:{voucher:{},invoices:[]}}},created:function(){this.getData()},mounted:function(){},methods:{invoiceApply:function(){this.$router.push({name:"invoiceApply"})},getData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(c["j"])(e.search);case 3:if(a=t.sent,i=a.data,e.tableLoading=!1,200===i.status){t.next=8;break}return t.abrupt("return",!1);case 8:e.tableData=i.data.voucher,e.total=i.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.search.page=1,this.getData()},sortChange:function(e,t,a){this.search.order=e.prop,"ascending"===e.order?this.search.sort="asc":this.search.sort="desc",this.getData()},getInvoiceDetail:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.invoiceDetailDialog=!0,t.tableLoading=!0,a.next=4,Object(c["e"])({id:e});case 4:i=a.sent,n=i.data,t.tableLoading=!1,200!==n.status?t.$message.error(n.msg):t.invoiceDetail=n.data;case 8:case"end":return a.stop()}}),a)})))()},payHandleClick:function(e){this.$refs.control.main({id:e,name:"结算"})},successCallBack:function(e){e&&this.getData()},dialogClosed:function(){this.getData()}},computed:{},watch:{}},u=o,d=a("2877"),p=Object(d["a"])(u,r,l,!1,null,"780ef199",null),v=p.exports,b=a("65b2"),m=a("f3c3"),f={metaInfo:function(){return{title:"申请发票"}},components:{invoiceList:v,invoiceInfo:b["a"],invoiceAddress:m["a"]},data:function(){return{tabActiveName:this.$route.query.type?"invoiceInfo":"invoiceList",currency:{}}},created:function(){this.getCurrency()},mounted:function(){},methods:{getCurrency:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["d"])();case 2:a=t.sent,i=a.data,200!==i.status?e.$message.error(i.msg):e.currency=i.data.currency;case 5:case"end":return t.stop()}}),t)})))()}},computed:{},watch:{}},h=f,g=(a("5281"),Object(d["a"])(h,i,n,!1,null,"0443df3c",null));t["default"]=g.exports},f977:function(e,t,a){}}]);