(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendors~StandaloneServer~StandaloneServerTraffic~0174a5b3"],{"00df":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("6ddc");(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="donut",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=s["a"].getDefaultOptions})(a["a"])},"0704":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("a5f3"),r=i("9bc0"),p=i("9ba2"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="histogram",e}return Object(n["__extends"])(e,t),e.prototype.init=function(){this.options.xField="range",this.options.yField="count",t.prototype.init.call(this)},e.prototype.processData=function(t){var e=this,i=this.options,n=i.binField,a=i.binWidth,s=i.binNumber,p=Object(o["clone"])(t);Object(o["sortBy"])(p,n);var l=Object(o["valuesOfKey"])(p,n),c=Object(o["getRange"])(l),h=c.max-c.min,u=a;if(!a&&s&&(u=h/s),!a&&!s){var d=Object(r["i"])(l);u=h/d}var f={};Object(o["each"])(p,(function(t){var i=t[n],a=e.getBin(i,u),s=a[0]+"-"+a[1];Object(o["hasKey"])(f,s)||(f[s]={name:s,range:a,count:0,data:[]}),f[s].data.push(t),f[s].count+=1}));var g=[];return Object(o["each"])(f,(function(t){g.push(t)})),g},e.prototype.scale=function(){t.prototype.scale.call(this);var e=this.config.scales.range;e.nice=!1,e.type="linear"},e.prototype.getBin=function(t,e){var i=Math.floor(t/e);return[e*i,e*(i+1)]},e}(p["a"]),c=l;Object(s["b"])("histogram",l);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="histogram",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=c.getDefaultOptions})(a["a"])},"107e":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("77e3");(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="groupedBar",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=s["a"].getDefaultOptions})(a["a"])},3632:function(t,e,i){"use strict";var n={};i.r(n),i.d(n,"EVENT_MAP",(function(){return c["b"]})),i.d(n,"onEvent",(function(){return c["e"]}));var o=i("9ab4"),a=i("8937"),s=i("a5f3"),r=i("25ee"),p=i("fc76"),l=i("3bea"),c=i("61fd"),h={range:"point",statistic:"annotation-text"},u=Object(c["d"])(h);Object(a["assign"])(c["b"],u);var d=function(t){function e(e){var i=t.call(this,e)||this;return i.type="gauge",i}return Object(o["__extends"])(e,t),e.getDefaultOptions=function(){return Object(a["deepMix"])({},t.getDefaultOptions.call(this),{startAngle:-7/6,endAngle:1/6,rangeBackgroundStyle:{fill:"#f0f0f0"},rangeSize:24,statistic:{position:["50%","80%"]},axis:{visible:!0,offset:-10,tickCount:21,subTickCount:4,tickLine:{visible:!0,length:5,style:{stroke:"#aaa",lineWidth:2}},label:{visible:!0,style:{fill:"#aaa",fontSize:16,textAlign:"center",textBaseline:"middle"}}},pivot:{visible:!0,thickness:6,pin:{visible:!0,size:2,style:{fill:"#2E364B"}},base:{visible:!0,style:{fill:"#EEEEEE"}},pointer:{visible:!0,style:{fill:"#CFCFCF"}}}})},e.prototype.init=function(){var e=this.options,i=e.value,n=e.range,o=(n||[]).map((function(t){return+t})).sort((function(t,e){return t-e})),a=this.options,s=a.min,r=void 0===s?o[0]:s,p=a.max,l=void 0===p?o[o.length-1]:p,c=a.format,h=void 0===c?function(t){return""+t}:c,u=h(i);this.options.data=[{value:i||0}],this.options.valueText=u,this.options.min=r,this.options.max=l,this.options.format=h,this.initG2Shape(),t.prototype.init.call(this)},e.prototype.initG2Shape=function(){this.gaugeShape=new l["a"](Object(a["uniqueId"])()),this.gaugeShape.setOption(this.type,Object(a["deepMix"])({},this.options,{radius:.6,angle:240,textPosition:"100%"})),this.gaugeShape.render()},e.prototype.geometryParser=function(){return"gauge"},e.prototype.scale=function(){var e=this.options,i=e.min,n=e.max,o=e.format,a={value:{}};Object(p["a"])(a.value,{min:i,max:n,minLimit:i,maxLimit:n,nice:!0,formatter:o,tickInterval:20}),this.setConfig("scales",a),t.prototype.scale.call(this)},e.prototype.coord=function(){var t={type:"polar",cfg:{radius:1,startAngle:this.options.startAngle*Math.PI,endAngle:this.options.endAngle*Math.PI}};this.setConfig("coordinate",t)},e.prototype.axis=function(){var t,e=this.options.axis,i={value:{line:null,grid:null,tickLine:null}};t=e.offset<0?e.offset-this.options.rangeSize-e.tickLine.length:e.offset+e.tickLine.length,e.label.visible?i.value.label={offset:t,textStyle:e.label.style,autoRotate:!0}:i.value.label={style:{opacity:0}},i["1"]=!1,this.setConfig("axes",i)},e.prototype.addGeometry=function(){var t=this.options.pivot.pointer.style.fill||this.theme.defaultColor,e={type:"point",position:{fields:["value","1"]},shape:{values:["gauge"]},color:{values:[t]}};this.setConfig("geometry",e)},e.prototype.annotation=function(){var t=this.options.statistic,e=[];if(t&&t.visible){var i=this.renderStatistic();e.push(i)}this.setConfig("annotations",e)},e.prototype.renderStatistic=function(){var t=Math.max(this.options.width,this.options.height)/20,e=this.options.statistic,i={type:"text",content:e.text,top:!0,position:e.position,style:{fill:e.color,fontSize:e.size?e.size:1.2*t,textAlign:"center",textBaseline:"middle"}};return i},e.prototype.parseEvents=function(){t.prototype.parseEvents.call(this,n)},e}(r["a"]);e["a"]=d;Object(s["b"])("gauge",d)},"3bea":function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i("9ab4"),o=i("8937"),a=i("917c"),s=i("b7cb"),r=i("2a7d"),p=function(){function t(t){this.uid=t}return t.prototype.setOption=function(t,e){this.type=t,this.options=e,this.axis=e.axis,this.pivot=e.pivot},t.prototype.render=function(){var t=this;Object(a["h"])("point","gauge",{draw:function(e,i){this.gauge={},this.gauge.options=t.options,this.gauge.axis=t.axis,this.gauge.pivot=t.pivot,this.gauge.type=t.type;var n=this.gauge,o=this.gauge.type,a=e.points[0],s=this.parsePoint({x:0,y:0}),r=this.parsePoint({x:a.x||0,y:1});n.center=s,n.group=i;var p={x:s.x-r.x,y:s.y-r.y};this.gauge.ringRadius=Math.sqrt(p.x*p.x+p.y*p.y);var l=this.getAngleRange(),c=l.starAngle,h=l.endAngle,u=a.x*(h-c)+c;switch(o){case"meterGauge":this.drawBarGauge(u),this.gauge.axis.visible&&this.drawInSideAxis();break;case"fanGauge":this.drawGauge(u),this.gauge.axis.visible&&this.drawOutSideAxis();break;case"standardGauge":default:this.drawGauge(u),this.gauge.axis.visible&&this.drawAxis();break}this.gauge.pivot.visible&&this.drawPivot(e,i)},drawGauge:function(t){var e=this.gauge.options.range;this.drawBottomRing(),e&&e.length?this.drawRangeColor():this.drawCurrentRing(t)},drawRangeColor:function(){for(var t=this.gauge.options,e=t.min,i=t.max,n=t.range,a=t.color,r=t.rangeStyle,p=a||Object(s["b"])().colors,l=this.getAngleRange(),c=l.starAngle,h=l.endAngle,u={min:e,max:i,starAngle:c,endAngle:h},d=0;d<n.length;d++){var f=this.valueToAngle(n[d],u),g=this.valueToAngle(n[d+1],u);if(g>=f){var y=this.getPath(f,g),v=Object(o["deepMix"])({fill:p[d]},r);this.drawRing(y,v)}}},drawBottomRing:function(){var t=this.getAngleRange(),e=t.starAngle,i=t.endAngle,n=this.gauge.options.rangeBackgroundStyle,o=this.getPath(e,i);this.drawRing(o,n)},drawCurrentRing:function(t){var e=this.getAngleRange().starAngle,i=this.gauge.ringStyle.color,n=this.getPath(e,t);this.drawRing(n,i)},drawInSideAxis:function(){for(var t=this.gauge.options,e=t.min,i=t.max,n=t.axis,o=this.getAngleRange(),a=o.starAngle,s=o.endAngle,r={min:e,max:i,starAngle:a,endAngle:s},p=(i-e)/n.tickCount,l=0;l<n.tickCount;l++){var c=e+l*p,h=this.valueToAngle(c+p/2,r);this.drawRect(h,{length:n.tickLine.length,style:n.tickLine.style})}},drawAxis:function(){for(var t=this.gauge.axis,e=this.gauge.options,i=e.min,n=e.max,a=this.getAngleRange(),s=a.starAngle,r=a.endAngle,p={min:i,max:n,starAngle:s,endAngle:r},l=(n-i)/(t.tickCount-1),c=0;c<t.tickCount;c++){var h=i+c*l,u=this.valueToAngle(h,p),d=Object(o["clone"])(t.tickLine.style);c%5!==0&&(d.lineWidth=d.lineWidth/2),this.drawRect(u,{length:c%5===0?t.tickLine.length:t.tickLine.length/2,style:d})}},drawOutSideAxis:function(){for(var t=this.gauge.axis,e=this.gauge.options,i=e.min,n=e.max,o=this.getAngleRange(),a=o.starAngle,s=o.endAngle,r={min:i,max:n,starAngle:a,endAngle:s},p=(n-i)/(t.tickCount-1),l=0;l<t.tickCount;l++){var c=i+l*p,h=this.valueToAngle(c,r);this.drawRect(h,{length:t.tickLine.length,style:t.tickLine.style})}},drawBarGauge:function(t){for(var e=this,i=this.gauge.options,n=i.min,a=i.max,p=i.range,l=i.color,c=i.rangeStyle,h=i.rangeBackgroundStyle,u=l||Object(s["b"])().colors,d=this.getAngleRange(),f=d.starAngle,g=d.endAngle,y={min:n,max:a,starAngle:f,endAngle:g},v=(g-f)/49,m=v/3,b=0;b<50;b++){var x=f+b*v,O=this.getPath(x-m/2,x+m-m/2),j=h;if(p&&p.length){var _=p.map((function(t){return e.valueToAngle(t,y)})),S=Object(r["e"])(_,x),C=Math.min(S,p.length-1);j=Object(o["deepMix"])({},{fill:u[C-1]},c)||h}else j=t>=x?Object(o["deepMix"])({},{fill:l},c):h;this.drawRing(O,j)}},getAngleRange:function(){var t=this.gauge.options.angle,e=90-.5*(360-t),i=(180-e)*Math.PI/180,n=(360+e)*Math.PI/180;return{starAngle:i,endAngle:n}},valueToAngle:function(t,e){var i=e.min,n=e.max,o=e.starAngle,a=e.endAngle;if(t===n)return a;if(t===i)return o;var s=(t-i)/(n-i);n===i&&(s=1);var r=s*(a-o)+o;return r=Math.max(r,o),r=Math.min(r,a),r},drawRing:function(t,e){this.gauge.group.addShape("path",{attrs:Object(o["deepMix"])({},{path:t},e)})},drawRect:function(t,e){var i,a=this.gauge.axis,s=Object(n["__assign"])(Object(n["__assign"])({},a),e),r=s.offset,p=s.length,l=this.gauge.center;i=r<0?this.gauge.ringRadius-this.gauge.options.rangeSize+r:this.gauge.ringRadius+r;var c=i*Math.cos(t)+l.x,h=i*Math.sin(t)+l.y,u=(i+p)*Math.cos(t)+l.x,d=(i+p)*Math.sin(t)+l.y;this.gauge.group.addShape("line",{attrs:Object(o["deepMix"])({},{x1:c,y1:h,x2:u,y2:d},e.style)})},getPath:function(t,e){var i=this.gauge.center,n=this.gauge.ringRadius,o=this.gauge.options.rangeSize,a=n*Math.cos(t)+i.x,s=n*Math.sin(t)+i.y,r=(n-o)*Math.cos(t)+i.x,p=(n-o)*Math.sin(t)+i.y,l=n*Math.cos(e)+i.x,c=n*Math.sin(e)+i.y,h=(n-o)*Math.cos(e)+i.x,u=(n-o)*Math.sin(e)+i.y,d=Math.abs(t-e)>Math.PI?1:0;return[["M",a,s],["A",n,n,0,d,1,l,c],["L",h,u],["A",n-o,n-o,0,d,0,r,p],["Z"]]},drawPivot:function(t){var e=this.getAngleRange(),i=e.starAngle,n=e.endAngle,a=this.gauge.options,s=a.radius,r=a.rangeSize,p=this.gauge.pivot,l=p.thickness,c=p.thickness/2.5,h=this.gauge.group,u=t.points[0],d=this.parsePoint({x:0,y:0}),f=u.x*(n-i)+i,g=(this.gauge.ringRadius-r)*s*Math.cos(f)+this.gauge.center.x,y=(this.gauge.ringRadius-r)*s*Math.sin(f)+this.gauge.center.y,v={x:g,y:y};if(p.base.visible&&h.addShape("circle",{attrs:Object(o["deepMix"])({},{x:d.x,y:d.y,r:p.base.size?p.base.size/2:2.2*l},p.base.style)}),p.pointer.visible){var m={x:d.x-v.x,y:d.y-v.y},b=Math.sqrt(m.x*m.x+m.y*m.y);m.x*=1/b,m.y*=1/b;var x=-Math.PI/2,O=Math.cos(x)*m.x-Math.sin(x)*m.y,j=Math.sin(x)*m.x+Math.cos(x)*m.y,_=Math.PI/2,S=Math.cos(_)*m.x-Math.sin(_)*m.y,C=Math.sin(_)*m.x+Math.cos(_)*m.y,w=[["M",v.x+O*c,v.y+j*c],["L",d.x+O*l,d.y+j*l],["L",d.x+S*l,d.y+C*l],["L",v.x+S*c,v.y+C*c],["Z"]];h.addShape("path",{attrs:Object(o["deepMix"])({},{path:w},p.pointer.style)}),h.addShape("circle",{attrs:{x:v.x,y:v.y,r:c,fill:p.pointer.style.fill}}),h.addShape("circle",{attrs:{x:d.x,y:d.y,r:l,fill:p.pointer.style.fill}})}p.pin.visible&&h.addShape("circle",{attrs:Object(o["deepMix"])({},{x:d.x,y:d.y,r:c/1.2},p.pin.style)})}})},t}()},"4f7b":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("a5f3"),r=i("3632"),p=i("3bea"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="fanGauge",e}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(){return Object(o["deepMix"])({},t.getDefaultOptions.call(this),{rangeColor:"#F6445A",rangeSize:70,axis:{visible:!0,offset:5,tickCount:10,subTickCount:4,tickLine:{visible:!0,length:3,style:{stroke:"#aaa",lineWidth:3}},label:{visible:!0,style:{fill:"#aaa",fontSize:16,textAlign:"center",textBaseline:"middle"}}}})},e.prototype.initG2Shape=function(){this.gaugeShape=new p["a"](Object(o["uniqueId"])()),this.gaugeShape.setOption(this.type,Object(o["deepMix"])({},this.options,{radius:1,angle:120,textPosition:"125%",bottomRatio:3.5})),this.gaugeShape.render()},e.prototype.axis=function(){var t={value:!1,1:!1};this.setConfig("axes",t)},e.prototype.annotation=function(){var t=this.options.statistic,e=[];if(t&&t.visible){var i=this.renderStatistic();e.push(i)}var n=this.renderSideText(),o=e.concat(n);this.setConfig("annotations",o)},e.prototype.renderSideText=function(){var t=this.options,e=t.max,i=t.min,n=t.format,a=t.rangeSize,s=t.axis,r=12;return[i,e].map((function(t,e){return{type:"text",top:!0,position:["50%","50%"],content:n(t),style:Object(o["deepMix"])({},s.label.style,{textAlign:"center"}),offsetX:e?a:-a,offsetY:r}}))},e}(r["a"]),c=l;Object(s["b"])("fanGauge",l);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="fanGauge",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=c.getDefaultOptions})(a["a"])},"5e91":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("3632");(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="gauge",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=s["a"].getDefaultOptions})(a["a"])},"627c":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("750b");(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="groupedColumn",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=s["a"].getDefaultOptions})(a["a"])},"68bc":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("7c8a"),r=i("f999"),p=i("a5f3"),l=i("25ee"),c=i("7135"),h=i("b7cb"),u=function(t){var e=t.opacity||1;return{opacity:.5*e}},d=function(t){var e=t.opacity||1;return{opacity:.5*e}};Object(h["d"])("funnel",{columnStyle:{normal:{},active:u,disable:d,selected:{lineWidth:1,stroke:"black"}}});var f=i("917c"),g=i("7e08");function y(t,e){void 0===e&&(e=!1);var i,n,a,s,r=t.x,p=t.y,l=t.y0,c=t.size;Object(o["isArray"])(p)?(i=p[0],n=p[1]):(i=l,n=p),Object(o["isArray"])(r)?(a=r[0],s=r[1]):(a=r-c/2,s=r+c/2);var h=[{x:a,y:i},{x:a,y:n}];return e?h.push({x:s,y:(n+i)/2}):h.push({x:s,y:n},{x:s,y:i}),h}function v(t,e){var i=[],n=t.points,a=t.nextPoints;if(e){var s=e.yValues,r=e.yValuesMax,p=e.yValuesNext,l=(n[0].y+n[1].y)/2,c=s[0]+s[1],h=s.map((function(t){return t/c/.5})),u=.9*(r[0]/(r[0]+r[1])-.5),d=.001;if(Object(o["isNil"])(a))i.push(["M",n[0].x,u+(n[0].y-l)*h[0]+l],["L",n[1].x,u+l],["L",n[2].x,u+l],["L",n[3].x,u+(n[3].y-l)*h[0]+l],["Z"]),i.push(["M",n[0].x,u+.002+l],["L",n[1].x,u+.002+(n[1].y-l)*h[1]+l],["L",n[2].x,u+.002+(n[2].y-l)*h[1]+l],["L",n[3].x,u+.002+l],["Z"]);else{var f=p[0]+p[1],g=p.map((function(t){return t/f/.5}));i.push(["M",n[0].x,u+(n[0].y-l)*h[0]+l-d],["L",n[1].x,u+l-d],["L",a[1].x,u+l-d],["L",a[0].x,u+(a[3].y-l)*g[0]+l-d],["Z"]),i.push(["M",n[0].x,u+l+d],["L",n[1].x,u+(n[1].y-l)*h[1]+l+d],["L",a[1].x,u+(a[2].y-l)*g[1]+l+d],["L",a[0].x,u+l+d],["Z"])}}else Object(o["isNil"])(a)?i.push(["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],["L",n[2].x,n[2].y],["L",n[3].x,n[3].y],["Z"]):i.push(["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],["L",a[1].x,a[1].y],["L",a[0].x,a[0].y],["Z"]);return i}function m(t,e,i){return(1-i)*t+i*e}function b(t,e){var i=e.reverse,n=e.ratioUpper,o=e.ratioLower,a=[],s=t[0],r=(t[1].x+t[2].x)/2,p=1.2,l=.6;if(i){var c=o;o=n,n=c}var h=(s.x-r)*m(l,p,o)+r;a.push(["M",h,s.y]);for(var u=1,d=t.length;u<d;u++){var f=t[u].x;switch(u){case 1:case 2:f=(f-r)*m(l,p,n)+r;break;case 3:f=(f-r)*m(l,p,o)+r;break}a.push(["L",f,t[u].y])}return a.push(["L",h,s.y]),a.push(["z"]),a}Object(f["h"])("interval","funnel-basic-rect",{getPoints:function(t){return t.size=1.8*t.size,y(t)},draw:function(t,e){var i,a=Object(g["getStyle"])(t,!1,!0),s=Object(o["get"])(t,"data.__compare__"),r=this.parsePath(v(t,s));return e.addShape("path",(i={name:"interval",attrs:Object(n["__assign"])(Object(n["__assign"])({},a),{path:r})},i["__compare__"]=s,i))},getMarker:function(t){var e=t.color;return{symbol:"square",style:{r:4,fill:e}}}}),Object(f["h"])("interval","funnel-dynamic-rect",{draw:function(t,e){var i=Object(g["getStyle"])(t,!1,!0),a=Object(o["get"])(t,"data.__custom__"),s=this.parsePath(b(t.points,a));return e.addShape("path",{attrs:Object(n["__assign"])(Object(n["__assign"])({},i),{path:s})})},getMarker:function(t){var e=t.color,i=t.isInPolar;return{symbol:i?"circle":"square",style:{r:i?4.5:4,fill:e}}}});var x=i("e897");function O(t,e){var i=e||{},n=i.duration,o=void 0===n?200:n,a=i.delay,s=i.easing,r=i.callback,p=i.reverse,l=t.getBBox(),c=p?l.maxX:l.minX,h=(l.minY+l.maxY)/2,u=t.setClip({type:"rect",attrs:{x:l.x,y:l.y,width:l.width,height:l.height}}),d={matrix:[1,0,0,0,1,0,0,0,1]};u.setMatrix(Object(x["b"])(u.getMatrix(),[["t",-c,-h],["s",0,1],["t",c,h]]));var f={fillOpacity:t.attr("fillOpacity"),strokeOpacity:t.attr("strokeOpacity"),opacity:t.attr("opacity")};t.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),u.animate(d,{duration:200,easing:s,callback:function(){t.setClip(null),u.remove()},delay:a}),t.animate(f,{duration:o,easing:s,delay:a}),r&&setTimeout((function(){return r(t)}),o+a)}function j(t,e){var i=e||{},n=i.duration,o=void 0===n?200:n,a=i.delay,s=i.easing,r=i.callback,p=i.reverse,l=t.getBBox(),c=(l.minX+l.maxX)/2,h=p?l.maxY:l.minY,u=t.setClip({type:"rect",attrs:{x:l.x,y:l.y,width:l.width,height:l.height}}),d={matrix:[1,0,0,0,1,0,0,0,1]};u.setMatrix(Object(x["b"])(u.getMatrix(),[["t",-c,-h],["s",1,0],["t",c,h]]));var f={fillOpacity:t.attr("fillOpacity"),strokeOpacity:t.attr("strokeOpacity"),opacity:t.attr("opacity")};t.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),u.animate(d,{duration:200,easing:s,callback:function(){t.setClip(null),u.remove()},delay:a}),t.animate(f,{duration:o,easing:s,delay:a}),r&&setTimeout((function(){return r(t)}),o+a)}O.animationName="funnelScaleInX",Object(f["e"])("funnelScaleInX",O),j.animationName="funnelScaleInY",Object(f["e"])("funnelScaleInY",j);var _=i("80de");function S(t,e,i){return(1-i)*t+i*e}var C={column:"interval"},w={interval:"funnel"},M=function(t){function e(e){var i=t.call(this,e)||this;return i.type="funnel",i._shouldResetPercentages=!0,i._shouldResetLabels=!0,i._shouldResetCompareTexts=!0,i._legendsListenerAttached=!1,i._onLegendContainerMouseDown=function(t){var e=i.options,n=t.target.get("name");if(n.startsWith("legend-item")){var o=t.target.get("parent");if(o.set("unchecked",!o.get("unchecked")),i.refreshPercentages(),i.refreshLabels(),e.dynamicHeight){var a=i._findCheckedDataByMouseDownLegendItem(o);i._genCustomFieldForDynamicHeight(a)}if(e.compareField){a=i._findCheckedDataByMouseDownLegendItem(o);i._updateDataForCompare(a),i.refreshCompareTexts()}}},i.adjustProps(i.options),e.dynamicHeight&&i._genCustomFieldForDynamicHeight(i.getData()),e.compareField&&(i.options.data=i._reduceDataForCompare(i.getData())),i}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(e){var i={label:{visible:!0,adjustColor:!0},percentage:{visible:!0,offsetX:e.transpose?0:40,offsetY:e.transpose?40:0,spacing:4,line:{visible:!0,style:{lineWidth:1,stroke:"rgba(0, 0, 0, 0.15)"}},text:{content:"转化率",style:{fill:"rgba(0, 0, 0, 0.65)"}},value:{visible:!0,style:{fill:"black"},formatter:function(t,e){return(100*e/t).toFixed(2)+"%"}}},tooltip:{visible:!0,shared:!0,showTitle:!1,showCrosshairs:!1,showMarkers:!1},animation:Object(o["deepMix"])({},r["c"],{appear:{duration:800}}),dynamicHeight:!1,compareText:{visible:!0,offsetX:-16,offsetY:-16,style:{fill:"black"}},legend:{position:"bottom-center"},interactions:[{type:"tooltip"},{type:"legend-filter"}]};return Object(o["deepMix"])({},t.getDefaultOptions.call(this),i)},e.prototype.coord=function(){var t=this.options,e={type:"rect",actions:t.transpose?t.dynamicHeight?[["transpose"],["scale",1,-1]]:[["scale",1,-1]]:t.dynamicHeight?[]:[["transpose"],["scale",1,-1]]};this.setConfig("coordinate",e)},e.prototype.axis=function(){this.setConfig("axes",!1)},e.prototype.adjustFunnel=function(t){var e=this.options;t.shape=e.dynamicHeight?"funnel-dynamic-rect":"funnel-basic-rect",t.color={fields:[e.xField],values:e.color&&(Array.isArray(e.color)?e.color:[e.color])},Object(o["isFunction"])(e.funnelStyle)?t.style={callback:e.funnelStyle}:t.style={cfg:e.funnelStyle},t.adjust=[{type:e.dynamicHeight?"stack":"symmetric"}]},e.prototype.tooltip=function(){var e=this.options;e.compareField&&Object(o["deepMix"])(e.tooltip,{htmlContent:function(t,e){var i,n,a,p;i=r["n"].CONTAINER_CLASS,n=Object(s["createDom"])('<div class="'+i+'"></div>'),Object(s["modifyCSS"])(n,r["h"][i]);var l=n;if(t){i=r["n"].TITLE_CLASS,n=Object(s["createDom"])('<div class="'+i+'"></div>'),Object(s["modifyCSS"])(n,r["h"][i]),l.appendChild(n);var c=n;i=r["n"].MARKER_CLASS,n=Object(s["createDom"])('<span class="'+i+'"></span>'),Object(s["modifyCSS"])(n,r["h"][i]),Object(s["modifyCSS"])(n,{width:"10px",height:"10px"}),c.appendChild(n),p=n,n=Object(s["createDom"])("<span>"+t+"</span>"),c.appendChild(n)}if(e){i=r["n"].LIST_CLASS,n=Object(s["createDom"])('<ul class="'+i+'"></ul>'),Object(s["modifyCSS"])(n,r["h"][i]),l.appendChild(n);var h=n;e.reduce((function(t,e){a||(a=e.color);var i=Object(o["get"])(e,"point._origin.__compare__.compareValues"),n=Object(o["get"])(e,"point._origin.__compare__.yValues");return n.forEach((function(e,n){return t.push([i[n],e])})),t}),[]).forEach((function(t,e){var o=t[0],a=t[1];i=r["n"].LIST_ITEM_CLASS,n=Object(s["createDom"])('<li class="'+i+'" data-index='+e+"></li>"),Object(s["modifyCSS"])(n,r["h"][i]),h.appendChild(n);var p=n;i=r["n"].NAME_CLASS,n=Object(s["createDom"])('<span class="'+i+'">'+o+"</span>"),Object(s["modifyCSS"])(n,r["h"][i]),p.appendChild(n),i=r["n"].VALUE_CLASS,n=Object(s["createDom"])('<span class="'+i+'">'+a+"</span>"),Object(s["modifyCSS"])(n,r["h"][i]),p.appendChild(n)}))}return a&&p&&Object(s["modifyCSS"])(p,{backgroundColor:a}),l}}),t.prototype.tooltip.call(this)},e.prototype.addGeometry=function(){var t=this.options,e=Object(c["a"])("interval","main",{positionFields:[t.dynamicHeight?"_":t.xField,t.yField],plot:this});this.adjustFunnel(e),this.funnel=e,this.setConfig("geometry",e)},e.prototype.animation=function(){var e=this;t.prototype.animation.call(this);var i=this.options;if(!1===i.animation)this.funnel.animate=!1;else{var n=this.getData(),a=Object(o["get"])(i,"animation.appear.duration"),s=a/(n.length||1);this._animationAppearTimeoutHandler&&(clearTimeout(this._animationAppearTimeoutHandler),delete this._animationAppearTimeoutHandler),this._animationAppearTimeoutHandler=setTimeout((function(){e.fadeInPercentages(s),i.compareField&&e.fadeInCompareTexts(s),delete e._animationAppearTimeoutHandler}),a),this.funnel.animate=Object(o["deepMix"])({},i.animation,{appear:{animation:i.transpose?"funnelScaleInX":"funnelScaleInY",duration:s,delay:function(t){return Object(o["findIndex"])(n,(function(e){return Object(o["isEqual"])(e,t)}))*s},callback:function(t){e.fadeInLabels(t,.5*s)}},enter:{animation:"fade-in"}})}},e.prototype.afterRender=function(){var e=this.options;if(this.resetLabels(),this.resetPercentages(),e.compareField&&this.resetCompareTexts(),"auto"==e.padding){var i=this._findPercentageContainer();i&&this.paddingController.registerPadding(i,"inner",!0);var n=this._findCompareTextContainer();n&&this.paddingController.registerPadding(n,"inner",!0)}if(t.prototype.afterRender.call(this),!1===e.animation&&(this.fadeInLabels(),this.fadeInPercentages(),e.compareField&&this.fadeInCompareTexts()),!this._legendsListenerAttached){this._legendsListenerAttached=!0;var o=this.view.getController("legend").container;o.on("mousedown",this._onLegendContainerMouseDown)}},e.prototype.updateConfig=function(e){e=this.adjustProps(e),t.prototype.updateConfig.call(this,e),this._legendsListenerAttached=!1},e.prototype.changeData=function(e){var i=this.options;if(!1!==i.animation&&(this._shouldResetPercentages=!1,this._shouldResetLabels=!1),i.dynamicHeight){var n=this._findCheckedDataInNewData(e);this._genCustomFieldForDynamicHeight(n)}if(i.compareField){e=this._reduceDataForCompare(e);n=this._findCheckedDataInNewData(e);this._updateDataForCompare(n)}t.prototype.changeData.call(this,e),this.refreshPercentages(),this.refreshLabels(),i.compareField&&this.fadeInCompareTexts()},e.prototype.geometryParser=function(t,e){return"g2"===t?C[e]:w[e]},e.prototype.adjustProps=function(t){return t.compareField&&(t.dynamicHeight=!1),t.dynamicHeight&&(Object(o["set"])(t,"meta."+t.yField+".nice",!1),Object(o["set"])(t,"tooltip.shared",!1)),t},e.prototype.resetPercentages=function(){var t=this;if(this._shouldResetPercentages){var e=this.options,i=e.percentage||{},n=i.offsetX,a=i.offsetY,s=i.spacing,r=i.line,p=void 0===r?{}:r,l=i.text,c=void 0===l?{}:l,h=i.value,u=void 0===h?{}:h,d=Date.now(),f=this._findPercentageContainer(!0);this._eachShape((function(i,r,l,h){if(r>0){var g=i.getBBox(),y=g.minX,v=g.maxX,m=g.maxY,b=g.minY,x=e.transpose?y:v,O=e.transpose&&e.compareField?m:b,j=t._findPercentageMembersInContainerByIndex(f,r,!0),_=j.line,S=j.text,C=j.value,w=[function(t,i,r,f,g){r&&(r.attr(Object(o["deepMix"])({},p.style,{x1:t,y1:i,x2:e.transpose?t+n:t-n,y2:e.transpose?i-a:i+a,opacity:0})),r.set("adjustTimestamp",d));var y=0,v=0,m=function(){f&&(f.attr(Object(o["deepMix"])({},c.style,{x:e.transpose?t+n:t-n-s-v-s,y:e.transpose?i-a-s:i+a,opacity:0,text:c.content,textAlign:e.transpose?"left":"right",textBaseline:e.transpose?"bottom":"middle"})),f.set("adjustTimestamp",d),y=f.getBBox().width)},b=function(){g&&(g.attr(Object(o["deepMix"])({},u.style,{x:e.transpose?t+n+y+s:t-n-s,y:e.transpose?i-a-s:i+a,opacity:0,text:Object(o["isFunction"])(u.formatter)?e.compareField?u.formatter(Object(o["get"])(h,"__compare__.yValues.0"),Object(o["get"])(l,"__compare__.yValues.0")):u.formatter(h[e.yField],l[e.yField]):"",textAlign:e.transpose?"left":"right",textBaseline:e.transpose?"bottom":"middle"})),g.set("adjustTimestamp",d),v=g.getBBox().width)};e.transpose?(m(),b()):(b(),m())},function(t,i,r,f,g){r&&(r.attr(Object(o["deepMix"])({},p.style,{x1:t,y1:i,x2:t+n,y2:e.transpose?e.compareField?i+a:i-a:i+a,opacity:0})),r.set("adjustTimestamp",d));var y=0;f&&(f.attr(Object(o["deepMix"])({},c.style,{x:e.transpose?t+n:t+n+s,y:e.transpose?e.compareField?i+a+s:i-a-s:i+a,opacity:0,text:c.content,textAlign:"left",textBaseline:e.transpose?e.compareField?"top":"bottom":"middle"})),f.set("adjustTimestamp",d),y=f.getBBox().width),g&&(g.attr(Object(o["deepMix"])({},u.style,{x:e.transpose?t+n+y+s:t+n+s+y+s,y:e.transpose?e.compareField?i+a+s:i-a-s:i+a,opacity:0,text:Object(o["isFunction"])(u.formatter)?e.compareField?u.formatter(Object(o["get"])(h,"__compare__.yValues.1"),Object(o["get"])(l,"__compare__.yValues.1")):u.formatter(h[e.yField],l[e.yField]):"",textAlign:"left",textBaseline:e.transpose?e.compareField?"top":"bottom":"middle"})),g.set("adjustTimestamp",d))}];if(e.compareField){var M=[y,b],F=M[0],A=M[1];[[F,A],[x,O]].forEach((function(t,e){var i=t[0],n=t[1];return w[e](i,n,_&&_[e],S&&S[e],C&&C[e])}))}else w[1](x,O,_,S,C)}h=l,r++})),f.get("children").forEach((function(t){t.get("adjustTimestamp")!=d&&(t.attr({opacity:0}),f.set(t.get("id"),null),setTimeout((function(){return t.remove()}),0))}))}},e.prototype.fadeInPercentages=function(t,e){var i=this,n=this.options,a=this._findPercentageContainer(),s=function(e){var n={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};i._eachShape((function(s,r){var p=i._findPercentageMembersInContainerByIndex(a,r),l={minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0},c=function(t){if(t&&"text"==t.get("type")){var e=t.getBBox(),i=e.minX,n=e.maxX,o=e.minY,a=e.maxY;i<l.minX&&(l.minX=i),n>l.maxX&&(l.maxX=n),o<l.minY&&(l.minY=o),a>l.maxY&&(l.maxY=a)}};if(Object(o["each"])(p,(function(t){return Object(o["isArray"])(t)?c(t[e]):c(t)})),l.minX>n.maxX||l.maxX<n.minX||l.minY>n.maxY||l.maxY<n.minY){var h=function(e){if(e){var i={opacity:1};t?e.animate(i,t):e.attr(i)}};Object(o["each"])(p,(function(t){return Object(o["isArray"])(t)?h(t[e]):h(t)})),Object(o["assign"])(n,l)}}))};n.compareField?[0,1].forEach(s):s(),t&&e&&setTimeout(e,t)},e.prototype.fadeOutPercentages=function(t,e){var i=this,n=this._findPercentageContainer();this._eachShape((function(e,a){var s=i._findPercentageMembersInContainerByIndex(n,a),r=function(e){if(e){var i={opacity:0};t?e.animate(i,t):e.attr(i)}};Object(o["each"])(s,(function(t){return Object(o["isArray"])(t)?t.forEach(r):r(t)}))})),t&&e&&setTimeout(e,t)},e.prototype.refreshPercentages=function(t){var e=this,i=this.options;if(!1!==i.animation){var n=this._calcRefreshFadeDurations(),o=n.fadeOutDuration,a=n.fadeInDuration;this._shouldResetPercentages=!1,this.fadeOutPercentages(o,(function(){e._shouldResetPercentages=!0,e.resetPercentages(),e.fadeInPercentages(a,t)}))}},e.prototype._findPercentageContainer=function(t){void 0===t&&(t=!1);var e=this.view.middleGroup,i=e.get("percentageContainer");return!i&&t&&(i=e.addGroup(),e.set("percentageContainer",i)),i},e.prototype._findPercentageMembersInContainerByIndex=function(t,e,i){void 0===i&&(i=!1);var n=this.options,o=n.percentage||{},a=o.visible,s=o.line,r=void 0===s?{}:s,p=o.text,l=void 0===p?{}:p,c=o.value,h=void 0===c?{}:c,u={line:void 0,text:void 0,value:void 0};if(!1===a||!t)return u;if(!1!==r.visible){var d=function(n){var o="_percentage-line-"+e+"-"+n,a=t.get(o);return!a&&i&&(a=t.addShape({id:o,type:"line",attrs:{}}),t.set(o,a)),a},f=n.compareField?[0,1].map(d):d(0);u.line=f}if(!1!==l.visible){d=function(n){var o="_percentage-text-"+e+"-"+n,a=t.get(o);return!a&&i&&(a=t.addShape({id:o,type:"text",attrs:{}}),t.set(o,a)),a};var g=n.compareField?[0,1].map(d):d(0);u.text=g}if(!1!==h.visible){d=function(n){var o="_percentage-value-"+e+"-"+n,a=t.get(o);return!a&&i&&(a=t.addShape({id:o,type:"text",attrs:{}}),t.set(o,a)),a};var y=n.compareField?[0,1].map(d):d(0);u.value=y}return u},e.prototype._calcRefreshFadeDurations=function(){var t=this.options,e=Object(o["get"])(t,"animation.update.duration"),i=Object(o["get"])(t,"animation.enter.duration"),n=.6*Math.min(i,e),a=1.2*Math.max(i,e);return{fadeInDuration:n,fadeOutDuration:a}},e.prototype.resetLabels=function(){var t=this;if(this._shouldResetLabels){var e,i=this.options,a=i.xField,s=i.yField,p=Date.now(),l=this._getGeometry().labelsContainer,c=i.label||{},h=Object(o["deepMix"])(Object(n["__assign"])({},this.theme.label),i.label.style,{opacity:0,textAlign:"center",textBaseline:"middle"});this._eachShape((function(o,u,d,f){var g,y=o.get("element");0==u&&(e=d);var v=o.getBBox(),m=v.minX,b=v.maxX,x=v.minY,O=v.maxY,j=d[a],_=d[s];c.adjustColor&&(h.fill=t._getAdjustedTextFillByShape(o));var C,w=d.__compare__,M=(g={},g[r["r"]]=d,g.element=y,g.elementIndex=f,g.mappingDatum=[].concat(y.getModel().mappingData)[0],g.mappingDatumIndex=0,g);C=c.formatter?c.formatter(j,M,u,_,e[s]):w?[0,1].map((function(){return""+_})).join(i.transpose?"\n\n":"    "):j+" "+_;var F=t._findLabelInContainerByIndex(l,u,!0),A=w?w.yValues[0]/(w.yValues[0]+w.yValues[1]):.5;F.attr(Object(n["__assign"])(Object(n["__assign"])({},h),{x:S(m,b,i.transpose?.5:A),y:S(x,O,i.transpose?A:.5),text:C})),F.set("adjustTimestamp",p)})),l.get("children").forEach((function(t){t.get("adjustTimestamp")!=p&&(t.attr({opacity:0}),l.set(t.get("id"),null),setTimeout((function(){return t.remove()})))}))}},e.prototype.fadeInLabels=function(t,e,i){var n=this,o=this._getGeometry().labelsContainer;this._eachShape((function(i,a){if(!t||t==i){var s=n._findLabelInContainerByIndex(o,a);if(s){var r=i.getBBox(),p=s.getBBox();if(p.minX>=r.minX&&p.maxX<=r.maxX&&p.minY>=r.minY&&p.maxY<=r.maxY){var l={opacity:1};e?s.animate(l,e):s.attr(l)}}}})),e&&i&&setTimeout(i,e)},e.prototype.fadeOutLabels=function(t,e,i){var n=this,o=this._getGeometry().labelsContainer;this._eachShape((function(i,a){if(!t||t==i){var s=n._findLabelInContainerByIndex(o,a);if(s){var r={opacity:0};e?s.animate(r,e):s.attr(r)}}})),e&&i&&setTimeout(i,e)},e.prototype.refreshLabels=function(t){var e=this,i=this.options;if(!1!==i.animation){var n=this._calcRefreshFadeDurations(),o=n.fadeOutDuration,a=n.fadeInDuration;this._shouldResetLabels=!1,this.fadeOutLabels(null,o,(function(){e._shouldResetLabels=!0,e.resetLabels(),e.fadeInLabels(null,a,t)}))}},e.prototype._findLabelInContainerByIndex=function(t,e,i){var n;void 0===i&&(i=!1);var o,a=this.options;if(!1===(null===(n=a.label)||void 0===n?void 0:n.visible))return o;var s="_label-"+e;return o=t.get(s),!o&&i&&(o=t.addShape({id:s,type:"text",attrs:{}}),t.set(s,o)),o},e.prototype.resetCompareTexts=function(){if(this._shouldResetCompareTexts){var t,e,i=this.options;if(this._eachShape((function(i,n,a){0==n&&(t=i.get("parent").getBBox(),e=Object(o["get"])(a,"__compare__"))})),t&&e&&!1!==Object(o["get"])(i,"compareText.visible")){var n=this._findCompareTextContainer(!0),a=e.yValuesMax,s=e.compareValues,r=t.minX,p=t.maxX,l=t.minY,c=t.maxY,h=n.get("children");[0,1].forEach((function(t){var e=h[t];e||(e=n.addShape({type:"text"})),e.attr(Object(o["deepMix"])({},Object(o["get"])(i,"compareText.style"),{text:i.transpose?s[t]:t?"  "+s[t]:s[t]+"  ",x:i.transpose?r+Object(o["get"])(i,"compareText.offsetX"):S(r,p,a[0]/(a[0]+a[1])),y:i.transpose?S(l,c,a[0]/(a[0]+a[1]))+(t?8:-8):l+Object(o["get"])(i,"compareText.offsetY"),opacity:0,textAlign:i.transpose?"right":t?"left":"right",textBaseline:i.transpose&&t?"top":"bottom"}))}))}}},e.prototype.fadeInCompareTexts=function(t,e){var i=this._findCompareTextContainer();if(i){var n=i.get("children");[0,1].forEach((function(e){var i=n[e];if(i){var o={opacity:1};t?i.animate(o,t):i.attr(o)}}))}t&&e&&setTimeout(e,t)},e.prototype.fadeOutCompareTexts=function(t,e){var i=this._findCompareTextContainer();if(i){var n=i.get("children");[0,1].forEach((function(e){var i=n[e];if(i){var o={opacity:0};t?i.animate(o,t):i.attr(o)}}))}t&&e&&setTimeout(e,t)},e.prototype.refreshCompareTexts=function(t){var e=this,i=this.options;if(!1!==i.animation){var n=this._calcRefreshFadeDurations(),o=n.fadeInDuration,a=n.fadeOutDuration;this._shouldResetCompareTexts=!1,this.fadeOutCompareTexts(a,(function(){e._shouldResetCompareTexts=!0,e.resetCompareTexts(),e.fadeInCompareTexts(o,t)}))}},e.prototype._findCompareTextContainer=function(t){void 0===t&&(t=!1);var e=this.view.middleGroup,i=e.get("compareTextContainer");return!i&&t&&(i=e.addGroup(),e.set("compareTextContainer",i)),i},e.prototype._eachShape=function(t){var e,i,n=this._findCheckedData(this.getData()),o=n.length,a=0;null===(e=this._getGeometry())||void 0===e||e.elements.forEach((function(e,s){var r=e.shape,p=n[a];a<o&&t(r,a,p,i,s),i=p,a++}))},e.prototype._getGeometry=function(){return this.view.geometries[0]},e.prototype._getAdjustedTextFillByShape=function(t){var e=t.attr("fill"),i=t.attr("opacity")?t.attr("opacity"):1,n=Object(_["c"])(e),o=Math.round(.299*n[0]+.587*n[1]+.114*n[2])/i,a=[{from:0,to:85,color:"white"},{from:85,to:170,color:"#F6F6F6"},{from:170,to:255,color:"black"}],s=Object(_["b"])(a,o);return s},e.prototype._genCustomFieldForDynamicHeight=function(t){var e=this.options,i=t.reduce((function(t,i){return t+i[e.yField]}),0),n=1;t.forEach((function(o,a){var s=o[e.yField],r=s/i,p=n-r;o["__custom__"]={datumIndex:a,dataLength:t.length,ratioUpper:n,ratioLower:p,reverse:e.transpose},n=p}))},e.prototype._findCheckedDataByMouseDownLegendItem=function(t){var e=t.get("parent").get("children").map((function(t){return!t.get("unchecked")})),i=this.getData().filter((function(t,i){return e[i]}));return i},e.prototype._findCheckedDataInNewData=function(t){var e=this.options,i=this.view.getController("legend").container,n=i.findAll((function(t){return"legend-item"==t.get("name")})).filter((function(t){return t.get("unchecked")})).map((function(t){return t.get("id").replace("-legend-item-","")})),a=t.filter((function(t){return!Object(o["contains"])(n,t[e.xField])}));return a},e.prototype._findCheckedData=function(t){var e,i=this.options;if(null===(e=i.legend)||void 0===e?void 0:e.visible){var n=this.view.getController("legend").container,a=n.findAll((function(t){return"legend-item"==t.get("name")})).filter((function(t){return!t.get("unchecked")})).map((function(t){return t.get("id").replace("-legend-item-","")})),s=t.filter((function(t){return Object(o["contains"])(a,t[i.xField])}));return s}return this.processData(i.data)},e.prototype._reduceDataForCompare=function(t){var e,i=this.options,n=[-1/0,-1/0];return t=t.reduce((function(t,o){var a,s=o[i.xField],r=o[i.yField],p=o[i.compareField];e||(e=p);var l=t.find((function(t){return t[i.xField]==s}));l||(a={},a[i.xField]=s,a[i.yField]=0,a["__compare__"]={compareValues:[],yValues:[],yValuesMax:[],yValuesNext:void 0,transpose:i.transpose},l=a,t.push(l));var c=p==e?0:1;return l["__compare__"].yValues[c]=r,n[c]<r&&(n[c]=r),l["__compare__"].compareValues[c]=p,t}),[]),t.forEach((function(e,a){e[i.yField]=Object(o["get"])(e,"__compare__.yValues",[]).reduce((function(t,e){return t+e}),0),Object(o["set"])(e,"__compare__.yValuesMax",n),Object(o["set"])(e,"__compare__.yValuesNext",Object(o["get"])(t,a+1+".__compare__.yValues"))})),t},e.prototype._updateDataForCompare=function(t){var e=[-1/0,-1/0];t.forEach((function(t){var i=Object(o["get"])(t,"__compare__.yValues");[0,1].forEach((function(t){i[t]>e[t]&&(e[t]=i[t])}))})),t.forEach((function(i,n){Object(o["set"])(i,"__compare__.yValuesMax",e),Object(o["set"])(i,"__compare__.yValuesNext",Object(o["get"])(t,n+1+".__compare__.yValues"))}))},e}(l["a"]),F=M;Object(p["b"])("funnel",M);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="funnel",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=F.getDefaultOptions})(a["a"])},"6ddc":function(t,e,i){"use strict";var n={};i.r(n),i.d(n,"EVENT_MAP",(function(){return l["b"]})),i.d(n,"onEvent",(function(){return l["e"]}));var o=i("9ab4"),a=i("7c8a"),s=i("8937"),r=i("a5f3"),p=i("fe44"),l=i("61fd"),c={ring:"interval"},h=Object(l["d"])(c);Object(s["assign"])(l["b"],h);var u=function(){function t(t){var e=this.getDefaultOptions();this.options=Object(s["deepMix"])(e,t,{}),this.x=this.options.x,this.y=this.options.y,this.html=this.options.html,this.container=this.options.container}return t.prototype.render=function(){if(Object(s["isElement"])(this.container)){this.wrapperNode=Object(a["createDom"])('<div class="g2plot-htmlStatistic"></div>'),this.container.appendChild(this.wrapperNode),Object(a["modifyCSS"])(this.wrapperNode,{position:"absolute"});var t=Object(a["createDom"])(this.html);this.wrapperNode.appendChild(t),this.setDomPosition(this.x,this.y)}},t.prototype.updateHtml=function(t){this.wrapperNode.innerHTML=t},t.prototype.updatePosition=function(t,e){this.x=t,this.y=e,this.setDomPosition(t,e)},t.prototype.destroy=function(){this.container.removeChild(this.wrapperNode)},t.prototype.getDefaultOptions=function(){return{x:0,y:0,width:0,height:0,html:"",container:null,alignX:"middle",alignY:"middle"}},t.prototype.setDomPosition=function(t,e){var i=t,n=e,o=Object(a["getOuterWidth"])(this.wrapperNode),s=Object(a["getOuterHeight"])(this.wrapperNode);"middle"===this.options.alignX&&(i=t-o/2),"middle"===this.options.alignY&&(n=e-s/2),Object(a["modifyCSS"])(this.wrapperNode,{top:Math.round(n)+"px",left:Math.round(i)+"px"})},t}(),d=u,f="color:#4d4d4d;font-size:14px;text-align:center;line-height:2;font-family:'-apple-system',BlinkMacSystemFont,'SegoeUI',Roboto,'HelveticaNeue',Helvetica,'PingFangSC','HiraginoSansGB','MicrosoftYaHei',SimSun,'sans-serif';pointer-events:none;",g="font-weight:300;",y="font-size:32px;font-weight:bold;color:#4D4D4D";function v(t,e,i){var n=f+"width:"+i+"px;";return'<div class="ring-guide-html '+e+'" style='+n+'><span class="ring-guide-value" style='+y+">"+t+"</span></div>"}function m(t,e,i,n){var o=f+"width:"+n+"px;";return'<div class="ring-guide-html '+i+'" style='+o+'><span class="ring-guide-name" style='+g+">"+t+'</span><br/><span class="ring-guide-value" style='+y+">"+e+"</span></div>"}var b=function(t){function e(e){var i=t.call(this,e)||this;return i.view=e.view,i.plot=e.plot,i.statisticClass=e.statisticClass,i.adjustOptions(),i}return Object(o["__extends"])(e,t),e.prototype.triggerOn=function(){var t=this,e=this.options.triggerOn;this.view.on("interval:"+e,Object(s["debounce"])((function(e){var i=t.parseStatisticData(e.data.data),n=t.getStatisticHtmlString(i);t.updateHtml(n)}),150));var i=this.options.triggerOff?this.options.triggerOff:"mouseleave";this.view.on("interval:"+i,Object(s["debounce"])((function(){var e=t.getTotalValue(),i=t.parseStatisticData(e),n=t.getStatisticHtmlString(i);t.updateHtml(n)}),150))},e.prototype.adjustOptions=function(){var t,e;if(this.options.content)t=this.options.content;else{var i=this.getTotalValue();t=this.parseStatisticData(i)}e=this.options.htmlContent?this.options.htmlContent(t):this.getStatisticTemplate(t),this.html=e;var n=this.view.coordinateBBox,o=n.minX,a=n.minY,s=n.width,r=n.height;this.x=o+s/2,this.y=a+r/2},e.prototype.getTotalValue=function(){var t,e=0,i=this.plot.options,n=i.angleField,o=i.colorField,a=this.options.totalLabel;Object(s["each"])(this.plot.options.data,(function(t){"number"===typeof t[n]&&(e+=t[n])}));var r=(t={},t[n]=e,t[o]=a,t);return r},e.prototype.parseStatisticData=function(t){var e=this.plot.options,i=e.angleField,n=e.colorField;return n?{name:t[n],value:t[i]}:t[i]},e.prototype.getStatisticTemplate=function(t){var e,i=this.getStatisticSize();if(Object(s["isString"])(t))e=v(t,this.statisticClass,i);else if(Object(s["isObject"])(t)&&2===Object(s["keys"])(t).length){var n=t;e=m(n.name,n.value,this.statisticClass,i)}return e},e.prototype.getStatisticSize=function(){var t=this.plot.view.coordinateBBox,e=this.plot.options,i=e.radius,n=e.innerRadius,o=Math.min(t.width,t.height),a=o*i*n;return a},e.prototype.getStatisticHtmlString=function(t){var e,i=this.options.triggerOn;return Object(s["isString"])(i)&&(e=this.getStatisticTemplate(t)),Object(s["isFunction"])(i)&&(e=i(t),e='<div class="ring-guide-html '+this.statisticClass+'">'+e+"</div>"),e},e}(d),x=b,O={ring:"interval"},j={interval:"ring"},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="donut",e}return Object(o["__extends"])(e,t),e.getDefaultOptions=function(){return Object(s["deepMix"])({},t.getDefaultOptions.call(this),{radius:.8,innerRadius:.64,statistic:{visible:!0,totalLabel:"总计",triggerOn:"mouseenter",triggerOff:"mouseleave"}})},e.prototype.beforeInit=function(){t.prototype.beforeInit.call(this),e.centralId++,this.statisticClass="statisticClassId"+e.centralId,this.adjustLabelDefaultOptions(),this.options.statistic.visible&&this.options.statistic.triggerOn&&(this.options.tooltip.visible=!1)},e.prototype.afterRender=function(){var e=this.canvas.get("container");if(this.statistic&&e.removeChild(this.statistic.wrapperNode),this.options.statistic&&this.options.statistic.visible){var i=this.canvas.get("container");Object(a["modifyCSS"])(i,{position:"relative"}),this.statistic=new x(Object(o["__assign"])({container:i,view:this.view,plot:this,statisticClass:this.statisticClass},this.options.statistic)),this.statistic.render(),this.options.statistic.triggerOn&&this.statistic.triggerOn()}t.prototype.afterRender.call(this)},e.prototype.destroy=function(){this.statistic&&this.statistic.destroy(),t.prototype.destroy.call(this)},e.prototype.geometryParser=function(t,e){return"g2"===t?O[e]:j[e]},e.prototype.coord=function(){var t=this.options,e={type:"theta",cfg:{radius:t.radius,innerRadius:t.innerRadius}};this.setConfig("coordinate",e)},e.prototype.parseEvents=function(){t.prototype.parseEvents.call(this,n)},e.prototype.adjustLabelDefaultOptions=function(){var t=this.options.label;if(t&&"inner"===t.type){var e=t.style||{};e.textAlign||(e.textAlign="center"),t.style=e,t.offset||(t.offset=(this.options.innerRadius-1)/2*100+"%")}},e.centralId=0,e}(p["a"]);e["a"]=_;Object(r["b"])("donut",_)},"750b":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("a5f3"),s=i("9ba2"),r=i("b7cb"),p=i("e0fa");Object(r["d"])("groupedColumn",p["a"]);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="groupedColumn",e}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(){return Object(o["deepMix"])({},t.getDefaultOptions.call(this),{yAxis:{title:{visible:!0}}})},e.prototype.getResponsiveTheme=function(){return this.themeController.getResponsiveTheme("column")},e.prototype.addGeometry=function(){t.prototype.addGeometry.call(this)},e.prototype.adjustColumn=function(t){t.adjust=[{type:"dodge",marginRatio:.1}]},e.prototype.geometryTooltip=function(){this.column.tooltip={};var t=this.options.tooltip;t.fields&&(this.column.tooltip.fields=t.fields),t.formatter&&(this.column.tooltip.callback=t.formatter,t.fields||(this.column.tooltip.fields=[this.options.xField,this.options.yField,this.options.groupField]))},e}(s["a"]);e["a"]=l;Object(a["b"])("groupedColumn",l)},"77e3":function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("a5f3"),s=i("e1d3"),r=i("b7cb"),p=i("b413");Object(r["d"])("groupedBar",p["a"]);var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="groupedBar",e}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(){return Object(o["deepMix"])({},t.getDefaultOptions.call(this),{xAxis:{visible:!0,grid:{visible:!0}},yAxis:{visible:!0,title:{visible:!1}},label:{visible:!0,position:"right",adjustColor:!0},legend:{visible:!0,position:"right-top",offsetY:0}})},e.prototype.afterRender=function(){t.prototype.afterRender.call(this);var e=Object(o["valuesOfKey"])(this.options.data,this.options.groupField);this.view.on("tooltip:change",(function(t){for(var i=t.items,n=Object(o["clone"])(i),a=0;a<e.length;a++)for(var s=e[a],r=0;r<n.length;r++){var p=n[r];p.name===s&&(t.items[a]=p)}}))},e.prototype.scale=function(){var e={};e[this.options.groupField]={values:Object(o["valuesOfKey"])(this.options.data,this.options.groupField)},this.options.meta?this.options.meta=Object(o["deepMix"])({},this.options.meta,e):this.options.meta=e,t.prototype.scale.call(this)},e.prototype.adjustBar=function(t){t.adjust=[{type:"dodge",marginRatio:.1}]},e.prototype.geometryTooltip=function(){this.bar.tooltip={};var t=this.options.tooltip;t.fields&&(this.bar.tooltip.fields=t.fields),t.formatter&&(this.bar.tooltip.callback=t.formatter,t.fields||(this.bar.tooltip.fields=[this.options.xField,this.options.yField,this.options.groupField]))},e}(s["a"]);e["a"]=l;Object(a["b"])("groupedBar",l)},dba4:function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("a5f3"),r=i("440c"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="groupedRose",e}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(){return Object(o["deepMix"])({},t.getDefaultOptions.call(this),{xAxis:{visible:!0,line:{visible:!1},tickLine:{visible:!1},grid:{visible:!0,alignTick:!1,style:{lineWidth:.5}},label:{offset:5,autoRotate:!0}},yAxis:{visible:!1}})},e.prototype.adjustRoseAdjust=function(){return[{type:"dodge",marginRatio:1}]},e.prototype.geometryTooltip=function(){this.rose.tooltip={};var t=this.options.tooltip;t.fields&&(this.rose.tooltip.fields=t.fields),t.formatter&&(this.rose.tooltip.callback=t.formatter,t.fields||(this.rose.tooltip.fields=[this.options.radiusField,this.options.categoryField,this.options.groupField]))},e}(r["a"]),l=p;Object(s["b"])("groupedRose",p);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="groupedRose",t.prototype.createLayers.call(this,i)},e.getDefaultOptions=l.getDefaultOptions})(a["a"])},fb05:function(t,e,i){"use strict";var n=i("9ab4"),o=i("8937"),a=i("24b8"),s=i("f2fb"),r=i("a5f3"),p=i("25ee"),l=i("f999");function c(t,e,i,n,o){var a=i*o,s=n*o,r=[["M",t-a/2,e+s/2],["Q",t-a/2,e,t-a/2,e-s/2],["Q",t,e-s/2,t+a/2,e-s/2],["Q",t+a/2,e,t+a/2,e+s/2],["Q",t,e+s/2,t-a/2,e+s/2],["Z"]];return r}function h(t,e,i){var n=[["M",t,e],["l",-i,0],["a",i,i,0,1,0,2*i,0],["a",i,i,0,1,0,-2*i,0],["Z"]];return n}function u(t,e,i){var n=[["M",t-i,e],["Q",t-i,e-i,t,e-i],["Q",t+i,e-i,t+i,e],["Q",t+i,e+i,t,e+i],["Q",t-i,e+i,t-i,e],["Z"]];return n}Object(l["y"])("polygon","rect",{draw:function(t,e){var i=this.parsePoints(t.points),n=i[2].x-i[0].x,a=i[0].y-i[1].y,s=i[0].x+n/2,r=i[1].y+a/2,p=c(s,r,n,a,t.size);return e.addShape("path",{attrs:Object(o["deepMix"])({},{path:p,fill:t.color,opacity:1},t.style)})}}),Object(l["y"])("point","curvePoint",{draw:function(t,e){var i=h(t.x,t.y,t.size);return e.addShape("path",{attrs:Object(o["deepMix"])({},{path:i,fill:t.color,opacity:1},t.style)})}});var d=i("80de"),f=function(){function t(t){this.destroyed=!1,this.view=t.view,this.plot=t.plot;var e=this.getDefaultOptions();this.options=Object(o["deepMix"])(e,t,{}),this.init()}return t.prototype.init=function(){var t=this;this.container=this.view.geometries[0].labelsContainer,this.view.on("beforerender",(function(){t.clear(),t.plot.canvas.draw()}))},t.prototype.render=function(){var t=this,e=this.view.geometries[0].elements;Object(o["each"])(e,(function(e){var i=e.shape,n=t.options,a=n.style,s=n.offsetX,r=n.offsetY,p=t.options.formatter,l=p?p(t.getContent(i)):t.getContent(i),c=t.getPosition(i),h=t.getTextColor(i),u=t.container.addShape("text",{attrs:Object(o["deepMix"])({},a,{x:c.x+s,y:c.y+r,text:l,fill:h,textAlign:"center",textBaseline:"middle"}),name:"label"});t.options.adjustPosition&&t.adjustLabel(u,i)}))},t.prototype.clear=function(){this.container&&this.container.clear()},t.prototype.hide=function(){this.container.set("visible",!1),this.plot.canvas.draw()},t.prototype.show=function(){this.container.set("visible",!0),this.plot.canvas.draw()},t.prototype.destroy=function(){this.container&&this.container.remove(),this.destroyed=!0},t.prototype.getBBox=function(){return this.container.getBBox()},t.prototype.getDefaultOptions=function(){var t=this.plot.theme,e=t.label.style;return{offsetX:0,offsetY:0,style:Object(o["clone"])(e)}},t.prototype.getContent=function(t){var e=t.get("origin").data,i=this.plot.options.colorField;return e[i]},t.prototype.getPosition=function(t){var e=t.getBBox();return{x:e.minX+e.width/2,y:e.minY+e.height/2}},t.prototype.getTextColor=function(t){if(this.options.adjustColor){var e=t.attr("fill"),i=t.attr("opacity")?t.attr("opacity"):1,n=Object(d["c"])(e),o=Math.round(.299*n[0]+.587*n[1]+.114*n[2])/i,a=[{from:0,to:85,color:"white"},{from:85,to:170,color:"#F6F6F6"},{from:170,to:255,color:"black"}],s=Object(d["b"])(a,o);return s}var r=this.options.style.fill;return r},t.prototype.adjustLabel=function(t,e){var i=t.getBBox(),n=e.getBBox();(i.width>n.width||i.height>n.height)&&t.attr("text","")},t}(),g=f,y=i("843c"),v=4,m=function(){function t(t){this.destroyed=!1,this.dataSlides={},this.interactiveEvents={};var e=this.getDefaultOptions();this.options=Object(o["deepMix"])({},e,t),this.view=this.options.view,this.afterRender=!0,this.init()}return t.prototype.init=function(){var t=this;this.layout=this.getLayout(),this.width=this.options.width?this.options.width:this.getDefaultWidth(),this.height=this.options.height?this.options.height:this.getDefaultHeight();var e=this.options.plot.container;this.container&&this.container.remove(),this.container=e.addGroup(),this.view.on("beforerender",(function(){t.clear(),t.options.plot.canvas.draw()}))},t.prototype.render=function(){var t=this.view.geometries[0].scales,e=this.options.plot.options.colorField;this.colorScale=t[e];var i=this.colorScale,n=i.min,o=i.max,a=this.options.plot.options.color;"horizontal"===this.layout?this.renderHorizontal(n,o,a):this.renderVertical(n,o,a),this.legendLayout(),this.addInteraction()},t.prototype.hide=function(){this.container.set("visible",!1),this.options.plot.canvas.draw()},t.prototype.show=function(){this.container.set("visible",!0),this.options.plot.canvas.draw()},t.prototype.clear=function(){this.container&&this.container.clear()},t.prototype.destroy=function(){this.container&&this.container.remove(),this.offEvent(),this.destroyed=!0},t.prototype.getBBox=function(){var t=this.container.getBBox();return new y["a"](this.x,this.y,t.width,t.height)},t.prototype.renderVertical=function(t,e,i){var a=this,s=(e-t)/(i.length-1),r=1/(i.length-1),p=this.height/(i.length-1),l="l(90)";Object(o["each"])(i,(function(t,e){var i=r*e;l+=i+":"+t+" "})),this.container.addShape("rect",{attrs:{x:0,y:0,width:this.width,height:this.height,fill:l},name:"legend"}),Object(o["each"])(i,(function(t,e){var i=p*e;a.container.addShape("path",{attrs:Object(n["__assign"])({path:[["M",0,i],["L",a.width,i]]},a.options.ticklineStyle)});var o=Math.round(s*e);a.container.addShape("text",{attrs:Object(n["__assign"])({text:o,textAlign:"left",textBaseline:"middle",x:a.width+v,y:i},a.options.text.style),name:"legend-label"})}));var c=10,h=14,u=[["M",-c,-h/2],["L",0,0],["L",-c,h/2],["Z"]];this.anchor=this.container.addShape("path",{attrs:Object(n["__assign"])({path:u},this.options.anchorStyle)}),this.anchor.set("visible",!1)},t.prototype.renderHorizontal=function(t,e,i){var a=this,s=(e-t)/(i.length-1),r=1/(i.length-1),p=this.width/(i.length-1),l="l(0)";Object(o["each"])(i,(function(t,e){var i=r*e;l+=i+":"+t+" "})),this.container.addShape("rect",{attrs:{x:0,y:0,width:this.width,height:this.height,fill:l},name:"legend"}),Object(o["each"])(i,(function(t,e){var i=p*e;a.container.addShape("path",{attrs:Object(n["__assign"])({path:[["M",i,0],["L",i,a.height]]},a.options.ticklineStyle),name:"legend-label"});var o=Math.round(s*e);a.container.addShape("text",{attrs:Object(n["__assign"])({text:o,textAlign:"center",textBaseline:"top",x:i,y:a.height+v},a.options.text.style)})}));var c=14,h=10,u=[["M",0,0],["L",-c/2,-h],["L",c/2,-h],["Z"]];this.anchor=this.container.addShape("path",{attrs:Object(n["__assign"])({path:u},this.options.anchorStyle)}),this.anchor.set("visible",!1)},t.prototype.getLayout=function(){var t=this.options.position.split("-");return this.position=t[0],"left"===t[0]||"right"===t[0]?"vertical":"horizontal"},t.prototype.getDefaultWidth=function(){if("horizontal"===this.layout){var t=this.view.coordinateBBox.width;return t}return 10},t.prototype.getDefaultHeight=function(){if("vertical"===this.layout){var t=this.view.coordinateBBox.height;return t}return 10},t.prototype.legendLayout=function(){var t=this,e=this.view.coordinateBBox,i=this.options.plot.getPlotTheme().bleeding;Object(o["isArray"])(i)&&Object(o["each"])(i,(function(e,n){"function"===typeof i[n]&&(i[n]=i[n](t.options.plot.options))}));var n=this.container.getBBox(),a=0,s=0,r=this.options.position.split("-"),p=this.options.plot.width,l=this.options.plot.height;"left"===r[0]?a=i[3]:"right"===r[0]?a=p-i[1]-n.width:"center"===r[1]?a=this.width===e.width?e.x:(p-n.width)/2:"left"===r[1]?a=i[3]:"right"===r[1]&&(a=this.options.plot.width-i[1]-n.width),"bottom"===r[0]?s=l-i[2]-n.height:"top"===r[0]?s=this.getTopPosition(i):"center"===r[1]?s=this.height===e.height?e.y:(l-n.height)/2:"top"===r[1]?s=i[0]:"bottom"===r[1]&&(s=l-i[2]-n.height),this.x=a,this.y=s,this.container.translate(a,s)},t.prototype.getDefaultOptions=function(){return{text:{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.45)"}},ticklineStyle:{lineWidth:1,stroke:"rgba(0, 0, 0, 0.8)"},anchorStyle:{fill:"rgba(0,0,0,0.5)"},triggerOn:"mousemove"}},t.prototype.addInteraction=function(){var t,e=this;t="rect"===this.options.plot.options.shapeType?"polygon":"point";var i=t+":"+this.options.triggerOn,n=this.options.plot.options.colorField,o=this.colorScale,a=o.min,s=o.max,r=function(t){var i=t.data.data[n],o=(i-a)/(s-a);e.moveAnchor(o)};this.view.on(i,r),this.interactiveEvents[i]={target:this.view,handler:r};var p=function(){e.anchor.set("visible",!1)};this.options.plot.canvas.on("mouseleave",p),this.interactiveEvents.mouseleave={target:this.options.plot.canvas,handler:p}},t.prototype.moveAnchor=function(t){if(this.anchor.set("visible",!0),"vertical"===this.layout){var e=this.height*t,i=[1,0,0,0,1,0,0,0,1];i[7]=e,this.anchor.stopAnimate(),this.anchor.animate({matrix:i},400,"easeLinear")}else{e=this.width*t,i=[1,0,0,0,1,0,0,0,1];i[6]=e,this.anchor.stopAnimate(),this.anchor.animate({matrix:i},400,"easeLinear")}},t.prototype.getTopPosition=function(t){if(this.options.plot.description){var e=this.options.plot.description.getBBox();return e.maxY+10}if(this.options.plot.title){e=this.options.plot.title.getBBox();return e.maxY+10}return t[0]},t.prototype.offEvent=function(){Object(o["each"])(this.interactiveEvents,(function(t,e){var i=t.target,n=t.handler;i.off(e,n)}))},t}(),b=m,x={label:{Ctr:g},legend:{Ctr:b,padding:"outer"}};function O(t,e,i){if(t.options[e]&&t.options[e].visible){var n=x[e],o=new n.Ctr(i);return n.padding&&t.paddingController.registerPadding(o,n.padding),o}}var j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="heatmap",e.gridSize=[],e.plotComponents=[],e}return Object(n["__extends"])(e,t),e.getDefaultOptions=function(){return Object(o["deepMix"])({},t.getDefaultOptions.call(this),{shapeType:"rect",legend:{visible:!0,position:"right-center"},tooltip:{shared:!1,showCrosshairs:!1,showMarkers:!1},xAxis:{visible:!0,gridAlign:"center",grid:{visible:!0},tickLine:{visible:!0},line:{visible:!1},label:{visible:!0,autoHide:!0,autoRotate:!0}},yAxis:{visible:!0,gridAlign:"center",grid:{visible:!0,align:"center"},tickLine:{visible:!0},label:{autoHide:!0,autoRotate:!1}},color:["#9ae3d5","#66cdbb","#e7a744","#f1e066","#f27664","#e7c1a2"],label:{visible:!0,adjustColor:!0,adjustPosition:!0,offset:0,style:{stroke:"rgba(255,255,255,0)",lineWidth:0}},interactions:[{type:"tooltip"}]})},e.prototype.afterRender=function(){this.renderPlotComponents(),t.prototype.afterRender.call(this)},e.prototype.changeShape=function(t){if(this.options.shapeType!==t)if(this.options.shapeType=t,"rect"===t){var e=this.getShapes();this.circleToRect(e)}else if("circle"===t){e=this.getShapes();this.rectToCircle(e)}},e.prototype.mappingSize=function(t){if(!this.options.sizeField||this.options.sizeField!==t){this.options.sizeField=t;var e=Object(o["valuesOfKey"])(this.options.data,t),i=Math.min.apply(Math,e),n=Math.max.apply(Math,e),a=Object(s["getScale"])("linear"),r=new a({min:i,max:n}),p=this.getShapes();"rect"===this.options.shapeType?this.rectSizeMapping(p,r,t):"circle"===this.options.shapeType&&this.circleSizeMapping(p,r,t)}},e.prototype.disableMappingSize=function(){var t=this.getShapes();"rect"===this.options.shapeType?this.rectDisableSizeMapping(t):"circle"===this.options.shapeType&&this.circleDisableSizeMapping(t)},e.prototype.destroy=function(){Object(o["each"])(this.plotComponents,(function(t){t.destroy()})),t.prototype.destroy.call(this)},e.prototype.geometryParser=function(){return""},e.prototype.coord=function(){},e.prototype.legend=function(){this.setConfig("legends",!1)},e.prototype.addGeometry=function(){var t;if(this.gridSize=this.getGridSize(),"rect"===this.options.shapeType)t=this.addRect();else{var e=this.addCircle();t=e}if(this.options.shapeStyle){var i={};Object(o["isObject"])(this.options.shapeStyle)?i.cfg=this.options.shapeStyle:Object(o["isFunction"])(this.options.shapeType)&&(i.fields=[this.options.colorField,this.options.xField,this.options.yField,this.options.sizeField],i.callback=this.options.shapeType),t.style=i}this.options.tooltip&&(this.options.tooltip.fields||this.options.tooltip.formatter)&&this.geometryTooltip(t),this.setConfig("geometry",t)},e.prototype.addRect=function(){var t=[.3,.9];this.options.shapeSize&&(t[0]=this.options.shapeSize[0]/this.gridSize[0],t[1]=this.options.shapeSize[1]/this.gridSize[1]);var e={type:"polygon",position:{fields:[this.options.xField,this.options.yField]},color:{fields:[this.options.colorField],values:this.options.color},shape:{values:["rect"]},label:!1};return this.options.sizeField?e.size={fields:[this.options.sizeField],values:t}:e.size={values:[1]},e},e.prototype.addCircle=function(){var t=[.3,.9];this.options.shapeSize?t=this.options.shapeSize:(t[0]=this.gridSize[0]*t[0]*.5,t[1]=this.gridSize[1]*t[1]*.5);var e={type:"point",position:{fields:[this.options.xField,this.options.yField]},color:{fields:[this.options.colorField],values:this.options.color},shape:{values:["curvePoint"]},label:!1};return this.options.sizeField?e.size={fields:[this.options.sizeField],values:t}:e.size={values:[.5*Math.min(this.gridSize[0],this.gridSize[1])*.9]},e},e.prototype.geometryTooltip=function(t){t.tooltip={};var e=this.options.tooltip;e.fields&&(t.tooltip.fields=e.fields),e.formatter&&(t.tooltip.callback=e.formatter,e.fields||(t.tooltip.fields=[this.options.xField,this.options.yField],this.options.colorField&&t.tooltip.fields.push(this.options.colorField)))},e.prototype.getGridSize=function(){if("auto"===this.options.padding)return[0,0];var t=this.getViewRange(),e=this.options,i=e.padding,n=e.xField,a=e.yField,s=e.data,r=t.width-i[1]-i[3],p=t.height-i[0]-i[2],l=Object(o["valuesOfKey"])(s,n).length,c=Object(o["valuesOfKey"])(s,a).length;return[r/l,p/c]},e.prototype.circleToRect=function(t){var e=this,i=this.gridSize;Object(o["each"])(t,(function(t){var n=t.get("origin"),o=n.x,a=n.y,s=n.size,r=2*s/Math.min(i[0],i[1]);e.options.sizeField||(r=1);var p=u(o,a,s),l=c(o,a,i[0],i[1],r);t.stopAnimate(),t.attr("path",p),t.animate({path:l},500,"easeLinear")}))},e.prototype.rectToCircle=function(t){var e=this;Object(o["each"])(t,(function(t){var i=t.get("coord"),n=t.get("origin").points,a=[];Object(o["each"])(n,(function(t){a.push(i.convertPoint(t))}));var s=t.getBBox(),r=s.width,p=s.height,l=s.minX+r/2,c=s.minY+p/2,d=e.options.sizeField?1:.9,f=u(l,c,Math.min(r,p)/2*d),g=h(l,c,Math.min(r,p)/2*d);t.stopAnimate(),t.animate({path:f},500,"easeLinear",(function(){t.attr("path",g)}))}))},e.prototype.rectSizeMapping=function(t,e,i){Object(o["each"])(t,(function(t){var n=t.get("origin").data,o=.3+.6*e.scale(n[i]);t.get("origin").size=o;var a=t.getBBox(),s=a.width,r=a.height,p=a.minX+s/2,l=a.minY+r/2,h=c(p,l,s,r,o);t.stopAnimate(),t.animate({path:h},500,"easeLinear")}))},e.prototype.circleSizeMapping=function(t,e,i){Object(o["each"])(t,(function(t){var n=t.get("origin").data,o=.3+.6*e.scale(n[i]),a=t.get("origin"),s=a.x,r=a.y,p=a.size,l=h(s,r,p*o);t.get("origin").size=p*o,t.stopAnimate(),t.animate({path:l},500,"easeLinear")}))},e.prototype.circleDisableSizeMapping=function(t){var e=this;this.options.sizeField=null,Object(o["each"])(t,(function(t){var i=t.get("origin"),n=i.x,o=i.y,a=.9*Math.min(e.gridSize[0],e.gridSize[1]);t.get("origin").size=a/2;var s=h(n,o,a/2);t.stopAnimate(),t.animate({path:s},500,"easeLinear")}))},e.prototype.rectDisableSizeMapping=function(t){var e=this;this.options.sizeField=null,Object(o["each"])(t,(function(t){var i=t.getBBox(),n=i.width,o=i.height,a=i.minX+n/2,s=i.minY+o/2,r=c(a,s,e.gridSize[0],e.gridSize[1],1);t.get("origin").size=1,t.stopAnimate(),t.animate({path:r},500,"easeLinear")}))},e.prototype.getShapes=function(){var t=this.view.geometries[0].elements,e=[];return Object(o["each"])(t,(function(t){e.push(t.shape)})),e},e.prototype.renderPlotComponents=function(){var t=this;Object(o["each"])(this.plotComponents,(function(t){t.destroy()})),this.plotComponents=[];var e=["label","legend"];Object(o["each"])(e,(function(e){var i=Object(n["__assign"])({view:t.view,plot:t},t.options[e]),o=O(t,e,i);o&&(o.render(),t.plotComponents.push(o))}))},e}(p["a"]),_=j;Object(r["b"])("heatmap",j);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(n["__extends"])(e,t),e.prototype.createLayers=function(e){var i=Object(o["deepMix"])({},e);i.type="heatmap",t.prototype.createLayers.call(this,i)},e.prototype.changeShape=function(t){var e=this.layers[0];e.changeShape(t)},e.prototype.mappingSize=function(t){var e=this.layers[0];e.mappingSize(t)},e.prototype.disableMappingSize=function(){var t=this.layers[0];t.disableMappingSize()},e.getDefaultOptions=_.getDefaultOptions})(a["a"])}}]);