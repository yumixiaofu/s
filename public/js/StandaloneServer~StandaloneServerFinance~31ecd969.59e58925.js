(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["StandaloneServer~StandaloneServerFinance~31ecd969"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"372e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"standaloneserver_finance"},[a("div",{staticClass:"standaloneserver_finance_pricebox"},[a("div",{staticClass:"standaloneserver_finance_pricetitle"},[a("div",{staticClass:"standaloneserver_finance_pricetitlel"},[a("span",[e._v(e._s(e.$t("standaloneServer.firstOrderPrice")))]),e.dataLoading?e._e():a("span",[a("b",[e._v(e._s(e.currency.prefix+" "+e.hostData.firstpaymentamount))]),e._v(e._s(e.currency.suffix))])]),a("div",{staticClass:"standaloneserver_finance_pricetitler"},["hour"===e.hostData.billingcycle?a("div",{staticClass:"standaloneserver_finance_time"},[a("span",[e._v(e._s(e.$t("standaloneServer.orderTime"))+"：")]),a("span",[e._v(e._s(e.hostData.regdate?e.$moment(1e3*e.hostData.regdate).format("YYYY-MM-DD HH:mm"):"-"))])]):a("div",{staticClass:"standaloneserver_finance_time"},[a("span",[e._v(e._s(e.$t("standaloneServer.orderTime"))+"：")]),a("span",[e._v(e._s(e.hostData.regdate?e.$moment(1e3*e.hostData.regdate).format("YYYY-MM-DD"):"-"))])]),"hour"===e.hostData.billingcycle?a("div",{staticClass:"standaloneserver_finance_time"},[a("span",[e._v(e._s(e.$t("standaloneServer.nextduedate"))+"：")]),e.dataLoading?e._e():a("span",[e._v(e._s(e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle?e.$moment(1e3*e.hostData.nextduedate).format("YYYY-MM-DD HH:mm"):e.$t("standaloneServer.notDue")))]),e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle&&e.$moment(1e3*e.hostData.nextduedate).diff(e.$moment(new Date),"seconds")<0?a("span",[e._v("（"+e._s(e.$t("standaloneServer.overdue"))+"）")]):a("span",[e._v(e._s(e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle?"（"+e.$t("standaloneServer.left")+" "+e.overdue+"）":""))])]):a("div",{staticClass:"standaloneserver_finance_time"},[a("span",[e._v(e._s(e.$t("standaloneServer.nextduedate"))+"：")]),e.dataLoading?e._e():a("span",[e._v(e._s(e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle?e.$moment(1e3*e.hostData.nextduedate).format("YYYY-MM-DD"):e.$t("standaloneServer.notDue")))]),e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle&&e.$moment(1e3*e.hostData.nextduedate).diff(e.$moment(new Date),"seconds")<0?a("span",[e._v("（"+e._s(e.$t("standaloneServer.overdue"))+"）")]):a("span",[e._v(e._s(e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle?"（"+e.$t("standaloneServer.left")+" "+e.overdue+"）":""))])]),e.host_cancel.init||"Active"!==e.host_data.domainstatus&&"Suspended"!==e.host_data.domainstatus?e._e():a("div",{staticClass:"mr-20 ml-10"},[0===e.host_cancel.length?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.cancelDialog=!0}}},[e._v("停用 ")]):a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:e.deleteCancel}},[e._v(" "+e._s("Immediate"!==e.host_cancel.type?"到期时停用":"立即停用"))])],1)])]),a("div",{directives:[{name:"show",rawName:"v-show",value:"Unpaid"===e.hostData.status&&"free"!==e.hostData.billingcycle||"Paid"===e.hostData.status&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle&&("Active"===e.hostData.domainstatus||"Suspended"===e.hostData.domainstatus),expression:"(hostData.status === 'Unpaid' && hostData.billingcycle !== 'free')\n    || (hostData.status === 'Paid' && (hostData.billingcycle !== 'free' && hostData.billingcycle !== 'onetime') && (hostData.domainstatus === 'Active' || hostData.domainstatus === 'Suspended'))"}],staticClass:"standaloneserver_finance_priceform"},[a("el-form",{ref:"form",attrs:{model:e.form}},["Unpaid"===e.hostData.status?[a("el-form-item",{attrs:{label:e.$t("standaloneServer.paymentCycle")}},[a("el-radio-group",{model:{value:e.form.billingcycles,callback:function(t){e.$set(e.form,"billingcycles",t)},expression:"form.billingcycles"}},[a("el-radio",{attrs:{label:e.hostData.billingcycle,border:""}},[e._v(e._s(e.hostData.billingcycle_zh))])],1)],1),a("el-form-item",{attrs:{label:e.$t("standaloneServer.payPrice")}},[a("div",{staticClass:"renewal_price"},[a("span",[e._v(e._s(e.currency.prefix+" "+e.hostData.firstpaymentamount))]),e._v(" "+e._s(e.currency.suffix)+" / "+e._s(e.myCycle)+" ")]),a("span",{staticClass:"discount"},[e._v(" "+e._s(Number(e.hostData.saleproducts)?"(客户折扣："+e.currency.prefix+Number(e.hostData.saleproducts).toFixed(2)+e.currency.suffix+")":""))])]),a("el-button",{attrs:{type:"primary"},on:{click:e.payNow}},[e._v(e._s(e.$t("standaloneServer.payNow"))+" ")])]:e._e(),"Paid"===e.hostData.status?[a("el-form-item",{attrs:{label:e.$t("standaloneServer.paymentCycle")}},[a("div",{staticClass:"grid"},[a("el-radio-group",{model:{value:e.form.billingcycles,callback:function(t){e.$set(e.form,"billingcycles",t)},expression:"form.billingcycles"}},e._l(e.cycle,(function(t,n){return a("el-radio",{key:n,attrs:{label:t.billingcycle,border:""}},[e._v(" "+e._s(t.billingcycle_zh))])})),1)],1)]),a("el-form-item",{attrs:{label:e.$t("standaloneServer.renewalPrice")}},[a("div",{staticClass:"renewal_price"},[a("span",[e._v(e._s(e.currency.prefix+" "+e.hostData.amount))]),e._v(" "+e._s(e.currency.suffix)+" / "+e._s(e.myCycle)+" ")]),a("span",{staticClass:"discount"},[e._v(" "+e._s(Number(e.hostData.saleproducts)?"(客户折扣："+e.currency.prefix+Number(e.hostData.saleproducts).toFixed(2)+e.currency.suffix+")":""))])]),a("el-form-item",{attrs:{label:"自动余额续费"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:e.changeRenew},model:{value:e.initiative_renewS,callback:function(t){e.initiative_renewS=t},expression:"initiative_renewS"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:e.renew}},[e._v(e._s(e.$t("standaloneServer.renewNow")))])]:e._e()],2)],1)]),a("div",{staticClass:"standaloneserver_finance_rechargebox"},[a("div",{staticClass:"standaloneserver_finance_rechargetitle"},[a("span",[e._v(e._s(e.$t("standaloneServer.transactionRecord")))])]),a("div",{staticClass:"standaloneserver_finance_rechargetable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{height:e.$height-650,data:e.tableData,"header-row-class-name":"innerTableHeader","row-class-name":"innerTableRowClass","cell-class-name":"innerTableCellClass"}},[a("el-table-column",{attrs:{prop:"pay_time",label:e.$t("standaloneServer.transactiondate"),sortable:"",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.pay_time?e.$moment(1e3*a.pay_time).format("YYYY-MM-DD"):"-")+" ")]}}])}),a("el-table-column",{attrs:{prop:"type",label:e.$t("standaloneServer.source"),sortable:""}}),a("el-table-column",{attrs:{prop:"amount_in",label:e.$t("standaloneServer.price"),sortable:"",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(e._s(e.currency.prefix)+e._s(Number(n.refund)>0?-Number(n.amount_out):n.amount_in)+e._s(e.currency.suffix))])]}}])}),a("el-table-column",{attrs:{prop:"trans_id",label:e.$t("standaloneServer.serialNumber"),sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.trans_id?a.trans_id:"-")+" ")]}}])}),a("el-table-column",{attrs:{prop:"gateway",label:e.$t("standaloneServer.payMent"),sortable:"",width:"135"}})],1)],1),a("div",{staticClass:"standaloneserver_finance_pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next","page-sizes":[10,15,20,25],"prev-text":e.$t("Previous"),"next-text":e.$t("Nextpage"),"current-page":e.page,"page-size":e.limit,total:e.total,"pager-count":5},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),a("payNew",{ref:"control",on:{"pay-success":e.paySuccess}}),a("el-dialog",{attrs:{visible:e.cancelDialog,title:"请选择您要停用并删除该产品的时间",width:"25%","before-close":e.beforeClose},on:{"update:visible":function(t){e.cancelDialog=t},open:e.cancelOpen,opened:e.cancelOpened}},[a("el-form",{ref:"cancelForm",attrs:{model:e.cancelFormData,rules:e.cancelRules,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"取消时间",prop:"type"}},[a("el-select",{staticClass:"w-100",model:{value:e.cancelFormData.type,callback:function(t){e.$set(e.cancelFormData,"type",t)},expression:"cancelFormData.type"}},[a("el-option",{attrs:{value:"Immediate",label:"立即"}}),"free"!==e.host_data.billingcycle&&"onetime"!==e.host_data.billingcycle?a("el-option",{attrs:{value:"Endofbilling",label:"到期时"}}):e._e()],1)],1),a("el-form-item",{attrs:{label:"取消原因",prop:"tempReason"}},[a("el-select",{staticClass:"w-100",on:{change:function(t){e.cancelFormData.reason=""}},model:{value:e.cancelFormData.tempReason,callback:function(t){e.$set(e.cancelFormData,"tempReason",t)},expression:"cancelFormData.tempReason"}},[e._l(e.cancelistOptions,(function(e,t){return a("el-option",{key:t,attrs:{value:e.reason,label:e.reason}})})),a("el-option",{attrs:{value:"other",label:"其他"}})],2)],1),"other"===e.cancelFormData.tempReason?a("el-form-item",{attrs:{label:"",prop:"reason"}},[a("el-input",{staticClass:"w-100",attrs:{type:"textarea",placeholder:"请输入原因"},model:{value:e.cancelFormData.reason,callback:function(t){e.$set(e.cancelFormData,"reason",t)},expression:"cancelFormData.reason"}})],1):e._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.beforeClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.cancelSubmit}},[e._v("确定")])],1)],1)],1)},r=[],s=(a("4de4"),a("ac1f"),a("5319"),a("841c"),a("96cf"),a("1da1")),i=a("27fd"),c=a("048a"),o=a("2ef0"),l={data:function(){return{cancelistOptions:[],overdue:0,hostData:{firstpaymentamount:"",amount:""},host_data:{domainstatus_desc:""},currency:{prefix:"￥",suffix:"元"},cycle:[],myCycle:"",page:1,limit:20,total:0,orderby:"trans_id",sort:"desc",search:{input:"",timer:null},tableData:[],form:{hostid:0,billingcycles:""},initiative_renewS:0,host_cancel:{init:!0},cancelDialog:!1,cancelFormData:{id:this.$route.query.id,type:void 0,reason:"",tempReason:void 0},cancelRules:{type:[{required:!0,message:"请选择时间",trigger:"change"}],reason:[{required:!0,message:"请输入原因",trigger:"blur"}],tempReason:[{required:!0,message:"请选择原因",trigger:"change"}]},dataLoading:!0}},methods:{changeRenew:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={hostid:e.$route.query.id,initiative_renew:e.initiative_renewS},t.next=3,Object(c["a"])(a);case 3:n=t.sent,r=n.data,200!==r.status?e.$message.error(r.msg):e.$message.success(r.msg);case 6:case"end":return t.stop()}}),t)})))()},getId:function(){this.pid=this.$route.query.id},getData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.dataLoading=!0,t.next=3,Object(i["w"])(e.pid);case 3:a=t.sent,n=a.data,200!==n.status?e.$message.error(n.msg):(e.host_data=n.data.host_data,e.initiative_renewS=n.data.host_data.initiative_renew,e.cancelistOptions=n.data.cancelist,e.host_cancel=n.data.host_cancel),e.dataLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},getPriceData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["u"])(e.pid);case 2:if(a=t.sent,n=a.data,200===n.status){t.next=7;break}return e.$message.error(n.msg),t.abrupt("return",!1);case 7:if(e.hostData=n.data.host,e.hostData.nextduedate&&"free"!==e.hostData.billingcycle&&"onetime"!==e.hostData.billingcycle?(e.overdue=e.$moment(1e3*e.hostData.nextduedate).diff(e.$moment(new Date),"days")+e.$t("standaloneServer.day"),0===parseInt(e.overdue)&&(e.overdue=e.$moment(1e3*e.hostData.nextduedate).diff(e.$moment(new Date),"hours")+e.$t("standaloneServer.hour"))):e.overdue="",e.currency=n.data.currency,e.cycle=n.data.cycle,"free"!==n.data.host.billingcycle){t.next=13;break}return t.abrupt("return",!1);case 13:if("ontrial"!==n.data.host.billingcycle){t.next=16;break}return e.form.billingcycles=n.data.cycle[0].billingcycle,t.abrupt("return",!1);case 16:e.form.billingcycles=n.data.host.billingcycle;case 17:case"end":return t.stop()}}),t)})))()},getRechargeList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["t"])(e.pid,e.page,e.limit,e.orderby,e.sort,e.search.input);case 2:if(a=t.sent,n=a.data,200===n.status){t.next=7;break}return e.$message.error(n.msg),t.abrupt("return",!1);case 7:e.tableData=n.data.invoices,e.total=n.data.count;case 9:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.limit=e,this.getRechargeList()},handleCurrentChange:function(e){this.page=e,this.getRechargeList()},getPrice:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["u"])(t.pid,e);case 2:if(n=a.sent,r=n.data,200===r.status){a.next=7;break}return t.$message.error(r.msg),a.abrupt("return",!1);case 7:t.hostData=r.data.host,t.hostData.amount=r.data.host.amount;case 9:case"end":return a.stop()}}),a)})))()},renew:o.debounce(Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.form.hostid=this.pid,e.next=3,Object(i["J"])(this.form);case 3:if(t=e.sent,a=t.data,1001!==a.status){e.next=9;break}return this.$message.success(a.msg),this.getPriceData(),e.abrupt("return");case 9:if(200===a.status){e.next=12;break}return this.$message({type:"error",message:a.msg,center:!0}),e.abrupt("return",!1);case 12:this.$refs.control.main({id:a.data.invoiceid,name:this.$t("standaloneServer.renew")});case 13:case"end":return e.stop()}}),e,this)}))),200),payNow:o.debounce((function(){this.$refs.control.main({id:this.hostData.id,name:this.$t("standaloneServer.pay")})}),200),paySuccess:function(e){e&&(this.getPriceData(),this.getRechargeList())},cancelSubmit:function(){var e=this,t="";t="Immediate"===this.cancelFormData.type?"这将会立刻删除您的产品，操作不可逆，所有数据丢失":"产品将会在到期当天被立刻删除，操作不可逆，所有数据丢失","other"!==this.cancelFormData.tempReason&&(this.cancelFormData.reason=this.cancelFormData.tempReason),this.$refs.cancelForm.validate((function(a){if(!a)return!1;e.cancelDialog=!1,e.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["b"])(e.cancelFormData);case 2:a=t.sent,n=a.data,200!==n.status?e.$message.error(n.msg):(e.getData(),e.$message.success(n.msg),e.$store.dispatch("addHostDataUpdate",e.pid));case 5:case"end":return t.stop()}}),t)})))).catch((function(){}))}))},cancelOpen:function(){this.cancelFormData.type=void 0,this.cancelFormData.tempReason=void 0,this.cancelFormData.reason=""},cancelOpened:function(){this.$refs.cancelForm.clearValidate()},beforeClose:function(){var e=this;this.$refs.cancelForm.resetFields(),setTimeout((function(){e.$refs.cancelForm.clearValidate(),e.cancelDialog=!1}),100)},deleteCancel:function(){var e=this,t="";t="Immediate"!==this.host_cancel.type?"您已选择到期时自动删除产品，当前可关闭停用设置，是否关闭？":"您已选择立刻删除产品，当前可关闭停用设置，是否关闭？",this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["e"])({id:e.pid});case 2:a=t.sent,n=a.data,200!==n.status?e.$message.error(n.msg):(e.getData(),e.$message.success(n.msg));case 5:case"end":return t.stop()}}),t)})))).catch((function(){}))}},created:function(){this.getId(),this.getData(),this.getPriceData(),this.getRechargeList()},watch:{"form.billingcycles":{handler:function(e){var t=this.cycle.filter((function(t){return t.billingcycle===e}));this.myCycle=t[0].billingcycle_zh.replace("付",""),this.getPrice(e)},deep:!0},"search.input":{handler:function(){var e=this;this.search.timer&&clearTimeout(this.search.timer),this.search.timer=setTimeout((function(){e.getRechargeList()}),200)},deep:!0}}},u=l,d=(a("8676"),a("2877")),m=Object(d["a"])(u,n,r,!1,null,"00c43abc",null);t["default"]=m.exports},"4de4":function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").filter,s=a("1dde"),i=a("ae40"),c=s("filter"),o=i("filter");n({target:"Array",proto:!0,forced:!c||!o},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"841c":function(e,t,a){"use strict";var n=a("d784"),r=a("825a"),s=a("1d80"),i=a("129f"),c=a("14c3");n("search",1,(function(e,t,a){return[function(t){var a=s(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a):new RegExp(t)[e](String(a))},function(e){var n=a(t,e,this);if(n.done)return n.value;var s=r(e),o=String(this),l=s.lastIndex;i(l,0)||(s.lastIndex=0);var u=c(s,o);return i(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},8676:function(e,t,a){"use strict";var n=a("89e1"),r=a.n(n);r.a},"89e1":function(e,t,a){}}]);