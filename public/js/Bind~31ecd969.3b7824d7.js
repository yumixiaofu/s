(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Bind~31ecd969"],{"25f0":function(e,t,a){"use strict";var n=a("6eeb"),r=a("825a"),i=a("d039"),o=a("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),m=l.name!=s;(u||m)&&n(RegExp.prototype,s,(function(){var e=r(this),t=String(e.source),a=e.flags,n=String(void 0===a&&e instanceof RegExp&&!("flags"in c)?o.call(e):a);return"/"+t+"/"+n}),{unsafe:!0})},"44e7":function(e,t,a){var n=a("861d"),r=a("c6b6"),i=a("b622"),o=i("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},"4d63":function(e,t,a){var n=a("83ab"),r=a("da84"),i=a("94ca"),o=a("7156"),s=a("9bf2").f,c=a("241c").f,l=a("44e7"),u=a("ad6d"),m=a("9f7f"),p=a("6eeb"),h=a("d039"),d=a("69f3").set,f=a("2626"),g=a("b622"),b=g("match"),v=r.RegExp,x=v.prototype,w=/a/g,D=/a/g,C=new v(w)!==w,k=m.UNSUPPORTED_Y,T=n&&i("RegExp",!C||k||h((function(){return D[b]=!1,v(w)!=w||v(D)==D||"/a/i"!=v(w,"i")})));if(T){var $=function(e,t){var a,n=this instanceof $,r=l(e),i=void 0===t;if(!n&&r&&e.constructor===$&&i)return e;C?r&&!i&&(e=e.source):e instanceof $&&(i&&(t=u.call(e)),e=e.source),k&&(a=!!t&&t.indexOf("y")>-1,a&&(t=t.replace(/y/g,"")));var s=o(C?new v(e,t):v(e,t),n?this:x,$);return k&&a&&d(s,{sticky:a}),s},_=function(e){e in $||s($,e,{configurable:!0,get:function(){return v[e]},set:function(t){v[e]=t}})},y=c(v),I=0;while(y.length>I)_(y[I++]);x.constructor=$,$.prototype=x,p(r,"RegExp",$)}f("RegExp")},dd1a:function(e,t,a){"use strict";var n=a("e46e"),r=a.n(n);r.a},e46e:function(e,t,a){},eaf1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"bind"},[a("div",{staticClass:"login_box"},[a("div",{staticClass:"limit"},[a("el-tabs",{staticClass:"nopl-30",attrs:{stretch:""},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[0===e.pageData.callbackBind||1===e.pageData.callbackBind?a("el-tab-pane",{attrs:{label:"手机绑定",name:"phone"}},[a("el-form",{ref:"phoneForm",attrs:{model:e.formData,rules:e.rules,size:"large","label-width":null}},[a("el-form-item",{attrs:{label:"",prop:"phone"}},[a("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入手机号"},model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone","string"===typeof t?t.trim():t)},expression:"formData.phone"}},[a("el-select",{style:{width:"130px"},attrs:{slot:"prepend",filterable:""},slot:"prepend",model:{value:e.formData.phone_code,callback:function(t){e.$set(e.formData,"phone_code",t)},expression:"formData.phone_code"}},e._l(e.phoneCodeOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.link,value:e.phone_code}})})),1)],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.registerPhoneCaptcha,expression:"registerPhoneCaptcha"}],attrs:{prop:"captcha",rules:{required:e.registerPhoneCaptcha,message:"请输入图形验证码"}}},[a("captcha",{ref:"registerPhoneCaptcha",attrs:{name:"allow_register_phone_captcha",isCaptcha:e.registerPhoneCaptcha},on:{"update:isCaptcha":function(t){e.registerPhoneCaptcha=t},"update:is-captcha":function(t){e.registerPhoneCaptcha=t}},model:{value:e.formData.captcha,callback:function(t){e.$set(e.formData,"captcha",t)},expression:"formData.captcha"}})],1),a("el-form-item",{attrs:{label:"",prop:"code"}},[a("el-input",{style:{width:"100%"},attrs:{maxlength:10,placeholder:"请输入验证码"},model:{value:e.formData.code,callback:function(t){e.$set(e.formData,"code","string"===typeof t?t.trim():t)},expression:"formData.code"}},[a("el-button",{attrs:{slot:"append",loading:e.phoneLoading,disabled:e.phoneIsDisabled},on:{click:e.sendPhoneCode},slot:"append"},[e._v(" "+e._s(e.phoneBtnTxt)+" ")])],1)],1)],1)],1):e._e(),0===e.pageData.callbackBind||2===e.pageData.callbackBind?a("el-tab-pane",{attrs:{lazy:"",label:"邮箱绑定",name:"email"}},[a("el-form",{ref:"emailForm",attrs:{model:e.emailFormData,rules:e.rules,size:"large","label-width":null}},[a("el-form-item",{attrs:{label:"",prop:"email"}},[a("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入邮箱"},model:{value:e.emailFormData.email,callback:function(t){e.$set(e.emailFormData,"email","string"===typeof t?t.trim():t)},expression:"emailFormData.email"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.registerEmailCaptcha,expression:"registerEmailCaptcha"}],attrs:{prop:"captcha",rules:{required:e.registerEmailCaptcha,message:"请输入图形验证码"}}},[a("captcha",{ref:"registerEmailCaptcha",attrs:{name:"allow_register_email_captcha",isCaptcha:e.registerEmailCaptcha},on:{"update:isCaptcha":function(t){e.registerEmailCaptcha=t},"update:is-captcha":function(t){e.registerEmailCaptcha=t}},model:{value:e.emailFormData.captcha,callback:function(t){e.$set(e.emailFormData,"captcha",t)},expression:"emailFormData.captcha"}})],1),a("el-form-item",{attrs:{label:"",prop:"code"}},[a("el-input",{style:{width:"100%"},attrs:{maxlength:10,placeholder:"请输入验证码"},model:{value:e.emailFormData.code,callback:function(t){e.$set(e.emailFormData,"code","string"===typeof t?t.trim():t)},expression:"emailFormData.code"}},[a("el-button",{attrs:{slot:"append",loading:e.emailLoading,disabled:e.emailIsDisabled},on:{click:e.sendEmailCode},slot:"append"},[e._v(" "+e._s(e.emailBtnTxt)+" ")])],1)],1)],1)],1):e._e()],1),null!==e.pageData.callbackBind?a("el-button",{style:{width:"100%",height:"46px"},attrs:{type:"primary",loading:e.submitLoading},on:{click:e.dispatchCommit}},[e._v("提交")]):e._e()],1)])])},r=[],i=(a("4d63"),a("ac1f"),a("25f0"),a("96cf"),a("1da1")),o=a("a78e"),s=a.n(o),c=a("7555"),l=a("a27e");function u(){return Object(l["a"])({url:"/oauth/callbackInfo"})}function m(e){return Object(l["a"])({url:"/oauth/bind_login_email",method:"post",data:e})}function p(e){return Object(l["a"])({url:"/oauth/bind_login_phone",method:"post",data:e})}function h(e){return Object(l["a"])({url:"/oauth/bind_phone_send",method:"post",data:e})}function d(e,t){return Object(l["a"])({url:"/oauth/bind_email_send",method:"post",data:{email:e,captcha:t}})}var f={metaInfo:function(){return{title:"绑定"}},data:function(){return{phoneLoading:!1,emailLoading:!1,registerPhoneCaptcha:!1,registerEmailCaptcha:!1,submitLoading:!1,phoneCodeTimer:null,phoneBtnTxt:"发送验证码",phoneIsDisabled:!1,phoneTime:59,emailCodeTimer:null,emailBtnTxt:"发送验证码",emailIsDisabled:!1,emailTime:59,activeName:"phone",pageData:{callbackBind:null},phoneCodeOptions:[],formData:{phone_code:"+86",phone:"",code:"",captcha:""},emailFormData:{email:"",code:"",captcha:""},rules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^\d{5,13}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{pattern:/^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@(([0-9a-zA-Z])+([-\w]*[0-9a-zA-Z])*\.)+[a-zA-Z]{2,9})$/,message:"请输入正确的邮箱",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]}}},created:function(){this.getCallbackInfo(),this.getLogin()},mounted:function(){},methods:{sendPhoneCode:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.phoneForm.validateField("captcha",function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=4;break}return t.abrupt("return",!1);case 4:return n={phone_code:e.formData.phone_code,phone:e.formData.phone,captcha:e.formData.captcha,mk:s.a.get("msfntk")},e.phoneLoading=!0,t.next=8,h(n);case 8:if(r=t.sent,i=r.data,200===i.status){t.next=16;break}return e.$message.error(i.msg),e.phoneLoading=!1,e.$refs.registerPhoneCaptcha.getVerify(),e.cancelPhoneCode(),t.abrupt("return");case 16:e.$message.success(i.msg),e.phoneLoading=!1,e.phoneIsDisabled=!0,e.phoneBtnTxt="".concat(e.phoneTime+1,"秒后重新发送"),e.phoneCodeTimer=setInterval((function(){e.phoneBtnTxt="".concat(e.phoneTime,"秒后重新发送"),--e.phoneTime,e.phoneTime<0&&(clearInterval(e.phoneCodeTimer),e.phoneBtnTxt=e.$options.data().phoneBtnTxt,e.phoneTime=e.$options.data().phoneTime,e.phoneIsDisabled=!1)}),1e3);case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},cancelPhoneCode:function(){clearInterval(this.phoneCodeTimer),this.phoneBtnTxt=this.$options.data().phoneBtnTxt,this.phoneTime=59,this.phoneIsDisabled=!1},cancelEmailCode:function(){clearInterval(this.emailCodeTimer),this.emailBtnTxt=this.$options.data().emailBtnTxt,this.emailTime=59,this.emailIsDisabled=!1},sendEmailCode:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.emailForm.validateField("captcha",function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=4;break}return t.abrupt("return",!1);case 4:return e.emailLoading=!0,t.next=7,d(e.emailFormData.email,e.emailFormData.captcha);case 7:if(n=t.sent,r=n.data,200===r.status){t.next=15;break}return e.$message.error(r.msg),e.emailLoading=!1,e.$refs.registerEmailCaptcha.getVerify(),e.cancelEmailCode(),t.abrupt("return");case 15:e.$message.success(r.msg),e.emailIsDisabled=!0,e.emailLoading=!1,e.emailBtnTxt="".concat(e.emailTime+1,"秒后重新发送"),e.emailCodeTimer=setInterval((function(){e.emailBtnTxt="".concat(e.emailTime,"秒后重新发送"),--e.emailTime,e.emailTime<0&&(clearInterval(e.emailCodeTimer),e.emailBtnTxt=e.$options.data().emailBtnTxt,e.emailTime=e.$options.data().emailTime,e.emailIsDisabled=!1)}),1e3);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},getLogin:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["d"])();case 2:if(a=t.sent,n=a.data,200===n.status){t.next=6;break}return t.abrupt("return",!1);case 6:e.phoneCodeOptions=n.data;case 7:case"end":return t.stop()}}),t)})))()},getCallbackInfo:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:if(a=t.sent,n=a.data,200===n.status){t.next=7;break}return e.$message.error(n.msg),t.abrupt("return");case 7:e.pageData=n.data,e.activeName=2===n.data.callbackBind?"email":"phone";case 9:case"end":return t.stop()}}),t)})))()},dispatchCommit:function(){this.submitLoading=!0,"phone"===this.activeName?this.phoneSubmit():this.emailSubmit()},phoneSubmit:function(){var e=this;this.$refs.phoneForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,p(e.formData);case 4:if(n=t.sent,r=n.data,200===r.status){t.next=12;break}return e.$message.error(r.msg),"invalid"===(null===r||void 0===r?void 0:r.oauthStatus)&&setTimeout((function(){e.$router.push({name:"Login"})}),1e3),e.submitLoading=!1,e.$refs.registerPhoneCaptcha.getVerify(),t.abrupt("return");case 12:e.loginJump(r),e.submitLoading=!1;case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},emailSubmit:function(){var e=this;this.$refs.emailForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,m(e.emailFormData);case 4:if(n=t.sent,r=n.data,200===r.status){t.next=12;break}return e.$message.error(r.msg),"invalid"===(null===r||void 0===r?void 0:r.oauthStatus)&&setTimeout((function(){e.$router.push({name:"Login"})}),1e3),e.submitLoading=!1,e.$refs.registerEmailCaptcha.getVerify(),t.abrupt("return");case 12:e.loginJump(r),e.submitLoading=!1;case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},loginJump:function(e){this.$message.success(e.msg);var t=7200,a=new Date(1*new Date+1e3*t);s.a.set("OrfLcI2IqQItv0vS",e.jwt,{expires:a,path:"/"}),window.localStorage.setItem("OrfLcI2IqQItv0vS",e.jwt),this.cancelPhoneCode(),this.cancelEmailCode(),this.$router.push("/")},resetForm:function(){this.$refs.phoneForm.resetFields()}},computed:{},watch:{"formData.phone":{handler:function(e){var t=/^\d{5,13}$/,a=new RegExp(t);this.phoneIsDisabled=!a.test(e)},deep:!0,immediate:!0},"emailFormData.email":{handler:function(e){var t=/^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@(([0-9a-zA-Z])+([-\w]*[0-9a-zA-Z])*\.)+[a-zA-Z]{2,9})$/,a=new RegExp(t);this.emailIsDisabled=!a.test(e)},deep:!0,immediate:!0}}},g=f,b=(a("dd1a"),a("2877")),v=Object(b["a"])(g,n,r,!1,null,"63dc4819",null);t["default"]=v.exports}}]);