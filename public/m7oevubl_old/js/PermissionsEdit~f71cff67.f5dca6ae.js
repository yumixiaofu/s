(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["PermissionsEdit~f71cff67"],{"224c":function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return s})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return d}));var r=a("a27e");function n(){return Object(r["a"])({url:"rbac",method:"get"})}function s(){return Object(r["a"])({url:"rbac/role_page",method:"get"})}function i(e){return Object(r["a"])({url:"rbac",method:"post",data:e})}function o(e){return Object(r["a"])({url:"rbac/"+e,method:"get"})}function c(e){return Object(r["a"])({url:"rbac/edit",method:"post",data:e})}function d(e){return Object(r["a"])({url:"rbac/"+e+"/",method:"delete"})}},"7db2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v("添加分组")]),a("el-divider"),a("el-row",{staticClass:"topform_wrap pb-20"},[a("el-form",{ref:"addFromDataRef",attrs:{model:e.addFromData,"label-width":e.labelWidth,"label-position":"top"}},[a("el-form-item",{attrs:{label:"分组名称",prop:"name",rules:[{required:!0,message:"分组名称不能为空"}]}},[a("el-input",{style:{width:"260px"},attrs:{size:"small"},model:{value:e.addFromData.name,callback:function(t){e.$set(e.addFromData,"name",t)},expression:"addFromData.name"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"remark"}},[a("el-input",{style:{width:"260px"},attrs:{size:"small"},model:{value:e.addFromData.remark,callback:function(t){e.$set(e.addFromData,"remark",t)},expression:"addFromData.remark"}})],1),a("el-form-item",{attrs:{label:"权限"}},[a("el-input",{style:{width:"260px"},attrs:{size:"small",placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),a("el-tree",{ref:"powerTree",style:{width:"260px"},attrs:{data:e.seleceArray,"show-checkbox":"","node-key":"id","default-checked-keys":e.addFromData.auth,"filter-node-method":e.filterNode,props:{children:"sublevel",label:"title"}}}),a("el-button",{attrs:{size:"small"},on:{click:e.checkAll}},[e._v("全 选")]),a("el-button",{attrs:{size:"small"},on:{click:e.cancelAll}},[e._v("取消全选")])],1),a("el-form-item",{attrs:{label:"禁用",prop:"status"}},[a("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:e.addFromData.status,callback:function(t){e.$set(e.addFromData,"status",t)},expression:"addFromData.status"}})],1),a("el-form-item",{attrs:{label:"分组用户",prop:"user"}},e._l(e.addFromData.user,(function(t){return a("el-tag",{key:t.id,staticClass:"mr-10",attrs:{size:"small",effect:"plain"}},[e._v(e._s(t.user_login))])})),1)],1)],1),a("div",{staticClass:"bottomOperationAdd"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.saveData}},[e._v("提交")]),a("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返回")]),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1),a("second",{attrs:{secondVerifyVis:e.secondVerifyVis,secondAction:e.secondAction},on:{secondClose:function(t){e.secondVerifyVis=!1},secondeVerifySuccess:e.secondeVerifySuccess}})],1)},n=[],s=(a("99af"),a("4de4"),a("4160"),a("caad"),a("c975"),a("b0c0"),a("2532"),a("159b"),a("2909")),i=a("b85c"),o=(a("96cf"),a("1da1")),c=a("224c"),d=a("bbcf"),u=a("7ded"),l={metaInfo:{title:"编辑权限"},data:function(){return{labelWidth:window.document.body.clientWidth>768?"120px":null,filterText:"",seleceArray:[],addFromData:{id:"",name:"",remark:"",auth:[1329,306,307],status:!1,user:[]},btnLoading:!1,second_verify_admin:0,second_verify_action_admin:[],secondVerifyVis:!1,secondAction:"create_admin_group"}},components:{second:d["a"]},watch:{filterText:function(e){this.$refs.powerTree.filter(e)}},methods:{testFunc:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.empty(),a=e.$route.query.id,e.addFromData.id=a||"",e.detailPermiss();case 4:case"end":return t.stop()}}),t)})))()},detailPermiss:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,o,d,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.addFromData.id){t.next=8;break}return t.next=3,Object(c["f"])();case 3:a=t.sent,r=a.data,200!==r.status?e.$message.error(r.msg):e.seleceArray=r.auths,t.next=23;break;case 8:return t.next=10,Object(c["c"])(e.addFromData.id);case 10:if(n=t.sent,s=n.data,s.role){t.next=14;break}return t.abrupt("return",!1);case 14:return e.addFromData.name=s.role.name,e.addFromData.remark=s.role.remark,1===s.role.status?e.addFromData.status=!1:e.addFromData.status=!0,t.next=19,s.auths;case 19:e.seleceArray=t.sent,setTimeout((function(){e.addFromData.auth=[],(s.auth_select||[]).forEach((function(t){var a=e.$refs.powerTree.getNode(t);a.isLeaf&&e.addFromData.auth.push(t)}))}),500),o=Object(i["a"])(s.user);try{for(o.s();!(d=o.n()).done;)u=d.value,null!==u.user_login&&e.addFromData.user.push({id:u.id,user_login:u.user_login})}catch(l){o.e(l)}finally{o.f()}case 23:case"end":return t.stop()}}),t)})))()},saveData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.$refs.powerTree.getCheckedKeys(),r=e.$refs.powerTree.getHalfCheckedKeys(),e.addFromData.auth=[].concat(Object(s["a"])(a),Object(s["a"])(r)),e.addFromData.status=e.addFromData.status?0:1,""===e.addFromData.id?1===e.second_verify_admin&&e.second_verify_action_admin.includes("create_admin_group")?(e.secondAction="create_admin_group",e.secondVerifyVis=!0):e.createApi():1===e.second_verify_admin&&e.second_verify_action_admin.includes("modify_admin_group")?(e.secondAction="modify_admin_group",e.secondVerifyVis=!0):e.editApi();case 5:case"end":return t.stop()}}),t)})))()},createApi:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.btnLoading=!0,t.next=3,Object(c["a"])(e.addFromData);case 3:a=t.sent,r=a.data,200===r.status?(e.$message.success(r.msg),e.empty(),e.goBack()):e.$message.error(r.msg),e.btnLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},editApi:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.btnLoading=!0,t.next=3,Object(c["d"])(e.addFromData);case 3:a=t.sent,r=a.data,200===r.status?(e.$message.success(r.msg),e.empty(),e.goBack()):e.$message.error(r.msg),e.btnLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},checkAll:function(){this.addFromData.auth=[];var e,t=Object(i["a"])(this.seleceArray);try{for(t.s();!(e=t.n()).done;){var a=e.value;this.addFromData.auth.push(a.id)}}catch(r){t.e(r)}finally{t.f()}},cancelAll:function(){this.$refs.powerTree.setCheckedKeys([])},goBack:function(){this.$router.push({name:"permissionsManagment"})},resetForm:function(){this.$refs.addFromDataRef.resetFields()},empty:function(){this.addFromData.name="",this.addFromData.remark="",this.addFromData.auth=[],this.addFromData.status=!1},filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},getCommonData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])();case 2:if(a=t.sent,r=a.data,200===r.status){t.next=6;break}return t.abrupt("return",!1);case 6:e.second_verify_admin=parseInt(r.data.second_verify_admin),e.second_verify_action_admin=r.data.second_verify_action_admin;case 8:case"end":return t.stop()}}),t)})))()},secondeVerifySuccess:function(e){this.addFromData.code=e,this.$route.query.id?this.$route.query.id&&this.editApi():this.createApi()}},created:function(){this.getCommonData()},mounted:function(){this.testFunc()}},m=l,f=(a("997c"),a("2877")),h=Object(f["a"])(m,r,n,!1,null,"044ff03e",null);t["default"]=h.exports},"997c":function(e,t,a){"use strict";var r=a("e4ab"),n=a.n(r);n.a},bbcf:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",e._g(e._b({attrs:{visible:e.mySecondVerifyVis,title:"二次验证",width:"500px"},on:{"update:visible":function(t){e.mySecondVerifyVis=t},close:e.secondDialogClose}},"el-dialog",e.$attrs,!1),e.$listeners),[a("el-form",{ref:"secondVerifyForm",attrs:{model:e.secondVerifyFormData,rules:e.secondVerifyRules,size:"medium","label-width":"100px"}},[a("el-form-item",{attrs:{label:"验证码",prop:"code"}},[a("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入验证码",clearable:""},model:{value:e.secondVerifyFormData.code,callback:function(t){e.$set(e.secondVerifyFormData,"code",t)},expression:"secondVerifyFormData.code"}},[a("el-button",{attrs:{slot:"append",disabled:"获取验证码"!==e.changeBtnValue},on:{click:e.sendCode},slot:"append"},[e._v(e._s(e.changeBtnValue))])],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.secondVerifyClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.secondVerifySubmit}},[e._v("确定")])],1)],1)],1)},n=[],s=(a("96cf"),a("1da1")),i=a("7ded"),o={props:{secondVerifyVis:{type:Boolean,default:!1},secondAction:{type:String,default:""}},data:function(){return{mySecondVerifyVis:!1,changeBtnValue:"获取验证码",secondVerifyFormData:{code:void 0},secondVerifyRules:{code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},btnLoading:!1,selectedTypeAccount:""}},methods:{secondDialogClose:function(){this.$emit("secondClose",!1),this.$refs.secondVerifyForm.clearValidate(),this.$refs.secondVerifyForm.resetFields()},countDown:function(){var e=this,t=60;this.changeBtnValue=t+"s后重试",this.timer=setInterval((function(){0===t?(clearInterval(e.timer),e.codeBtnDisabled=!1,e.changeBtnValue="获取验证码"):(e.codeBtnDisabled=!0,e.changeBtnValue=t+"s后重试",t--)}),1e3)},sendCode:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.countDown(),t.next=3,Object(i["f"])({action:e.secondAction});case 3:a=t.sent,r=a.data,200!==r.status?e.$message.error(r.msg):e.$message.success(r.msg);case 6:case"end":return t.stop()}}),t)})))()},secondVerifyClose:function(){this.$refs.secondVerifyForm.clearValidate(),this.$refs.secondVerifyForm.resetFields(),this.secondVerifyVis=!1},secondVerifySubmit:function(){var e=this;this.$refs.secondVerifyForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:e.$emit("secondeVerifySuccess",e.secondVerifyFormData.code);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},watch:{secondVerifyVis:function(e){this.mySecondVerifyVis=e}},mounted:function(){this.mySecondVerifyVis=this.secondVerifyVis}},c=o,d=a("2877"),u=Object(d["a"])(c,r,n,!1,null,"c3111f1c",null);t["a"]=u.exports},e4ab:function(e,t,a){}}]);