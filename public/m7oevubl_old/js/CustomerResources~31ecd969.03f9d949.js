(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CustomerResources~31ecd969"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"3f74":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("el-input",{staticClass:"mr-10",style:{width:"150px"},attrs:{size:"small",placeholder:"输入关键字",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData(t)}},model:{value:e.search.username,callback:function(t){e.$set(e.search,"username",t)},expression:"search.username"}}),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search",loading:e.tableLoading},on:{click:e.getData}},[e._v("搜索")]),a("el-table",{staticClass:"mt-20 mb-10",attrs:{data:e.tableData},on:{"sort-change":e.changeSort}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.tableData.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),e.tableData.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("router-link",{attrs:{to:{path:"/customer-view/abstract",query:{id:r.id}}}},[a("el-link",{attrs:{type:"primary"}},[e._v(e._s(r.id))])],1)]}}])}),a("el-table-column",{attrs:{prop:"username",label:"客户名称",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("router-link",{attrs:{to:{path:"/customer-view/abstract",query:{id:r.id}}}},[a("el-link",{style:{color:r.group_colour},attrs:{type:"primary"}},[e._v(e._s(r.username))])],1)]}}])}),a("el-table-column",{attrs:{prop:"amount_in",label:"收入",sortable:""}}),a("el-table-column",{attrs:{prop:"credit",label:"余额",sortable:""}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(e.$moment(1e3*r.create_time).format("YYYY-MM-DD HH:mm")))])]}}])}),a("el-table-column",{attrs:{prop:"",label:"添加销售",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-button",{staticClass:"span-primary",attrs:{size:"mini",type:"text"},on:{click:function(t){return e.addSale(r)}}},[e._v("添加")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":e.search.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getData,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)},"update:pageSize":function(t){return e.$set(e.search,"limit",t)},"update:page-size":function(t){return e.$set(e.search,"limit",t)}}}),a("el-dialog",{attrs:{title:"添加销售",visible:e.addSaleVis,width:"450px"},on:{"update:visible":function(t){e.addSaleVis=t},open:e.getSaleList,close:e.addSaleClose}},[a("el-form",{ref:"addSaleFormRef",attrs:{model:e.addSaleForm,"label-width":"120px"}},[a("el-form-item",{attrs:{prop:"sale_id",label:"销售代表",rules:{required:!0,message:"请选择销售代表",trigger:"change"}}},[a("el-select",{attrs:{size:"small",filterable:""},model:{value:e.addSaleForm.sale_id,callback:function(t){e.$set(e.addSaleForm,"sale_id",t)},expression:"addSaleForm.sale_id"}},e._l(e.saleList,(function(e,t){return a("el-option",{key:t+"sale",attrs:{value:e.value,label:e.label}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.addSaleSubmit}},[e._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addSaleVis=!1}}},[e._v("取消")])],1)],1)],1)},n=[],s=(a("a9e3"),a("ac1f"),a("841c"),a("96cf"),a("1da1")),i=a("a2e7"),o={data:function(){return{tableLoading:!1,tableData:[],total:0,search:{page:1,limit:Number(localStorage.getItem("limit"))||50,order:"id",sort:"DESC",username:void 0},addSaleVis:!1,addSaleForm:{uid:void 0,sale_id:void 0},btnLoading:!1,saleList:[]}},created:function(){this.getData()},mounted:function(){},methods:{getData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(i["d"])(e.search);case 3:a=t.sent,r=a.data,e.tableLoading=!1,200!==r.status?e.$message.error(r.msg):(e.tableData=r.list,e.total=r.total);case 7:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.search.page=1,e.getData();case 2:case"end":return t.stop()}}),t)})))()},changeSort:function(e){"amount_in"!==e.prop&&("descending"===e.order?(this.search.order=e.prop,this.search.sort="DESC"):(this.search.order=e.prop,this.search.sort="AESC"),this.getData())},getSaleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["e"])();case 2:a=t.sent,r=a.data,200!==r.status?e.$message.error(r.msg):e.saleList=r.data;case 5:case"end":return t.stop()}}),t)})))()},addSale:function(e){this.addSaleVis=!0,this.addSaleForm.uid=e.id},addSaleSubmit:function(){var e=this;this.$refs.addSaleFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:return e.btnLoading=!0,t.next=5,Object(i["c"])(e.addSaleForm);case 5:r=t.sent,n=r.data,e.btnLoading=!1,200!==n.status?e.$message.error(n.msg):(e.$message.success(n.msg),e.getData(),e.addSaleVis=!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},addSaleClose:function(){this.$refs.addSaleFormRef.clearValidate(),this.$refs.addSaleFormRef.resetFields()}},computed:{},watch:{}},l=o,u=a("2877"),c=Object(u["a"])(l,r,n,!1,null,"078fb123",null);t["default"]=c.exports},"841c":function(e,t,a){"use strict";var r=a("d784"),n=a("825a"),s=a("1d80"),i=a("129f"),o=a("14c3");r("search",1,(function(e,t,a){return[function(t){var a=s(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,a):new RegExp(t)[e](String(a))},function(e){var r=a(t,e,this);if(r.done)return r.value;var s=n(e),l=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var c=o(s,l);return i(s.lastIndex,u)||(s.lastIndex=u),null===c?-1:c.index}]}))},a2e7:function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return c}));var r=a("a27e");function n(e){return Object(r["a"])({url:"client_list_resource",params:e})}function s(){return Object(r["a"])({url:"common/sale_list"})}function i(e){return Object(r["a"])({url:"bind_sale",method:"post",data:e})}function o(e){return Object(r["a"])({url:"add_record_log",method:"post",data:e})}function l(e){return Object(r["a"])({url:"add_remark_log",method:"post",data:e})}function u(e){return Object(r["a"])({url:"track_record",params:e})}function c(e){return Object(r["a"])({url:"track_status",method:"post",data:e})}}}]);