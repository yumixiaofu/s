(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["WorkOrderRules~31ecd969"],{1276:function(t,e,r){"use strict";var a=r("d784"),n=r("44e7"),o=r("825a"),i=r("1d80"),s=r("4840"),l=r("8aa5"),u=r("50c4"),c=r("14c3"),d=r("9263"),f=r("d039"),m=[].push,p=Math.min,g=4294967295,h=!f((function(){return!RegExp(g,"y")}));a("split",2,(function(t,e,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var a=String(i(this)),o=void 0===r?g:r>>>0;if(0===o)return[];if(void 0===t)return[a];if(!n(t))return e.call(a,t,o);var s,l,u,c=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,h=new RegExp(t.source,f+"g");while(s=d.call(h,a)){if(l=h.lastIndex,l>p&&(c.push(a.slice(p,s.index)),s.length>1&&s.index<a.length&&m.apply(c,s.slice(1)),u=s[0].length,p=l,c.length>=o))break;h.lastIndex===s.index&&h.lastIndex++}return p===a.length?!u&&h.test("")||c.push(""):c.push(a.slice(p)),c.length>o?c.slice(0,o):c}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var n=i(this),o=void 0==e?void 0:e[t];return void 0!==o?o.call(e,n,r):a.call(String(n),e,r)},function(t,n){var i=r(a,t,this,n,a!==e);if(i.done)return i.value;var d=o(t),f=String(this),m=s(d,RegExp),b=d.unicode,_=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(h?"y":"g"),v=new m(h?d:"^(?:"+d.source+")",_),k=void 0===n?g:n>>>0;if(0===k)return[];if(0===f.length)return null===c(v,f)?[f]:[];var y=0,w=0,x=[];while(w<f.length){v.lastIndex=h?w:0;var D,O=c(v,h?f:f.slice(w));if(null===O||(D=p(u(v.lastIndex+(h?0:w)),f.length))===y)w=l(f,w,b);else{if(x.push(f.slice(y,w)),x.length===k)return x;for(var j=1;j<=O.length-1;j++)if(x.push(O[j]),x.length===k)return x;w=y=D}}return x.push(f.slice(y)),x}]}),!h)},"13d5":function(t,e,r){"use strict";var a=r("23e7"),n=r("d58f").left,o=r("a640"),i=r("ae40"),s=o("reduce"),l=i("reduce",{1:0});a({target:"Array",proto:!0,forced:!s||!l},{reduce:function(t){return n(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"22fc":function(t,e,r){"use strict";r.d(e,"g",(function(){return n})),r.d(e,"e",(function(){return o})),r.d(e,"d",(function(){return i})),r.d(e,"f",(function(){return s})),r.d(e,"a",(function(){return l})),r.d(e,"c",(function(){return u})),r.d(e,"b",(function(){return c})),r.d(e,"h",(function(){return d})),r.d(e,"i",(function(){return f}));var a=r("a27e");function n(){return Object(a["a"])({url:"list_ticket_department"})}function o(){return Object(a["a"])({url:"get_ticket_deliver"})}function i(){return Object(a["a"])({url:"get_ticket_department"})}function s(t){return Object(a["a"])({url:"list_ticket_department/"+t})}function l(t){return Object(a["a"])({url:"add_ticket_department",method:"post",data:t})}function u(t){return Object(a["a"])({url:"save_ticket_department",method:"post",data:t})}function c(t){return Object(a["a"])({url:"delete_ticket_department",method:"post",data:t})}function d(t){return Object(a["a"])({url:"movedown_ticket_department",method:"post",data:t})}function f(t){return Object(a["a"])({url:"moveup_ticket_department",method:"post",data:t})}},"45fc":function(t,e,r){"use strict";var a=r("23e7"),n=r("b727").some,o=r("a640"),i=r("ae40"),s=o("some"),l=i("some");a({target:"Array",proto:!0,forced:!s||!l},{some:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},"47bf":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-row",{staticClass:"mt-10"},[r("el-col",{attrs:{md:24}},[r("el-button",{attrs:{size:"small",type:"success"},on:{click:t.addHandleClick}},[r("i",{staticClass:"el-icon-plus"}),t._v(" 添加规则 ")])],1)],1),r("el-table",{staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{data:t.workOrderRulesTableData,"default-sort":{prop:"order"},border:""}},[r("div",{attrs:{slot:"empty"},slot:"empty"},[!t.workOrderRulesTableData.length&&t.tableLoading?r("span",[r("i",{staticClass:"el-icon-loading"}),t._v(" 正在加载 ... ")]):t._e(),t.workOrderRulesTableData.length||t.tableLoading?t._e():r("span",[t._v("暂无数据")])]),r("el-table-column",{attrs:{prop:"departments",label:"部门",sortable:"",formatter:t.formatterDepartments}}),r("el-table-column",{attrs:{prop:"products",label:"产品",sortable:"",formatter:t.formatterDepartments}}),r("el-table-column",{attrs:{prop:"mask_keywords",label:"屏蔽关键字",sortable:"",formatter:t.formatterKeywords}}),r("el-table-column",{attrs:{prop:"is_open_auto_reply",width:"120",label:"自动回复",sortable:"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[r("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:a.is_open_auto_reply,callback:function(e){t.$set(a,"is_open_auto_reply",e)},expression:"row.is_open_auto_reply"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"130",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(r){return t.editHandleClick(e.row)}}},[t._v("编辑")]),r("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteHandleClick(e.row.id)}}},[t._v("删除")])]}}])})],1),r("el-dialog",{attrs:{title:""===t.rulesId?"添加工单传递规则":"修改工单传递规则",visible:t.dialogFormVisible,width:"500px"},on:{"update:visible":function(e){t.dialogFormVisible=e},closed:t.dialogClosed}},[r("el-form",{ref:"elForm",attrs:{model:t.formData,rules:t.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"部门",prop:"departments"}},[r("el-select",{staticStyle:{width:"85%"},attrs:{multiple:"",filterable:"",clearable:"",placeholder:"请选择","collapse-tags":""},model:{value:t.formData.departments,callback:function(e){t.$set(t.formData,"departments",e)},expression:"formData.departments"}},t._l(t.departmentList,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1),r("el-form-item",{attrs:{label:"产品",prop:"products"}},[r("el-select",{staticStyle:{width:"85%"},attrs:{multiple:"",filterable:"",clearable:"",placeholder:"请选择","collapse-tags":""},model:{value:t.formData.products,callback:function(e){t.$set(t.formData,"products",e)},expression:"formData.products"}},t._l(t.productList,(function(e){return r("el-option-group",{key:e.id,staticClass:"specWarpper",attrs:{label:e.name},nativeOn:{click:function(r){return t.selectedGroup(t.productSecondArr,e.id,t.productList,"products","product")}}},[t._l(e.product,(function(e,a){return["zjmf_api"===e.api_type?r("el-option",{key:e.id+"asd"+a,attrs:{label:e.name,value:e.id}}):t._e()]}))],2)})),1)],1),r("el-form-item",{attrs:{label:"自动回复",prop:"is_open_auto_reply"}},[r("el-switch",{staticStyle:{width:"100%"},attrs:{"active-value":1,"inactive-value":0},model:{value:t.formData.is_open_auto_reply,callback:function(e){t.$set(t.formData,"is_open_auto_reply",e)},expression:"formData.is_open_auto_reply"}}),1===t.formData.is_open_auto_reply?r("el-input",{staticStyle:{width:"85%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},maxlength:"100","show-word-limit":""},model:{value:t.formData.bz,callback:function(e){t.$set(t.formData,"bz",e)},expression:"formData.bz"}}):t._e()],1),r("el-form-item",{attrs:{label:"屏蔽关键字",prop:"mask_keywords"}},[r("el-input",{staticStyle:{width:"85%"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},"show-word-limit":""},model:{value:t.formData.mask_keywords,callback:function(e){t.$set(t.formData,"mask_keywords",e)},expression:"formData.mask_keywords"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),r("el-button",{attrs:{size:"small",type:"primary",loading:t.btnLoading},on:{click:t.submitForm}},[t._v("确定")])],1)],1)],1)},n=[],o=(r("99af"),r("4de4"),r("4160"),r("caad"),r("d81d"),r("13d5"),r("45fc"),r("a434"),r("b0c0"),r("d3b7"),r("ac1f"),r("6062"),r("2532"),r("3ca3"),r("1276"),r("159b"),r("ddb0"),r("96cf"),r("1da1")),i=r("2909"),s=r("a27e");function l(){return Object(s["a"])({url:"list_ticket_deliver"})}function u(t){return Object(s["a"])({url:"add_ticket_deliver",method:"post",data:t})}function c(t){return Object(s["a"])({url:"save_ticket_deliver",method:"post",data:t})}function d(t){return Object(s["a"])({url:"delete_ticket_deliver",method:"post",data:t})}var f=r("22fc"),m=r("6a8e"),p={metaInfo:{title:"工单传递规则"},data:function(){return{productSecondArr:[],rulesId:"",tableLoading:!1,workOrderRulesTableData:[],departmentList:[],productList:[],dialogFormVisible:!1,formData:{id:null,departments:[],products:[],is_open_auto_reply:0,bz:"",mask_keywords:""},rules:{departments:[{required:!0,message:"请选择部门",trigger:"blur"}],products:[{required:!0,message:"请选择产品",trigger:"blur"}]},btnLoading:!1}},methods:{selectedGroup:function(t,e,r,a,n){var o=this;if(t.includes(e))(function(){for(var i=[],s=0;s<r.length;s++){var l=r[s];l.id===e&&l[n].forEach((function(t){i.push(t.id)}))}var u=o.formData[a].concat(),c=u.filter((function(t){return!i.includes(t)}));o.formData[a]=c;for(var d=0;d<t.length;d++){var f=t[d];f===e&&t.splice(d,1)}})();else{t.push(e),t=Object(i["a"])(new Set(t));for(var s=r,l=0;l<s.length;l++){var u=s[l];if(e===u.id&&u[n])for(var c=0;c<u[n].length;c++){var d=u[n][c];"zjmf_api"===d.api_type&&this.formData[a].push(d.id)}}this.formData[a]=Object(i["a"])(new Set(this.formData[a]))}},clickSelectGroup:function(t,e,r){t.choose?this.formData[e]=this.formData[e].filter((function(e){return!t[r].some((function(t){return e===t.id}))})):this.formData[e]=Object(i["a"])(new Set(this.formData[e].concat(t[r].map((function(t){return t.id&&"zjmf_api"===t.api_type}))))),t.choose=!t.choose},formatterKeywords:function(t){var e=t.mask_keywords.split("\n"),r=(e||[]).reduce((function(t,r,a){return t+r+(e.length-1!==a?"/":"")}),"");return r},formatterDepartments:function(t,e){var r=(t[e.property]||[]).reduce((function(r,a,n){return r+a.name+(t[e.property].length-1!==n?"/":"")}),"");return r},addHandleClick:function(){this.dialogFormVisible=!0,this.rulesId=""},getData:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableLoading=!0,e.next=3,l();case 3:if(r=e.sent,a=r.data,200===a.status){e.next=9;break}return t.$message.error(a.msg),t.tableLoading=!1,e.abrupt("return");case 9:for(t.tableLoading=!1,n=0;n<a.data.length;n++)o=a.data[n],o.isEdit=!1;t.workOrderRulesTableData=a.data;case 12:case"end":return e.stop()}}),e)})))()},getFormInfoById:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(f["e"])();case 2:return r=e.sent,200===r.data.status&&(t.departmentList=r.data.data.department),e.next=6,Object(m["e"])();case 6:a=e.sent,200===a.data.status&&(t.productList=a.data.client_groups.map((function(t){return t.choose=!1,t})));case 8:case"end":return e.stop()}}),e)})))()},editHandleClick:function(t){this.rulesId=t.id,this.dialogFormVisible=!0,this.formData.id=t.id,this.formData.departments=t.departments.map((function(t){return t.id})),this.formData.products=t.products.map((function(t){return t.id})),this.formData.is_open_auto_reply=t.is_open_auto_reply,this.formData.bz=t.bz,this.formData.mask_keywords=t.mask_keywords},submitForm:function(){var t=this;this.$refs.elForm.validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){var a,n,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=3;break}e.next=20;break;case 3:if(""!==t.rulesId){e.next=13;break}return t.btnLoading=!0,e.next=7,u(t.formData);case 7:a=e.sent,n=a.data,200===n.status?(t.$message({message:n.msg,type:"success"}),t.getData(),t.dialogFormVisible=!1):t.$message({message:n.msg,type:"error"}),t.btnLoading=!1,e.next=20;break;case 13:return t.btnLoading=!0,e.next=16,c(t.formData);case 16:o=e.sent,i=o.data,200===i.status?(t.$message({message:i.msg,type:"success"}),t.getData(),t.dialogFormVisible=!1):t.$message({message:i.msg,type:"error"}),t.btnLoading=!1;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},deleteHandleClick:function(t){var e=this;this.$confirm("此操作将永久删除该规则, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,d({id:t});case 2:a=r.sent,n=a.data,200!==n.status?e.$message.error(n.msg):(e.$message.success(n.msg),e.getData());case 5:case"end":return r.stop()}}),r)})))).catch((function(){}))},dialogClosed:function(){this.$refs.elForm.resetFields()}},created:function(){this.getData(),this.getFormInfoById()}},g=p,h=(r("868c"),r("2877")),b=Object(h["a"])(g,a,n,!1,null,"21624cf0",null);e["default"]=b.exports},"4c7e":function(t,e,r){},"6a8e":function(t,e,r){"use strict";r.d(e,"e",(function(){return n})),r.d(e,"f",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return l})),r.d(e,"d",(function(){return u})),r.d(e,"g",(function(){return c})),r.d(e,"i",(function(){return d})),r.d(e,"h",(function(){return f}));var a=r("a27e");function n(t,e){return Object(a["a"])({url:"common/get_product_list",params:{type:t,id:e}})}function o(t){return Object(a["a"])({url:"common/get_promo_code",params:{type:t}})}function i(){return Object(a["a"])({url:"common/get_getways"})}function s(t){return Object(a["a"])({url:"common/get_email_tem",params:{type:t}})}function l(){return Object(a["a"])({url:"common/get_client_groups"})}function u(t){return Object(a["a"])({url:"common/host_list",params:{uid:t}})}function c(){return Object(a["a"])({url:"common/get_sms_country"})}function d(){return Object(a["a"])({url:"common/product_config_options"})}function f(t){return Object(a["a"])({url:"common/get_upstream_ticket_department_list",params:{id:t}})}},"868c":function(t,e,r){"use strict";var a=r("4c7e"),n=r.n(a);n.a},a434:function(t,e,r){"use strict";var a=r("23e7"),n=r("23cb"),o=r("a691"),i=r("50c4"),s=r("7b0b"),l=r("65f0"),u=r("8418"),c=r("1dde"),d=r("ae40"),f=c("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,g=Math.min,h=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f||!m},{splice:function(t,e){var r,a,c,d,f,m,_=s(this),v=i(_.length),k=n(t,v),y=arguments.length;if(0===y?r=a=0:1===y?(r=0,a=v-k):(r=y-2,a=g(p(o(e),0),v-k)),v+r-a>h)throw TypeError(b);for(c=l(_,a),d=0;d<a;d++)f=k+d,f in _&&u(c,d,_[f]);if(c.length=a,r<a){for(d=k;d<v-a;d++)f=d+a,m=d+r,f in _?_[m]=_[f]:delete _[m];for(d=v;d>v-a+r;d--)delete _[d-1]}else if(r>a)for(d=v-a;d>k;d--)f=d+a-1,m=d+r-1,f in _?_[m]=_[f]:delete _[m];for(d=0;d<r;d++)_[d+k]=arguments[d+2];return _.length=v-a+r,c}})},d58f:function(t,e,r){var a=r("1c0b"),n=r("7b0b"),o=r("44ad"),i=r("50c4"),s=function(t){return function(e,r,s,l){a(r);var u=n(e),c=o(u),d=i(u.length),f=t?d-1:0,m=t?-1:1;if(s<2)while(1){if(f in c){l=c[f],f+=m;break}if(f+=m,t?f<0:d<=f)throw TypeError("Reduce of empty array with no initial value")}for(;t?f>=0:d>f;f+=m)f in c&&(l=r(l,c[f],f,u));return l}};t.exports={left:s(!1),right:s(!0)}},d81d:function(t,e,r){"use strict";var a=r("23e7"),n=r("b727").map,o=r("1dde"),i=r("ae40"),s=o("map"),l=i("map");a({target:"Array",proto:!0,forced:!s||!l},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);