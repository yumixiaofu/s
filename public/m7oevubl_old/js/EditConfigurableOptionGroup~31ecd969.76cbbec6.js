(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["EditConfigurableOptionGroup~31ecd969"],{2532:function(t,e,r){"use strict";var n=r("23e7"),o=r("5a34"),a=r("1d80"),u=r("ab13");n({target:"String",proto:!0,forced:!u("includes")},{includes:function(t){return!!~String(a(this)).indexOf(o(t),arguments.length>1?arguments[1]:void 0)}})},"33e2":function(t,e,r){"use strict";r.d(e,"m",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"l",(function(){return u})),r.d(e,"k",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"f",(function(){return c})),r.d(e,"e",(function(){return l})),r.d(e,"d",(function(){return p})),r.d(e,"g",(function(){return d})),r.d(e,"h",(function(){return f})),r.d(e,"i",(function(){return g})),r.d(e,"a",(function(){return m})),r.d(e,"j",(function(){return b})),r.d(e,"n",(function(){return h}));var n=r("a27e");function o(t){return Object(n["a"])({url:"options/groups_list",params:t})}function a(t){return Object(n["a"])({url:"options/create_groups_post",method:"post",data:t})}function u(t,e){return Object(n["a"])({url:"options/edit_groups/"+t+"?type="+e})}function i(t){return Object(n["a"])({url:"options/edit_groups_post",method:"post",data:t})}function s(t){return Object(n["a"])({url:"options/add_options",method:"post",data:t})}function c(t){return Object(n["a"])({url:"options/delete_sub_options/"+t})}function l(t){return Object(n["a"])({url:"options/delete_options/"+t})}function p(t){return Object(n["a"])({url:"options/delete_groups/"+t})}function d(){return Object(n["a"])({url:"options/duplicate_groups"})}function f(t){return Object(n["a"])({url:"options/duplicate_groups_post",method:"post",data:t})}function g(t,e){return Object(n["a"])({url:"options/edit_config/"+t,params:e})}function m(t){return Object(n["a"])({url:"options/add_options_page",params:t})}function b(t){return Object(n["a"])({url:"options/edit_config_post",method:"post",data:t})}function h(t){return Object(n["a"])({url:"options/search_page",params:t})}},"44e7":function(t,e,r){var n=r("861d"),o=r("c6b6"),a=r("b622"),u=a("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[u])?!!e:"RegExp"==o(t))}},"5a34":function(t,e,r){var n=r("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"6a8e":function(t,e,r){"use strict";r.d(e,"e",(function(){return o})),r.d(e,"f",(function(){return a})),r.d(e,"c",(function(){return u})),r.d(e,"b",(function(){return i})),r.d(e,"a",(function(){return s})),r.d(e,"d",(function(){return c})),r.d(e,"g",(function(){return l})),r.d(e,"i",(function(){return p})),r.d(e,"h",(function(){return d}));var n=r("a27e");function o(t,e){return Object(n["a"])({url:"common/get_product_list",params:{type:t,id:e}})}function a(t){return Object(n["a"])({url:"common/get_promo_code",params:{type:t}})}function u(){return Object(n["a"])({url:"common/get_getways"})}function i(t){return Object(n["a"])({url:"common/get_email_tem",params:{type:t}})}function s(){return Object(n["a"])({url:"common/get_client_groups"})}function c(t){return Object(n["a"])({url:"common/host_list",params:{uid:t}})}function l(){return Object(n["a"])({url:"common/get_sms_country"})}function p(){return Object(n["a"])({url:"common/product_config_options"})}function d(t){return Object(n["a"])({url:"common/get_upstream_ticket_department_list",params:{id:t}})}},ab13:function(t,e,r){var n=r("b622"),o=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[o]=!1,"/./"[t](e)}catch(n){}}return!1}},c0e4:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h2",[t._v(t._s(t.groupId?"编辑":"创建")+"全局配置")]),r("el-divider"),r("el-row",[r("el-col",{staticClass:"from-box",attrs:{xs:24,sm:16,md:11,lg:10,xl:9}},[r("el-form",{ref:"elForm",attrs:{model:t.groupFormData,rules:t.groupRules,"label-width":"100px"}},[r("el-row",[r("el-form-item",{attrs:{label:"组名",prop:"name"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"请输入组名",clearable:""},model:{value:t.groupFormData.name,callback:function(e){t.$set(t.groupFormData,"name",e)},expression:"groupFormData.name"}})],1),r("el-form-item",{attrs:{label:"描述",prop:"description"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"请输入描述",clearable:""},model:{value:t.groupFormData.description,callback:function(e){t.$set(t.groupFormData,"description",e)},expression:"groupFormData.description"}})],1),r("el-form-item",{attrs:{label:"指定产品",prop:"p_id"}},[r("el-select",{style:{width:"100%"},attrs:{size:"small","collapse-tags":"",placeholder:"请选择指定产品",multiple:"",filterable:"",clearable:""},on:{change:function(e){return t.$forceUpdate()}},model:{value:t.groupFormData.p_id,callback:function(e){t.$set(t.groupFormData,"p_id",e)},expression:"groupFormData.p_id"}},t._l(t.groupList,(function(e){return r("el-option-group",{key:"group"+e.id,attrs:{label:e.name}},t._l(e.product,(function(t,e){return r("el-option",{key:"pro"+e,attrs:{label:t.name+"-"+t.type,value:t.id}})})),1)})),1)],1)],1)],1)],1)],1),t.groupId?r("el-row",[r("el-col",{staticClass:"tac",attrs:{span:24}},[r("el-button",{attrs:{size:"small"},on:{click:t.addOptionHandleClick}},[t._v("添加配置项")])],1)],1):t._e(),t.groupId?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-table",{staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{data:t.optionTableData,"default-sort":{prop:"order"}}},[r("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"",width:"80"}}),r("el-table-column",{attrs:{prop:"gid",label:"分组ID",sortable:""}}),r("el-table-column",{attrs:{prop:"option_name",label:"配置项名称",sortable:""}}),r("el-table-column",{attrs:{prop:"option_type",label:"配置项类型",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(t._f("typeFilter")(e.row.option_type)))])]}}],null,!1,3657754979)}),r("el-table-column",{attrs:{prop:"order",label:"排序",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input",{style:{width:"50%"},attrs:{size:"small"},model:{value:e.row.order,callback:function(r){t.$set(e.row,"order",r)},expression:"scope.row.order"}})]}}],null,!1,3229212557)}),r("el-table-column",{attrs:{prop:"hidden",label:"是否隐藏",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.row.hidden,callback:function(r){t.$set(e.row,"hidden",r)},expression:"scope.row.hidden"}})]}}],null,!1,4118246352)}),r("el-table-column",{attrs:{prop:"upgrade",label:"允许升降级",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.row.upgrade,callback:function(r){t.$set(e.row,"upgrade",r)},expression:"scope.row.upgrade"}})]}}],null,!1,1112597802)}),r("el-table-column",{attrs:{prop:"is_discount",label:"是否应用优惠",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:e.row.is_discount,callback:function(r){t.$set(e.row,"is_discount",r)},expression:"scope.row.is_discount"}})]}}],null,!1,549255074)}),r("el-table-column",{attrs:{prop:"title",label:"操作",width:"135",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(r){return t.editOptionHanleClick(e.row.id)}}},[t._v("编辑")]),r("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteOptionHandleClick(e.row.id)}}},[t._v("删除")])]}}],null,!1,1687898948)})],1)],1)],1):t._e(),r("el-row",{staticClass:"mt-10"},[r("el-col",{staticClass:"tac",attrs:{span:24}},[r("el-button",{attrs:{size:"small",type:"primary",loading:t.btnLoading},on:{click:t.saveChangesSubmitForm}},[t._v(" "+t._s(t.groupId?"保存更改":"确认创建")+" ")]),r("el-button",{attrs:{size:"small"},on:{click:t.backtToGroupListHandleClick}},[t._v("返回")]),r("el-button",{attrs:{size:"small"},on:{click:t.resetForm}},[t._v("重置")])],1)],1)],1)},o=[],a=(r("4160"),r("caad"),r("ac1f"),r("2532"),r("5319"),r("159b"),r("96cf"),r("1da1")),u=r("33e2"),i=r("6a8e"),s={inject:["reload"],metaInfo:function(){return{title:this.groupId?"编辑全局配置":"创建全局配置"}},data:function(){return{prePage:this.$route.query.prePage,groupId:this.$route.query.groupId,groupList:[],groupFormData:{name:void 0,description:void 0,p_id:[],global:1},groupRules:{name:[{required:!0,message:"请输入组名",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],p_id:[]},optionTableData:[],preWindow:null,btnLoading:!1}},filters:{typeFilter:function(t){switch(t){case 1:return"下拉";case 2:return"单选";case 3:return"是否";case 4:return"数量";case 5:return"操作系统";case 6:return"cpu核心单选";case 7:return"cpu核心范围";case 8:return"内存单选";case 9:return"内存范围";case 10:return"带宽单选";case 11:return"带宽范围";case 12:return"数据中心";case 13:return"系统盘容量单选";case 14:return"系统盘容量范围"}}},methods:{getProductList:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["e"])();case 2:r=e.sent,n=r.data,200!==n.status?t.$message.error(n.msg):(t.groupList=n.client_groups,t.groupId&&t.getEditGroupsPage());case 5:case"end":return e.stop()}}),e)})))()},getEditGroupsPage:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["l"])(t.groupId,1);case 2:r=e.sent,n=r.data,200===n.status&&(o=[],(t.groupList||[]).forEach((function(t){(t.product||[]).forEach((function(t){o.push(t.id)}))})),t.groupFormData=n.group,t.groupFormData.p_id=[],(n.pid||[]).forEach((function(e){o.includes(e.pid)&&t.groupFormData.p_id.push(e.pid)})),t.optionTableData=n.options);case 5:case"end":return e.stop()}}),e)})))()},saveChangesSubmitForm:function(){var t=this;this.$refs.elForm.validate(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(r){var n,o,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r){e.next=4;break}return e.abrupt("return");case 4:if(t.groupId){e.next=14;break}return t.btnLoading=!0,e.next=8,Object(u["c"])(t.groupFormData);case 8:n=e.sent,o=n.data,200===o.status?(t.$message.success(o.msg),t.groupId=o.groupid,t.$router.replace({path:"/edit-configurable-option-group",query:{groupId:o.groupid,prePage:t.prePage}}),t.getEditGroupsPage()):t.$message.error(o.msg),t.btnLoading=!1,e.next=28;break;case 14:return t.groupFormData.gid=t.groupFormData.id,t.groupFormData.productlinks=t.groupFormData.p_id,t.groupFormData.order=[],t.groupFormData.hidden=[],t.groupFormData.upgrade=[],t.groupFormData.is_discount=[],(t.optionTableData||[]).forEach((function(e){t.groupFormData.order[e.id]=e.order,t.groupFormData.hidden[e.id]=e.hidden,t.groupFormData.upgrade[e.id]=e.upgrade,t.groupFormData.is_discount[e.id]=e.is_discount})),t.btnLoading=!0,e.next=24,Object(u["k"])(t.$qs.stringify(t.groupFormData));case 24:a=e.sent,i=a.data,200===i.status?(t.$message.success(i.msg),t.getEditGroupsPage()):t.$message.error(i.msg),t.btnLoading=!1;case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},backtToGroupListHandleClick:function(){this.$router.push({path:"/configurable-option",query:{type:this.prePage}})},resetForm:function(){this.$refs.elForm.resetFields()},addOptionHandleClick:function(){var t=this,e=this.$baseUrl+"/#/edit-configurable-option1?groupId="+this.groupId;this.preWindow=window.open(e,"newwindow","height=800,width=1800,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");var r=setInterval((function(){t.preWindow.closed&&(clearInterval(r),t.reload())}),500)},editOptionHanleClick:function(t){var e=this,r=this.$baseUrl+"/#/edit-configurable-option1?groupId="+this.groupId+"&optionId="+t;this.preWindow&&this.preWindow.close(),this.preWindow=window.open(r,"newwindow","height=800,width=1800,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");var n=setInterval((function(){e.preWindow.closed&&(clearInterval(n),e.reload())}),500)},deleteOptionHandleClick:function(t){var e=this;this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["e"])(t).then((function(t){200===t.data.status?(e.$message.success(t.data.msg),e.getEditGroupsPage()):e.$message.warning(t.data.msg)}))})).catch((function(){}))}},created:function(){this.getProductList()}},c=s,l=(r("c622"),r("2877")),p=Object(l["a"])(c,n,o,!1,null,"7d160d1d",null);e["default"]=p.exports},c622:function(t,e,r){"use strict";var n=r("d424"),o=r.n(n);o.a},caad:function(t,e,r){"use strict";var n=r("23e7"),o=r("4d64").includes,a=r("44d2"),u=r("ae40"),i=u("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!i},{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},d424:function(t,e,r){}}]);