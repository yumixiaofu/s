(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["FollowStatus~31ecd969"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"398e":function(e,t,a){"use strict";var r=a("9b0f"),s=a.n(r);s.a},"5cdc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("div",{staticClass:"flex-between mb-20"},[a("div",[a("label",{staticClass:"fz-14"},[e._v("时间：")]),a("el-date-picker",{staticClass:"mr-10",attrs:{size:"small",type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.selectTimes,callback:function(t){e.selectTimes=t},expression:"selectTimes"}}),a("el-button",{attrs:{size:"small",type:"primary",loading:e.pageLoading},on:{click:e.searchHandleClick}},[e._v("搜索")])],1),a("div",[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){e.addRecordVis=!0}}},[e._v("添加记录")])],1)]),e.pageData.list.length?a("div",{staticClass:"mb-20 font-bold"},[e._v(e._s(e.pageData.track_status_zh))]):e._e(),a("el-row",{staticClass:"topform_wrap"},[a("el-timeline",e._l(e.pageData.list,(function(t,r){return a("el-timeline-item",{key:r+"record",attrs:{timestamp:e.$moment(1e3*t.create_time).format("YYYY-MM-DD HH:mm"),placement:"top"}},[a("div",{staticStyle:{position:"absolute",top:"-10px",left:"27px"}},[a("span",{staticClass:"fz-12 color-999 mr-10"},[e._v(e._s(e.$moment(1e3*t.create_time).format("YYYY-MM-DD HH:mm")))]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.supplementHandleClick(t)}}},[e._v("补充")])],1),a("el-card",{staticClass:"remark_card",staticStyle:{width:"98%"}},[a("pre",{staticClass:"lh-20"},[e._v(e._s(t.des))]),a("el-timeline",e._l(t.remark,(function(t,r){return a("el-timeline-item",{key:r+"remark",attrs:{timestamp:e.$moment(1e3*t.create_time).format("YYYY-MM-DD HH:mm"),placement:"top"}},[a("div",{staticStyle:{position:"absolute",top:"0",left:"27px"}},[e._v(" 补充： "),a("span",{staticClass:"fz-12 color-999 mr-10"},[e._v(e._s(e.$moment(1e3*t.create_time).format("YYYY-MM-DD HH:mm")))])]),a("pre",{staticClass:"lh-20"},[e._v(e._s(t.remark))])])})),1)],1)],1)})),1)],1),a("div",{staticClass:"bottomOperationAdd"},[a("label",{staticClass:"fz-14"},[e._v("状态：")]),a("el-select",{staticClass:"mr-10",attrs:{size:"small"},model:{value:e.pageData.track_status,callback:function(t){e.$set(e.pageData,"track_status",t)},expression:"pageData.track_status"}},[a("el-option",{attrs:{value:1,label:"待开始"}}),a("el-option",{attrs:{value:2,label:"跟进中"}}),a("el-option",{attrs:{value:3,label:"已完成"}})],1),a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v("保存")])],1),a("el-dialog",{attrs:{title:e.addRemarkForm.id?"补充记录":"添加记录",visible:e.addRecordVis,width:"500px"},on:{"update:visible":function(t){e.addRecordVis=t},open:e.addRecordOpen,close:e.addRecordClose}},[e.addRemarkForm.id?a("el-form",{ref:"addRecordFormRef",attrs:{model:e.addRemarkForm,"label-width":"50px"}},[a("el-form-item",{attrs:{prop:"stime",label:"时间"}},[a("span",[e._v(e._s(e.recordTime))])]),a("el-form-item",{attrs:{prop:"remark",label:"记录",rules:{required:!0,message:"请输入记录",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:5}},model:{value:e.addRemarkForm.remark,callback:function(t){e.$set(e.addRemarkForm,"remark",t)},expression:"addRemarkForm.remark"}})],1)],1):a("el-form",{ref:"addRecordFormRef",attrs:{model:e.addRecordForm,"label-width":"50px"}},[a("el-form-item",{attrs:{prop:"stime",label:"时间"}},[a("span",[e._v(e._s(e.recordTime))])]),a("el-form-item",{attrs:{prop:"record",label:"记录",rules:{required:!0,message:"请输入记录",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:5}},model:{value:e.addRecordForm.record,callback:function(t){e.$set(e.addRecordForm,"record",t)},expression:"addRecordForm.record"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.addRecordSubmit}},[e._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.addRecordVis=!1}}},[e._v("取消")])],1)],1)],1)},s=[],i=(a("ac1f"),a("841c"),a("96cf"),a("1da1")),n=a("a2e7"),o={data:function(){return{selectTimes:[],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},btnLoading:!1,pageLoading:!1,search:{uid:this.$route.query.id,start_time:void 0,end_time:void 0},pageData:{list:[],track_status:1},addRecordVis:!1,recordTime:"",addRecordForm:{stime:"",record:"",uid:this.$route.query.id},addRemarkForm:{remark:""}}},created:function(){this.getData()},mounted:function(){},methods:{getData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.pageLoading=!0,t.next=3,Object(n["f"])(e.search);case 3:a=t.sent,r=a.data,e.pageLoading=!1,200!==r.status?e.$message.error(r.msg):e.pageData=r.data;case 7:case"end":return t.stop()}}),t)})))()},searchHandleClick:function(){this.selectTimes&&2===this.selectTimes.length?(this.search.start_time=new Date(this.selectTimes[0]).getTime()/1e3,this.search.end_time=new Date(this.selectTimes[1]).getTime()/1e3):(this.search.start_time=void 0,this.search.end_time=void 0),this.getData()},submitForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.btnLoading=!0,t.next=3,Object(n["g"])({uid:e.search.uid,track_status:e.pageData.track_status});case 3:a=t.sent,r=a.data,e.btnLoading=!1,200!==r.status?e.$message.error(r.msg):(e.getData(),e.$message.success(r.msg));case 7:case"end":return t.stop()}}),t)})))()},addRecordSubmit:function(){var e=this;this.$refs.addRecordFormRef.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var r,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:if(e.btnLoading=!0,!e.addRemarkForm.id){t.next=12;break}return t.next=6,Object(n["b"])(e.addRemarkForm);case 6:r=t.sent,s=r.data,e.btnLoading=!1,200!==s.status?e.$message.error(s.msg):(e.getData(),e.$message.success(s.msg),e.addRecordVis=!1),t.next=19;break;case 12:return e.addRecordForm.stime=(new Date).getTime()/1e3,t.next=15,Object(n["a"])(e.addRecordForm);case 15:i=t.sent,o=i.data,e.btnLoading=!1,200!==o.status?e.$message.error(o.msg):(e.getData(),e.$message.success(o.msg),e.addRecordVis=!1);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},addRecordOpen:function(){this.addRemarkForm.id?this.recordTime=this.$moment(new Date(1e3*this.addRecordForm.stime).getTime()).format("YYYY-MM-DD HH:mm"):this.recordTime=this.$moment((new Date).getTime()).format("YYYY-MM-DD HH:mm")},addRecordClose:function(){this.addRemarkForm.id=void 0,this.$refs.addRecordFormRef.clearValidate(),this.$refs.addRecordFormRef.resetFields()},supplementHandleClick:function(e){this.addRemarkForm.id=e.id,this.addRecordForm.stime=e.create_time,this.addRecordVis=!0}},computed:{},watch:{}},c=o,d=(a("398e"),a("2877")),m=Object(d["a"])(c,r,s,!1,null,"032d11fa",null);t["default"]=m.exports},"841c":function(e,t,a){"use strict";var r=a("d784"),s=a("825a"),i=a("1d80"),n=a("129f"),o=a("14c3");r("search",1,(function(e,t,a){return[function(t){var a=i(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,a):new RegExp(t)[e](String(a))},function(e){var r=a(t,e,this);if(r.done)return r.value;var i=s(e),c=String(this),d=i.lastIndex;n(d,0)||(i.lastIndex=0);var m=o(i,c);return n(i.lastIndex,d)||(i.lastIndex=d),null===m?-1:m.index}]}))},"9b0f":function(e,t,a){},a2e7:function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c})),a.d(t,"f",(function(){return d})),a.d(t,"g",(function(){return m}));var r=a("a27e");function s(e){return Object(r["a"])({url:"client_list_resource",params:e})}function i(){return Object(r["a"])({url:"common/sale_list"})}function n(e){return Object(r["a"])({url:"bind_sale",method:"post",data:e})}function o(e){return Object(r["a"])({url:"add_record_log",method:"post",data:e})}function c(e){return Object(r["a"])({url:"add_remark_log",method:"post",data:e})}function d(e){return Object(r["a"])({url:"track_record",params:e})}function m(e){return Object(r["a"])({url:"track_status",method:"post",data:e})}}}]);