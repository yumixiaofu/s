(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AdminEdit~31ecd969"],{"169d":function(e,t,a){"use strict";var r=a("31f1"),n=a.n(r);n.a},2532:function(e,t,a){"use strict";var r=a("23e7"),n=a("5a34"),i=a("1d80"),s=a("ab13");r({target:"String",proto:!0,forced:!s("includes")},{includes:function(e){return!!~String(i(this)).indexOf(n(e),arguments.length>1?arguments[1]:void 0)}})},"31f1":function(e,t,a){},"343a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin_edit"},[a("h2",[e._v(e._s(e.$route.query.id?"编辑员工资料":"添加员工"))]),a("el-divider"),a("el-row",[a("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,"label-width":e.labelWidth,inline:"","label-position":"top"}},[a("div",{staticClass:"wrapper__from mb-20",attrs:{"data-title":"基本信息"}},[a("el-row",{staticClass:"max-1200 ml-23"},[a("el-form-item",{attrs:{label:"员工角色",prop:1===e.formData.id?"":"adminName"}},[a("el-select",{style:{width:"200px"},attrs:{size:"small",disabled:1===e.formData.id,placeholder:"请选择下拉选择员工角色",clearable:"",filterable:""},model:{value:e.formData.adminName,callback:function(t){e.$set(e.formData,"adminName",t)},expression:"formData.adminName"}},e._l(e.adminNameOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id,disabled:e.disabled}})})),1)],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入用户名",clearable:""},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1),a("el-form-item",{attrs:{label:"真实姓名",prop:"realName"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入真实姓名",clearable:""},model:{value:e.formData.realName,callback:function(t){e.$set(e.formData,"realName",t)},expression:"formData.realName"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入邮箱",clearable:""},model:{value:e.formData.email,callback:function(t){e.$set(e.formData,"email",t)},expression:"formData.email"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"pwd"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",type:"password",autocomplete:"new-password",placeholder:"请输入密码",clearable:""},model:{value:e.formData.pwd,callback:function(t){e.$set(e.formData,"pwd",t)},expression:"formData.pwd"}})],1),a("el-form-item",{attrs:{label:"确认密码",prop:"confirmPwd","show-message":e.pwdDiff,error:e.pwdDiffMsg}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",type:"password",autocomplete:"new-password",placeholder:"请输入确认密码",clearable:""},on:{input:e.confirmPwdChange},model:{value:e.formData.confirmPwd,callback:function(t){e.$set(e.formData,"confirmPwd",t)},expression:"formData.confirmPwd"}})],1),a("el-form-item",{attrs:{label:"语言",prop:"language"}},[a("el-select",{style:{width:"200px"},attrs:{size:"small",placeholder:"请选择语言",clearable:""},model:{value:e.formData.language,callback:function(t){e.$set(e.formData,"language",t)},expression:"formData.language"}},e._l(e.languageOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t,disabled:e.disabled}})})),1)],1),a("el-form-item",{attrs:{label:" ",prop:"disable"}},[a("el-switch",{attrs:{"active-value":!0,"inactive-value":!1,"inactive-text":"勾选将会停用此账户"},model:{value:e.formData.disable,callback:function(t){e.$set(e.formData,"disable",t)},expression:"formData.disable"}})],1),a("el-form-item",{attrs:{label:" "}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"inactive-text":"是否接收业务类邮件"},model:{value:e.formData.is_receive,callback:function(t){e.$set(e.formData,"is_receive",t)},expression:"formData.is_receive"}})],1)],1)],1),a("div",{staticClass:"wrapper__from",attrs:{"data-title":"工单设定"}},[a("el-row",{staticClass:"max-1200 ml-23"},[a("el-form-item",{attrs:{label:"工单部门",prop:"department"}},[a("el-checkbox-group",{model:{value:e.formData.department,callback:function(t){e.$set(e.formData,"department",t)},expression:"formData.department"}},e._l(e.departmentOptions,(function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.id,disabled:t.disabled}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:"工单签名",prop:"signature"}},[a("el-input",{style:{width:e.textareaWidth},attrs:{size:"small",type:"textarea",placeholder:"请输入工单签名",autosize:{minRows:2,maxRows:4}},model:{value:e.formData.signature,callback:function(t){e.$set(e.formData,"signature",t)},expression:"formData.signature"}})],1)],1)],1)])],1),a("div",{staticClass:"bottomOperationAdd"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v("提交")]),a("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返回")]),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1),a("second",{attrs:{secondVerifyVis:e.secondVerifyVis,secondAction:e.secondAction},on:{secondClose:function(t){e.secondVerifyVis=!1},secondeVerifySuccess:e.secondeVerifySuccess}})],1)},n=[],i=(a("caad"),a("a9e3"),a("2532"),a("96cf"),a("1da1")),s=a("c9da"),o=a("bbcf"),c=a("7ded"),l={metaInfo:{title:"员工编辑"},data:function(){var e=this,t=function(t,a,r){""===e.formData.confirmPwd?r(new Error("请再次确认密码")):e.formData.pwd!==e.formData.confirmPwd?r(new Error("两次输入密码不一致!")):r()};return{labelWidth:window.document.body.clientWidth>768?"140px":null,textareaWidth:window.document.body.clientWidth>768?"640px":"200px",submitFormInfo:{},formData:{is_receive:0,adminName:void 0,userName:void 0,realName:void 0,email:void 0,pwd:void 0,confirmPwd:void 0,department:[],signature:void 0,remarks:void 0,templates:void 0,language:"zh-cn",disable:!1,is_sale:0,sale_is_use:0,only_mine:0},rules:{adminName:[{required:!0,message:"请选择下拉选择员工角色",trigger:"change"}],userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{required:!0,pattern:/^[a-zA-Z][0-9a-zA-Z]{3,14}$/,message:"请输入4-15位,字母或数字, 以字母开头",trigger:"blur"}],realName:[{required:!0,message:"请输入真实姓名",trigger:"blur"},{required:!0,pattern:/^[\u4E00-\u9FA5a-zA-Z0-9]{1,1500}$/,message:"请输入大小写字母或数字或中文,禁止输入特殊符号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{required:!0,pattern:/^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@(([0-9a-zA-Z])+([-\w]*[0-9a-zA-Z])*\.)+[a-zA-Z]{2,9})$/,message:"请输入正确的邮箱",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmPwd:[{required:!0,validator:t,trigger:"blur"}],department:[{required:!1,type:"array",message:"请至少选择一个部门",trigger:"change"}],signature:[{required:!1,message:"请输入工单签名",trigger:"blur"}],remarks:[{required:!1,message:"请输入私密备注",trigger:"blur"}],templates:[{required:!1,message:"请输入模板",trigger:"change"}],language:[{required:!0,message:"请选择语言",trigger:"change"}]},adminNameOptions:[],departmentOptions:[],languageOptions:{},pwdDiff:!1,pwdDiffMsg:"",btnLoading:!1,second_verify_admin:0,second_verify_action_admin:[],secondVerifyVis:!1,secondAction:"create_admin"}},components:{second:o["a"]},methods:{submitForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.confirmPwdChange(),e.$refs.elForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a&&e.formData.pwd===e.formData.confirmPwd){t.next=4;break}return t.abrupt("return",-1);case 4:e.$route.query.id?e.$route.query.id&&(1===e.second_verify_admin&&e.second_verify_action_admin.includes("edit_admin")?(e.secondAction="edit_admin",e.secondVerifyVis=!0):e.editApi()):1===e.second_verify_admin&&e.second_verify_action_admin.includes("create_admin")?(e.secondAction="create_admin",e.secondVerifyVis=!0):e.createApi();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)})))()},createApi:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.assignment(),e.btnLoading=!0,t.next=4,Object(s["b"])(e.submitFormInfo);case 4:a=t.sent,200===a.data.status?(e.$message.success("添加成功"),e.$router.push({name:"adminManagement"})):e.$message.error("".concat(a.data.msg)),e.btnLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},editApi:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.submitFormInfo.id=Number(e.$route.query.id),e.assignment(),e.btnLoading=!0,t.next=5,Object(s["h"])(e.submitFormInfo);case 5:a=t.sent,200===a.data.status?(e.editInit(),e.$message.success("更新数据成功"),e.$router.push({name:"adminManagement"})):e.$message.error("".concat(a.data.msg)),e.btnLoading=!1;case 8:case"end":return t.stop()}}),t)})))()},resetForm:function(){this.$refs.elForm.resetFields()},goBack:function(){this.$router.go(-1)},assignment:function(){this.submitFormInfo.role_id=this.formData.adminName,this.submitFormInfo.user_login=this.formData.userName,this.submitFormInfo.user_nickname=this.formData.realName,this.submitFormInfo.user_email=this.formData.email,this.submitFormInfo.user_pass=this.formData.pwd,this.submitFormInfo.signature=this.formData.signature,this.submitFormInfo.user_status=this.formData.disable?0:1,this.submitFormInfo.language=this.formData.language,this.submitFormInfo.dept_id=this.formData.department,this.submitFormInfo.is_sale=this.formData.is_sale,this.submitFormInfo.sale_is_use=this.formData.sale_is_use,this.submitFormInfo.only_mine=this.formData.only_mine,this.submitFormInfo.is_receive=this.formData.is_receive},editInit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.query.id,t.next=3,Object(s["d"])(a);case 3:if(r=t.sent,n=r.data,i=r.data.user,200===n.status){t.next=9;break}return e.$message.error(n.msg),t.abrupt("return");case 9:e.departmentOptions=n.depts,e.adminNameOptions=n.roles,e.languageOptions=n.lang,e.formData.id=i.id,e.formData.realName=i.user_nickname,e.formData.adminName=i.role_id,e.formData.userName=i.user_login,e.formData.email=i.user_email,e.formData.signature=i.signature,e.formData.language=i.language,e.formData.disable=Boolean(!i.user_status),e.formData.is_sale=i.is_sale,e.formData.sale_is_use=i.sale_is_use,e.formData.only_mine=i.only_mine,e.formData.is_receive=i.is_receive,e.$set(e.formData,"department",n.dept_select),o=localStorage.getItem("userInfo"),"undefined"!==o?JSON.parse(o).id===i.id&&localStorage.setItem("userInfo",JSON.stringify(i)):localStorage.setItem("userInfo",JSON.stringify(i)),e.$store.state.managerInfo,JSON.parse(o).id===i.id&&e.$store.dispatch("addmanagerInfo",i);case 29:case"end":return t.stop()}}),t)})))()},addInit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["a"])();case 2:if(a=t.sent,r=a.data,200===r.status){t.next=7;break}return e.$message.error(r.msg),t.abrupt("return");case 7:e.departmentOptions=r.depts,e.adminNameOptions=r.roles,e.languageOptions=r.lang;case 10:case"end":return t.stop()}}),t)})))()},confirmPwdChange:function(){this.formData.confirmPwd!==this.formData.pwd?(this.pwdDiff=!0,this.pwdDiffMsg="两次密码不一致"):(this.pwdDiff=!1,this.pwdDiffMsg="")},getCommonData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["b"])();case 2:if(a=t.sent,r=a.data,200===r.status){t.next=6;break}return t.abrupt("return",!1);case 6:e.second_verify_admin=parseInt(r.data.second_verify_admin),e.second_verify_action_admin=r.data.second_verify_action_admin;case 8:case"end":return t.stop()}}),t)})))()},secondeVerifySuccess:function(e){this.submitFormInfo.code=e,this.$route.query.id?this.$route.query.id&&this.editApi():this.createApi()}},created:function(){this.getCommonData()},mounted:function(){this.$route.query.id?(this.rules.pwd=[],this.rules.confirmPwd=[],this.editInit()):this.addInit()}},u=l,d=(a("169d"),a("2877")),m=Object(d["a"])(u,r,n,!1,null,"78810fbc",null);t["default"]=m.exports},"44e7":function(e,t,a){var r=a("861d"),n=a("c6b6"),i=a("b622"),s=i("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==n(e))}},"5a34":function(e,t,a){var r=a("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},ab13:function(e,t,a){var r=a("b622"),n=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[n]=!1,"/./"[e](t)}catch(r){}}return!1}},bbcf:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",e._g(e._b({attrs:{visible:e.mySecondVerifyVis,title:"二次验证",width:"500px"},on:{"update:visible":function(t){e.mySecondVerifyVis=t},close:e.secondDialogClose}},"el-dialog",e.$attrs,!1),e.$listeners),[a("el-form",{ref:"secondVerifyForm",attrs:{model:e.secondVerifyFormData,rules:e.secondVerifyRules,size:"medium","label-width":"100px"}},[a("el-form-item",{attrs:{label:"验证码",prop:"code"}},[a("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入验证码",clearable:""},model:{value:e.secondVerifyFormData.code,callback:function(t){e.$set(e.secondVerifyFormData,"code",t)},expression:"secondVerifyFormData.code"}},[a("el-button",{attrs:{slot:"append",disabled:"获取验证码"!==e.changeBtnValue},on:{click:e.sendCode},slot:"append"},[e._v(e._s(e.changeBtnValue))])],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.secondVerifyClose}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:e.secondVerifySubmit}},[e._v("确定")])],1)],1)],1)},n=[],i=(a("96cf"),a("1da1")),s=a("7ded"),o={props:{secondVerifyVis:{type:Boolean,default:!1},secondAction:{type:String,default:""}},data:function(){return{mySecondVerifyVis:!1,changeBtnValue:"获取验证码",secondVerifyFormData:{code:void 0},secondVerifyRules:{code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},btnLoading:!1,selectedTypeAccount:""}},methods:{secondDialogClose:function(){this.$emit("secondClose",!1),this.$refs.secondVerifyForm.clearValidate(),this.$refs.secondVerifyForm.resetFields()},countDown:function(){var e=this,t=60;this.changeBtnValue=t+"s后重试",this.timer=setInterval((function(){0===t?(clearInterval(e.timer),e.codeBtnDisabled=!1,e.changeBtnValue="获取验证码"):(e.codeBtnDisabled=!0,e.changeBtnValue=t+"s后重试",t--)}),1e3)},sendCode:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.countDown(),t.next=3,Object(s["f"])({action:e.secondAction});case 3:a=t.sent,r=a.data,200!==r.status?e.$message.error(r.msg):e.$message.success(r.msg);case 6:case"end":return t.stop()}}),t)})))()},secondVerifyClose:function(){this.$refs.secondVerifyForm.clearValidate(),this.$refs.secondVerifyForm.resetFields(),this.secondVerifyVis=!1},secondVerifySubmit:function(){var e=this;this.$refs.secondVerifyForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:e.$emit("secondeVerifySuccess",e.secondVerifyFormData.code);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},watch:{secondVerifyVis:function(e){this.mySecondVerifyVis=e}},mounted:function(){this.mySecondVerifyVis=this.secondVerifyVis}},c=o,l=a("2877"),u=Object(l["a"])(c,r,n,!1,null,"c3111f1c",null);t["a"]=u.exports},c9da:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"h",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d}));var r=a("a27e");function n(e,t){return Object(r["a"])({url:"adminuser",params:{page:t,limit:e}})}function i(e){return Object(r["a"])({url:"adminuser/".concat(e,"/"),method:"delete"})}function s(e){return Object(r["a"])({url:"adminuser/update",method:"post",data:e})}function o(){return Object(r["a"])({url:"create_page"})}function c(e){return Object(r["a"])({url:"adminuser/".concat(e),method:"get"})}function l(e){return Object(r["a"])({url:"adminuser",method:"post",data:e})}function u(){return Object(r["a"])({url:"user/get_black_list"})}function d(e){return Object(r["a"])({url:"user/remove_black_list",method:"post",data:e})}},caad:function(e,t,a){"use strict";var r=a("23e7"),n=a("4d64").includes,i=a("44d2"),s=a("ae40"),o=s("indexOf",{ACCESSORS:!0,1:0});r({target:"Array",proto:!0,forced:!o},{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i("includes")}}]);