(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["InvoiceAudit~31ecd969"],{"06c7":function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return r})),a.d(e,"d",(function(){return c})),a.d(e,"a",(function(){return o})),a.d(e,"h",(function(){return u})),a.d(e,"g",(function(){return d})),a.d(e,"i",(function(){return v}));var i=a("a27e");function s(){return Object(i["a"])({url:"voucher/rate"})}function l(t){return Object(i["a"])({url:"voucher/rate",method:"post",data:t})}function n(t){return Object(i["a"])({url:"voucher/expresslist",params:t})}function r(t){return Object(i["a"])({url:"voucher/express",params:t})}function c(t){return Object(i["a"])({url:"voucher/express",method:"post",data:t})}function o(t){return Object(i["a"])({url:"voucher/express",method:"delete",params:t})}function u(t){return Object(i["a"])({url:"voucher/voucherlist",params:t})}function d(t){return Object(i["a"])({url:"voucher/voucherdetail",params:t})}function v(t){return Object(i["a"])({url:"voucher/voucherstatus",method:"post",data:t})}},a756:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},c22d:function(t,e,a){"use strict";var i=a("9194"),s=a("baa9"),l=a("4023"),n=a("a756"),r=a("1a58");i("search",1,(function(t,e,a){return[function(e){var a=l(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a):new RegExp(e)[t](String(a))},function(t){var i=a(e,t,this);if(i.done)return i.value;var l=s(t),c=String(this),o=l.lastIndex;n(o,0)||(l.lastIndex=0);var u=r(l,c);return n(l.lastIndex,o)||(l.lastIndex=o),null===u?-1:u.index}]}))},dde9:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box custom-tabs p-20"},[a("el-tabs",{model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},[a("el-tab-pane",{attrs:{label:"全部",name:""}}),a("el-tab-pane",{attrs:{label:"待审核",name:"Pending"}}),a("el-tab-pane",{attrs:{label:"已驳回",name:"Reject"}}),a("el-tab-pane",{attrs:{label:"已发出",name:"Send"}}),a("el-tab-pane",{attrs:{label:"待支付",name:"Unpaid"}})],1),a("el-table",{staticClass:"mt-10",attrs:{data:t.tableData,border:"",stripe:""},on:{"sort-change":t.sortChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!t.tableData.length&&t.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),t._v(" 正在加载 ... ")]):t._e(),t.tableData.length||t.tableLoading?t._e():a("span",[t._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"id",label:"发票ID",sortable:"",align:"center",width:"90"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",sortable:"",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"title",label:"发票抬头",sortable:"",align:"center"}}),a("el-table-column",{attrs:{prop:"issue_type_zh",label:"开具类型",sortable:"",align:"center",width:"110"}}),a("el-table-column",{attrs:{prop:"amount",label:"发票金额",sortable:"",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"邮寄地址",sortable:"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.province+a.city+a.region+a.detail))]}}])}),a("el-table-column",{attrs:{prop:"create_time",label:"申请时间",sortable:"",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(t.$moment(1e3*a.create_time).format("YYYY-MM-DD HH:mm")))]}}])}),a("el-table-column",{attrs:{prop:"check_time",label:"审核时间",sortable:"",align:"center",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(t._s(a.check_time?t.$moment(1e3*a.check_time).format("YYYY-MM-DD HH:mm"):"-"))]}}])}),a("el-table-column",{attrs:{prop:"status_zh",label:"状态",sortable:"",align:"center",width:"90"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text"},on:{click:function(e){return t.getInvoiceDetail(i.id)}}},[t._v("查看")]),"Pending"===i.status?a("el-button",{staticClass:"span-success",attrs:{size:"small",type:"text"},on:{click:function(e){return t.optHandleClick(i)}}},[t._v("操作")]):t._e()]}}])})],1),a("el-pagination",{staticClass:"mt-10",attrs:{"current-page":t.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":t.search.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.getData,"update:currentPage":function(e){return t.$set(t.search,"page",e)},"update:current-page":function(e){return t.$set(t.search,"page",e)},"update:pageSize":function(e){return t.$set(t.search,"limit",e)},"update:page-size":function(e){return t.$set(t.search,"limit",e)}}}),a("el-dialog",{attrs:{title:"发票审核",visible:t.checkDialogVis,width:"500px"},on:{"update:visible":function(e){t.checkDialogVis=e},close:t.checkDialogClose}},[a("el-form",{ref:"elForm",attrs:{model:t.formData,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-select",{style:{width:"100%"},attrs:{size:"small"},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[a("el-option",{attrs:{label:"驳回",value:"Reject"}}),a("el-option",{attrs:{label:"通过",value:"Send"}})],1)],1),a("el-form-item",{attrs:{label:"备注留言",prop:"notes"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",type:"textarea",placeholder:"请输入备注留言",clearable:""},model:{value:t.formData.notes,callback:function(e){t.$set(t.formData,"notes",e)},expression:"formData.notes"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.checkDialogVis=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:t.btnLoading},on:{click:t.submitForm}},[t._v("确定")])],1)],1),a("el-dialog",{attrs:{visible:t.invoiceDetailDialog,title:"发票详情",width:"700px"},on:{"update:visible":function(e){t.invoiceDetailDialog=e}}},[a("div",{staticClass:"custom_body"},[a("div",{staticClass:"mb-10"},[a("label",{staticClass:"color-999"},[t._v("开具类型：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.issue_type_zh))])]),"company"==t.invoiceDetail.voucher.issue_type?a("div",{staticClass:"mb-10 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("发票类型：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.voucher_type_zh))])])]):t._e(),a("div",{staticClass:"mb-10 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("抬头信息：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.title))])]),"company"==t.invoiceDetail.voucher.issue_type?a("div",{staticClass:"fl ml-20",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("税务登记号：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.tax_id))])]):t._e()]),"company"==t.invoiceDetail.voucher.issue_type?a("div",{staticClass:"mb-10 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("开户银行名称：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.bank))])]),a("div",{staticClass:"fl ml-20",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("开户银行账号：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.account))])])]):t._e(),"company"==t.invoiceDetail.voucher.issue_type?a("div",{staticClass:"mb-10 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("公司地址：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.address))])]),a("div",{staticClass:"fl ml-20",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("联系电话：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.phone))])])]):t._e(),a("div",{staticClass:"mb-10 mt-20 clearfix"},[a("div",{staticClass:"fl",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("快递信息：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.name))])]),a("div",{staticClass:"fl ml-20",staticStyle:{width:"calc(50% - 20px)"}},[a("label",{staticClass:"color-999"},[t._v("邮寄地址：")]),a("span",{staticClass:"ml-10"},[t._v(t._s(t.invoiceDetail.voucher.province)+t._s(t.invoiceDetail.voucher.city)+t._s(t.invoiceDetail.voucher.region)+t._s(t.invoiceDetail.voucher.detail))])])]),a("div",{staticClass:"mb-20"},[a("label",{staticClass:"color-999"},[t._v("账单号：")]),a("router-link",{staticClass:"ml-10",attrs:{to:{path:"/bill-detail",query:{id:t.invoiceDetail.invoice_id,uid:t.invoiceDetail.uid}},target:"_blank"}},[a("el-link",[t._v(t._s(t.invoiceDetail.invoice_id?"#"+t.invoiceDetail.invoice_id:""))])],1)],1),a("el-table",{attrs:{data:t.invoiceDetail.invoices,height:"300",border:"","header-row-class-name":"innerTableHeader","row-class-name":"innerTableRowClass","cell-class-name":"innerTableCellClass"},on:{"sort-change":t.sortChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!t.invoiceDetail.invoices.length&&t.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),t._v(" 正在加载 ... ")]):t._e(),t.invoiceDetail.invoices.length||t.tableLoading?t._e():a("span",[t._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"description",label:"产品名称"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return t._l(i.items,(function(e,i){return a("pre",{key:i+"subitem",staticClass:"color-999"},[t._v(t._s(e.description))])}))}}])}),a("el-table-column",{attrs:{prop:"subtotal",label:"金额",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("¥"+t._s(parseFloat(a.subtotal).toFixed(2)))]}}])}),a("el-table-column",{attrs:{prop:"taxed",label:"税率",align:"center",width:"80"}}),a("el-table-column",{attrs:{prop:"taxed_amount",label:"税额",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("¥"+t._s(parseFloat(a.taxed_amount).toFixed(2)))]}}])})],1),a("div",{staticClass:"flex-between mt-20"},[a("div",[t._v("开发票扣税：¥"+t._s(parseFloat(t.invoiceDetail.voucher_amount).toFixed(2))+" + 发票邮寄快递费用¥"+t._s(t.invoiceDetail.voucher.price))]),a("div",[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.invoiceDetailDialog=!1}}},[t._v("关闭")]),"Pending"===t.invoiceDetail.voucher.status?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.checkHandleClick}},[t._v("审核")]):t._e()],1)])],1)])],1)},s=[],l=a("60b5"),n=(a("6a61"),a("24a8"),a("c22d"),a("9b5f"),a("06c7")),r={metaInfo:function(){return{title:"发票审核"}},data:function(){return{tableLoading:!1,search:{page:1,limit:Number(localStorage.getItem("limit"))||50,order:"id",sort:"desc",status:""},tableData:[],total:0,btnLoading:!1,checkDialogVis:!1,formData:{id:void 0,status:void 0,notes:""},rules:{status:[{required:!0,message:"请选择状态",trigger:"change"}],notes:[{required:!1,message:"请输入备注",trigger:"blur"}]},invoiceDetailDialog:!1,invoiceDetail:{voucher:{},invoices:[]}}},created:function(){this.getData()},mounted:function(){},methods:{getData:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableData=[],t.tableLoading=!0,e.next=4,Object(n["h"])(t.search);case 4:a=e.sent,i=a.data,200!==i.status?t.$message.error(i.msg):(t.tableData=i.data.voucher,t.total=i.data.total),t.tableLoading=!1;case 8:case"end":return e.stop()}}),e)})))()},handleSizeChange:function(t){this.search.page=1,this.getData()},sortChange:function(t,e,a){this.search.order=t.prop,"ascending"===t.order?this.search.sort="asc":this.search.sort="desc",this.getData()},optHandleClick:function(t){this.checkDialogVis=!0,this.formData.id=t.id},submitForm:function(){var t=this;this.$refs.elForm.validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",!1);case 2:return t.btnLoading=!0,e.next=5,Object(n["i"])(t.formData);case 5:i=e.sent,s=i.data,t.btnLoading=!1,200!==s.status?t.$message.error(s.msg):(t.$message.success(s.msg),t.getData(),t.checkDialogVis=!1);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},checkDialogClose:function(){this.$refs.elForm.resetFields()},getInvoiceDetail:function(t){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.formData.id=t,e.invoiceDetailDialog=!0,e.tableLoading=!0,a.next=5,Object(n["g"])({id:t});case 5:i=a.sent,s=i.data,e.tableLoading=!1,200!==s.status?e.$message.error(s.msg):e.invoiceDetail=s.data;case 9:case"end":return a.stop()}}),a)})))()},checkHandleClick:function(){this.invoiceDetailDialog=!1,this.checkDialogVis=!0}},computed:{},watch:{"search.status":{handler:function(t){this.getData()},deep:!0}}},c=r,o=a("5d22"),u=Object(o["a"])(c,i,s,!1,null,"2ba05ac6",null);e["default"]=u.exports}}]);