(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CurrencySettings~f71cff67"],{faa5:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"currency"},[a("h5",{staticClass:"mt-0"},[e._v("您可以通过不同的货币销售您的产品。客户可以在网站上选择他们合适的货币进行支付购买。")]),a("el-button",{attrs:{size:"small",icon:"el-icon-bottom",type:"primary",plain:"",loading:e.rateLoading},on:{click:e.updateRate}},[e._v("汇率更新 ")]),a("el-button",{attrs:{size:"small",icon:"el-icon-bottom",type:"success",plain:"",loading:e.priceLoading},on:{click:e.updataPrice}},[e._v("价格更新 ")]),a("el-table",{staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{data:e.tableData.filter((function(t){return!e.search||t.name.toLowerCase().includes(e.search.toLowerCase())})),border:""}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.tableData.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),e.tableData.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{label:"ID",prop:"id",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"货币代码",prop:"code",width:"120",align:"center"}}),a("el-table-column",{attrs:{label:"前缀（例如：￥）",prop:"prefix",width:"150",align:"center"}}),a("el-table-column",{attrs:{label:"后缀",prop:"suffix",width:"80",align:"center"}}),a("el-table-column",{attrs:{label:"格式",prop:"format"}}),a("el-table-column",{attrs:{label:"汇率",prop:"rate"}}),a("el-table-column",{attrs:{label:"操作",width:"325"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"span-success",attrs:{size:"small",type:"text",icon:"el-icon-edit",disabled:1===t.row.default},on:{click:function(a){return e.setDefault(t.row)}}},[e._v("设为默认货币")]),a("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.editCurrency(t.row)}}},[e._v(" 编辑 ")]),a("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete",disabled:1===t.row.default},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("el-dialog",e._g(e._b({attrs:{title:e.editFlag?"编辑货币":"添加货币",visible:e.dialogVisible},on:{open:e.onOpen,close:e.onClose,"update:visible":function(t){e.dialogVisible=t}}},"el-dialog",e.$attrs,!1),e.$listeners),[a("el-row",[a("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,"label-width":"80px"}},[a("el-col",{attrs:{span:22}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"货币代码",prop:"code"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"例如：USD、GBP、RMB 等等…",clearable:""},model:{value:e.formData.code,callback:function(t){e.$set(e.formData,"code",t)},expression:"formData.code"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"前缀",prop:"prefix"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"例如￥",clearable:""},model:{value:e.formData.prefix,callback:function(t){e.$set(e.formData,"prefix",t)},expression:"formData.prefix"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"后缀",prop:"suffix"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"例如 元",clearable:""},model:{value:e.formData.suffix,callback:function(t){e.$set(e.formData,"suffix",t)},expression:"formData.suffix"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"格式",prop:"format"}},[a("el-select",{style:{width:"100%"},attrs:{size:"small",placeholder:"请选择格式",clearable:""},model:{value:e.formData.format,callback:function(t){e.$set(e.formData,"format",t)},expression:"formData.format"}},e._l(e.formatOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"汇率",prop:"rate"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:"相对于第一个货币的汇率",clearable:""},model:{value:e.formData.rate,callback:function(t){e.$set(e.formData,"rate",t)},expression:"formData.rate"}})],1)],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitDialog}},[e._v("确定")])],1)],1)],1)},n=[],s=(a("a9e3"),a("96cf"),a("1da1")),o=a("a27e");function i(e,t){return Object(o["a"])({url:"currency/currency_list",params:{limit:e,page:t}})}function l(e){return Object(o["a"])({url:"currency/add_currency",method:"post",data:e})}function c(e){return Object(o["a"])({url:"currency/delete_currency/".concat(e),method:"get"})}function u(e){return Object(o["a"])({url:"currency/edit_currency/".concat(e)})}function d(e){return Object(o["a"])({url:"currency/edit_currency_post",method:"post",data:e})}function f(){return Object(o["a"])({url:"currency/update_rate"})}function m(){return Object(o["a"])({url:"currency/update_price"})}function p(e){return Object(o["a"])({url:"currency/default_currency/".concat(e)})}var b={inject:["reload"],metaInfo:{title:"货币配置"},data:function(){return{tableLoading:!1,rateLoading:!1,priceLoading:!1,tableData:[],search:"",dialogVisible:!1,addData:{},editFlag:!1,formData:{code:void 0,prefix:void 0,suffix:void 0,format:void 0,rate:void 0,editRow:void 0},rules:{code:[{required:!0,message:"例如：USD、GBP、RMB 等等…",trigger:"blur"}],prefix:[],suffix:[],format:[],rate:[]},formatOptions:[{label:"1234.56",value:"1234.56"},{label:"1,234.56",value:"1,234.56"},{label:"1.234,56",value:"1.234,56"},{label:"1,234",value:"1,234"}],btnLoading:!1}},methods:{editCurrency:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.editFlag=!0,a.next=3,u(e.id);case 3:if(r=a.sent,n=r.data.currency,n){a.next=8;break}return t.$message.error("出现了错误"),a.abrupt("return");case 8:t.formData=n,t.dialogVisible=!0;case 10:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("将删除此货币, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){c(e.id).then((function(e){200!==e.data.status?t.$message.error(e.data.msg):(t.$message.success("该流水已删除"),t.reload())}))})).catch((function(){t.reload()}));case 1:case"end":return a.stop()}}),a)})))()},getCurrencyList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,i();case 3:a=t.sent,r=a.data,200!==r.status?e.$message.error("请求失败"):e.tableData=r.currencies,e.tableLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},setDefault:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm("要把".concat(e.code,"设置为默认货币吗,汇率将以默认货币为基准"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p(e.id).then((function(e){200!==e.data.status?t.$message.error(e.data.msg):(t.$message.success(e.data.msg),t.reload())}))})).catch((function(){}));case 1:case"end":return a.stop()}}),a)})))()},onOpen:function(){},onClose:function(){this.$refs.elForm.resetFields(),this.editFlag=!1,this.formData={}},close:function(){this.dialogVisible=!1,this.editFlag=!1,this.formData={}},submitDialog:function(){var e=this;this.editFlag?this.$refs.elForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=4;break}e.$message.error("请正确填写内容"),t.next=8;break;case 4:return t.next=6,d(e.formData);case 6:r=t.sent,200===r.status?(e.$message.success("更新成功"),e.getCurrencyList(),setTimeout((function(){e.close()}),500)):e.$message.error(r.msg);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$refs.elForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=5;break}return e.$message.error("请正确填写内容"),t.abrupt("return");case 5:return e.addData.code=e.formData.code,e.addData.prefix=e.formData.prefix,e.addData.suffix=e.formData.suffix,e.addData.format=e.formData.format,e.addData.rate=Number(e.formData.rate),e.btnLoading=!0,t.next=13,l(e.formData);case 13:r=t.sent,200!==r.data.status?e.$message.error(r.data.msg):(e.$message.success("添加成功"),setTimeout((function(){e.getCurrencyList()}),800)),e.btnLoading=!1;case 16:e.close();case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},updateRate:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.rateLoading=!0,t.next=3,f();case 3:if(a=t.sent,200!==a.data.status)e.$message.error(a.data.msg);else{for(r=function(t){var r=a.data.data[t];setTimeout((function(){e.$message.success(r.msg)}),800)},n=0;n<a.data.data.length;n++)r(n);e.reload()}e.rateLoading=!1;case 6:case"end":return t.stop()}}),t)})))()},updataPrice:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.priceLoading=!0,t.next=3,m();case 3:a=t.sent,200!==a.data.status?e.$message.error(a.data.msg):(e.$message.success(a.data.msg),e.reload()),e.priceLoading=!1;case 6:case"end":return t.stop()}}),t)})))()}},created:function(){this.getCurrencyList()}},g=b,h=a("2877"),v=Object(h["a"])(g,r,n,!1,null,null,null);t["default"]=v.exports}}]);