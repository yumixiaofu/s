(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AddOrEditResource~31ecd969"],{1276:function(e,t,r){"use strict";var a=r("d784"),i=r("44e7"),n=r("825a"),o=r("1d80"),s=r("4840"),l=r("8aa5"),u=r("50c4"),c=r("14c3"),d=r("9263"),p=r("d039"),m=[].push,f=Math.min,b=4294967295,h=!p((function(){return!RegExp(b,"y")}));a("split",2,(function(e,t,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var a=String(o(this)),n=void 0===r?b:r>>>0;if(0===n)return[];if(void 0===e)return[a];if(!i(e))return t.call(a,e,n);var s,l,u,c=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,h=new RegExp(e.source,p+"g");while(s=d.call(h,a)){if(l=h.lastIndex,l>f&&(c.push(a.slice(f,s.index)),s.length>1&&s.index<a.length&&m.apply(c,s.slice(1)),u=s[0].length,f=l,c.length>=n))break;h.lastIndex===s.index&&h.lastIndex++}return f===a.length?!u&&h.test("")||c.push(""):c.push(a.slice(f)),c.length>n?c.slice(0,n):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var i=o(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,i,r):a.call(String(i),t,r)},function(e,i){var o=r(a,e,this,i,a!==t);if(o.done)return o.value;var d=n(e),p=String(this),m=s(d,RegExp),g=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(h?"y":"g"),_=new m(h?d:"^(?:"+d.source+")",v),w=void 0===i?b:i>>>0;if(0===w)return[];if(0===p.length)return null===c(_,p)?[p]:[];var D=0,x=0,O=[];while(x<p.length){_.lastIndex=h?x:0;var j,k=c(_,h?p:p.slice(x));if(null===k||(j=f(u(_.lastIndex+(h?0:x)),p.length))===D)x=l(p,x,g);else{if(O.push(p.slice(D,x)),O.length===w)return O;for(var y=1;y<=k.length-1;y++)if(O.push(k[y]),O.length===w)return O;x=D=j}}return O.push(p.slice(D)),O}]}),!h)},"44e7":function(e,t,r){var a=r("861d"),i=r("c6b6"),n=r("b622"),o=n("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},"4e25":function(e,t,r){"use strict";r.d(t,"s",(function(){return i})),r.d(t,"l",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"o",(function(){return s})),r.d(t,"r",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"k",(function(){return c})),r.d(t,"n",(function(){return d})),r.d(t,"c",(function(){return p})),r.d(t,"y",(function(){return m})),r.d(t,"u",(function(){return f})),r.d(t,"t",(function(){return b})),r.d(t,"v",(function(){return h})),r.d(t,"w",(function(){return g})),r.d(t,"m",(function(){return v})),r.d(t,"g",(function(){return _})),r.d(t,"f",(function(){return w})),r.d(t,"h",(function(){return D})),r.d(t,"j",(function(){return x})),r.d(t,"i",(function(){return O})),r.d(t,"z",(function(){return j})),r.d(t,"p",(function(){return k})),r.d(t,"e",(function(){return y})),r.d(t,"q",(function(){return I})),r.d(t,"d",(function(){return $})),r.d(t,"x",(function(){return q}));var a=r("a27e");function i(e){return Object(a["a"])({url:"upper/index",params:e})}function n(e){return Object(a["a"])({url:"upper/del",method:"post",data:e})}function o(e){return Object(a["a"])({url:"upper/addpost",method:"post",data:e})}function s(e){return Object(a["a"])({url:"upper/edituppost",method:"post",data:e})}function l(e){return Object(a["a"])({url:"upper/upperindex",method:"get",params:e})}function u(e){return Object(a["a"])({url:"upper/addupperpost",method:"post",data:e})}function c(e){return Object(a["a"])({url:"upper/delupper",method:"post",data:e})}function d(e){return Object(a["a"])({url:"upper/editupperpost",method:"post",data:e})}function p(){return Object(a["a"])({url:"upper/addupperpage"})}function m(e){return Object(a["a"])({url:"upper/ipmi/status",params:{id:e}})}function f(e){return Object(a["a"])({url:"upper/ipmi/on",method:"post",data:{id:e}})}function b(e){return Object(a["a"])({url:"upper/ipmi/off",method:"post",data:{id:e}})}function h(e){return Object(a["a"])({url:"upper/ipmi/reboot",method:"post",data:{id:e}})}function g(e){return Object(a["a"])({url:"upper/ipmi/vnc",method:"post",data:{id:e}})}function v(e){return Object(a["a"])({url:"upper/editupperpage",params:{id:e}})}function _(e){return Object(a["a"])({url:"upper/dcim_client/on",method:"post",data:{id:e}})}function w(e){return Object(a["a"])({url:"upper/dcim_client/off",method:"post",data:{id:e}})}function D(e){return Object(a["a"])({url:"upper/dcim_client/reboot",method:"post",data:{id:e}})}function x(e){return Object(a["a"])({url:"upper/dcim_client/vnc",method:"post",data:{id:e}})}function O(e){return Object(a["a"])({url:"upper/dcim_client/status",params:{id:e}})}function j(e){return Object(a["a"])({url:"upper/dcim_client/reinstall",method:"post",data:e})}function k(e){return Object(a["a"])({url:"upper/dcim_client/get_os",method:"post",data:e})}function y(e){return Object(a["a"])({url:"upper/dcim_client/crack_pass",method:"post",data:e})}function I(e){return Object(a["a"])({url:"upper/dcim_client/resintall_status",method:"post",data:e})}function $(e){return Object(a["a"])({url:"upper/dcim_client/cancel_task",method:"post",data:e})}function q(e){return Object(a["a"])({url:"upper/dcim_client/cancel_task",method:"post",data:e})}},"6cfe":function(e,t,r){},a15b:function(e,t,r){"use strict";var a=r("23e7"),i=r("44ad"),n=r("fc6a"),o=r("a640"),s=[].join,l=i!=Object,u=o("join",",");a({target:"Array",proto:!0,forced:l||!u},{join:function(e){return s.call(n(this),void 0===e?",":e)}})},a5b4:function(e,t,r){"use strict";var a=r("6cfe"),i=r.n(a);i.a},b002:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"admin_edit"},[r("h2",[e._v(e._s(e.$route.query.id?"编辑资源管理":"添加资源管理"))]),r("el-divider"),r("el-row",{staticClass:"topform_wrap"},[r("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,"label-width":e.labelWidth,"label-position":"top"}},[r("el-form-item",{attrs:{label:"主IP",prop:"in_ip"}},[r("el-input",{style:{width:"260px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入IP",clearable:""},model:{value:e.formData.in_ip,callback:function(t){e.$set(e.formData,"in_ip",t)},expression:"formData.in_ip"}})],1),r("el-form-item",{attrs:{label:"附加IP",prop:"ip"}},[r("el-input",{style:{width:"260px"},attrs:{type:"textarea",autosize:{minRows:5,maxRows:5},placeholder:"请使用英文半角,分隔ip"},model:{value:e.ipListString,callback:function(t){e.ipListString=t},expression:"ipListString"}})],1),r("el-form-item",{attrs:{label:"上游",prop:"pid"}},[r("el-select",{style:{width:"260px"},attrs:{size:"small",placeholder:"请选择上游"},model:{value:e.formData.pid,callback:function(t){e.$set(e.formData,"pid",t)},expression:"formData.pid"}},e._l(e.UpStreamNameList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-form-item",{attrs:{label:"配置",prop:"pz"}},[r("el-input",{style:{width:"260px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入配置",clearable:""},model:{value:e.formData.pz,callback:function(t){e.$set(e.formData,"pz",t)},expression:"formData.pz"}})],1),r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{style:{width:"260px"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入用户名",clearable:""},model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{style:{width:"260px"},attrs:{size:"small","auto-complete":"new-password","show-password":"",placeholder:"请输入密码",clearable:""},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1),r("el-form-item",{attrs:{label:"成本",prop:"total"}},[r("el-input-number",{style:{width:"260px"},attrs:{controls:!1,min:0,precision:2,size:"small",autocomplete:"off",placeholder:"请输入成本",clearable:""},model:{value:e.formData.total,callback:function(t){e.$set(e.formData,"total",t)},expression:"formData.total"}})],1),r("el-form-item",{attrs:{label:"到期时间",prop:"paid_time"}},[r("el-date-picker",{style:{width:"260px"},attrs:{size:"small","value-format":"timestamp",type:"datetime",placeholder:"选择日期时间"},model:{value:e.paid_time,callback:function(t){e.paid_time=t},expression:"paid_time"}})],1),r("el-form-item",{attrs:{label:"控制方式",prop:"control_mode"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 控制方式 "),r("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[r("el-row",[r("el-col",{attrs:{span:24}},[e._v("支持多种控制方式，如有其他上游需要支持，请提交至论坛，我们将尽快支持")])],1),r("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),r("el-select",{style:{width:"260px"},attrs:{size:"small",placeholder:"请选择控制方式"},model:{value:e.formData.control_mode,callback:function(t){e.$set(e.formData,"control_mode",t)},expression:"formData.control_mode"}},e._l(e.control_modeOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,disabled:e.disabled,value:e.value}})})),1)],1),"ipmi"===e.formData.control_mode||"dcim_client"===e.formData.control_mode?["ipmi"===e.formData.control_mode?[r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:"IPMI IP",prop:"ipmi"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入IPMI IP",clearable:""},model:{value:e.formData.ipmi,callback:function(t){e.$set(e.formData,"ipmi",t)},expression:"formData.ipmi"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:"版本",prop:"ipmi_version"}},[r("el-select",{style:{width:"100%"},attrs:{size:"small",placeholder:"请选择版本"},model:{value:e.formData.ipmi_version,callback:function(t){e.$set(e.formData,"ipmi_version",t)},expression:"formData.ipmi_version"}},e._l(e.ipmi_versionOptions,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1)],1)],1)],1)]:e._e(),"dcim_client"===e.formData.control_mode?[r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:"魔方DCIM客户端地址",prop:"dcim_client_url"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",autocomplete:"off",placeholder:"http头加域名",clearable:""},model:{value:e.formData.dcim_client_url,callback:function(t){e.$set(e.formData,"dcim_client_url",t)},expression:"formData.dcim_client_url"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:"服务器ID",prop:"dcim_client_id"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入服务器ID",clearable:""},model:{value:e.formData.dcim_client_id,callback:function(t){e.$set(e.formData,"dcim_client_id",t)},expression:"formData.dcim_client_id"}})],1)],1)],1)]:e._e(),r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:e.variableUserName+"用户名",prop:"root"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",autocomplete:"off",placeholder:"请输入"+e.variableUserName+"用户名",clearable:""},model:{value:e.formData.root,callback:function(t){e.$set(e.formData,"root",t)},expression:"formData.root"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{xs:24,sm:12}},[r("el-form-item",{attrs:{label:e.variablePassWord+"密码",prop:"pwd"}},[r("el-input",{style:{width:"100%"},attrs:{size:"small",autocomplete:"off","show-password":"",placeholder:"请输入"+e.variablePassWord+"用户名","auto-complete":"new-password",clearable:""},model:{value:e.formData.pwd,callback:function(t){e.$set(e.formData,"pwd",t)},expression:"formData.pwd"}})],1)],1)],1)]:e._e()],2)],1),r("div",{staticClass:"bottomOperationAdd"},[r("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v("提交")]),r("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返回")]),r("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1)},i=[],n=(r("4160"),r("a15b"),r("a9e3"),r("ac1f"),r("1276"),r("159b"),r("96cf"),r("1da1")),o=r("4e25"),s={metaInfo:{title:"资源管理"},data:function(){return{variableUserName:"",variablePassWord:"",labelWidth:window.document.body.clientWidth>768?"120px":null,UpStreamNameList:[],submitFormInfo:{},paid_time:void 0,formData:{username:"",password:"",dcim_client_id:void 0,dcim_client_url:void 0,in_ip:void 0,ip:void 0,ipmi:void 0,pz:void 0,pid:void 0,root:void 0,pwd:void 0,total:void 0,control_mode:void 0,paid_time:void 0},ipListString:void 0,control_modeOptions:[],ipmi_versionOptions:[{name:"v1.5",value:"1.5"},{name:"v2.0",value:"2.0"}],rules:{ipmi:[{required:!0,message:"请输入IPMI IP",trigger:"blur"},{required:!0,pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,message:"不符合格式要求,请输入例如192.168.1.1",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],root:[{required:!0,message:"请输入用户名",trigger:"blur"}],ipmi_version:[{required:!0,message:"请选择版本",trigger:"blur"}],pz:[{required:!1,message:"请输入配置",trigger:"blur"}],pid:[{required:!0,message:"请选择上游",trigger:"blur"}],pwd:[{required:!0,message:"请输入密码",trigger:"blur"}],total:[{required:!1,message:"请输入成本",trigger:"blur"}],paid_time:[{required:!1,message:"请输入到期时间",trigger:"blur"}],control_mode:[{required:!0,message:"请选择控制方式",trigger:"blur"}],ip:[{required:!1,message:"请输入附加IP",trigger:"blur"}],dcim_client_id:[{required:!0,message:"请输入服务器ID",trigger:"blur"}],dcim_client_url:[{required:!0,message:"请输入魔方DCIM客户端地址",trigger:"blur"}],in_ip:[{required:!0,message:"请输入IP",trigger:"blur"},{required:!0,pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,message:"不符合格式要求,请输入例如192.168.1.1",trigger:"blur"}]},btnLoading:!1}},methods:{submitForm:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.elForm.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=4;break}return t.abrupt("return",-1);case 4:if(e.$route.query.id){t.next=15;break}return e.btnLoading=!0,void 0!==e.ipListString&&""!==e.ipListString&&(e.formData.ip=e.ipListString.split(",")),e.formData.paid_time=e.paid_time/1e3,t.next=10,Object(o["a"])(e.formData);case 10:a=t.sent,200===a.data.status?(e.$message.success("添加成功"),e.$router.push({name:"munualResource",params:{id:a.data.id,type:e.formData.control_mode}})):e.$message.error("".concat(a.data.msg)),e.btnLoading=!1,t.next=26;break;case 15:if(!e.$route.query.id){t.next=26;break}return e.formData.paid_time=e.paid_time/1e3,Object.assign(e.submitFormInfo,e.formData),e.submitFormInfo.id=Number(e.$route.query.id),void 0!==e.ipListString&&""!==e.ipListString&&(e.submitFormInfo.ip=e.ipListString.split(",")),e.btnLoading=!0,t.next=23,Object(o["n"])(e.submitFormInfo);case 23:i=t.sent,200===i.data.status?(e.$message.success("更新数据成功"),e.$router.push({name:"munualResource",params:{id:e.formData.id,type:e.formData.control_mode}})):e.$message.error("".concat(i.data.msg)),e.btnLoading=!1;case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},resetForm:function(){this.$refs.elForm.resetFields()},goBack:function(){this.$router.go(-1)},editInit:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getUpStreamListData(),r=e.$route.query.id,t.next=4,Object(o["r"])({id:r});case 4:if(a=t.sent,i=a.data,200===i.status){t.next=9;break}return i.msg&&e.$message.error(i.msg),t.abrupt("return");case 9:n="",i.data[0].ip.forEach((function(e,t){0!==t&&(t!==i.data[0].ip.length-1?n=n+e.ip+",":n+=e.ip)})),e.ipListString=n,e.paid_time=1e3*i.data[0].paid_time,e.formData=i.data[0];case 14:case"end":return t.stop()}}),t)})))()},addInit:function(){this.formData.in_ip=void 0,this.formData.ip=void 0,this.formData.pz=void 0,this.formData.uname=void 0,this.formData.ipmi=void 0,this.formData.ipmijq=void 0,this.formData.total=void 0,this.formData.names=void 0,this.formData.paid_time=void 0,this.ipListString=void 0,this.getUpStreamListData(),this.getAddData()},getAddData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["c"])();case 2:r=t.sent,a=r.data,e.control_modeOptions=a.control_mode;case 5:case"end":return t.stop()}}),t)})))()},getUpStreamListData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["s"])({type:"all"});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=7;break}return a.msg&&e.$message.error(a.msg),t.abrupt("return");case 7:e.UpStreamNameList=a.data;case 8:case"end":return t.stop()}}),t)})))()},confirmPwdChange:function(){this.formData.confirmPwd!==this.formData.pwd?(this.pwdDiff=!0,this.pwdDiffMsg="两次密码不一致"):(this.pwdDiff=!1,this.pwdDiffMsg="")},editPageData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,i,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["m"])(e.$route.query.id);case 2:if(r=t.sent,a=r.data,200===a.status){t.next=7;break}return e.$message.error(a.msg),t.abrupt("return");case 7:if(e.control_modeOptions=a.control_mode,e.UpStreamNameList=a.data,e.formData=a.res,e.paid_time=1e3*a.res.paid_time,a.ip.length){for(i=[],n=0;n<a.ip.length;n++)s=a.ip[n],i.push(s.ip);e.ipListString=i.join()}case 12:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.$route.query.id?this.editPageData():this.addInit()},watch:{"formData.root":{handler:function(e){if("dcim_client"===this.formData.control_mode){var t=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;this.rules.dcim_client_id[0].required=!t.test(e)}},immediate:!0,deep:!0},"formData.control_mode":{handler:function(e){"ipmi"===e?(this.variableUserName="IPMI",this.variablePassWord="IPMI"):"dcim_client"===e&&(this.variableUserName="魔方DCIM",this.variablePassWord="魔方DCIM")},immediate:!0,deep:!0}}},l=s,u=(r("a5b4"),r("2877")),c=Object(u["a"])(l,a,i,!1,null,"05ee2749",null);t["default"]=c.exports}}]);