(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SystemMessage~31ecd969"],{"51bf":function(t,e,r){"use strict";r.d(e,"h",(function(){return a})),r.d(e,"e",(function(){return n})),r.d(e,"g",(function(){return i})),r.d(e,"d",(function(){return o})),r.d(e,"f",(function(){return l})),r.d(e,"c",(function(){return c})),r.d(e,"k",(function(){return u})),r.d(e,"b",(function(){return m})),r.d(e,"i",(function(){return p})),r.d(e,"j",(function(){return d})),r.d(e,"a",(function(){return f}));var s=r("a27e");function a(){return Object(s["a"])({url:"system/info"})}function n(){return Object(s["a"])({url:"system/lastversion"})}function i(){return Object(s["a"])({url:"system/phpinfo"})}function o(){return Object(s["a"])({url:"system/databaseinfo"})}function l(){return Object(s["a"])({url:"system/optimizeTables",method:"post"})}function c(){return Object(s["a"])({url:"system/downdatabackup",method:"post",responseType:"blob"})}function u(){return Object(s["a"])({url:"system/autoupdate"})}function m(){return Object(s["a"])({url:"system/checkautoupdate"})}function p(t){return Object(s["a"])({url:"system/toggleversion",method:"post",data:t})}function d(){return Object(s["a"])({url:"system/updatecontent"})}function f(t){return Object(s["a"])({url:"system/license",method:"put",data:t})}},"5b12":function(t,e,r){"use strict";var s=r("9194"),a=r("d192"),n=r("baa9"),i=r("4023"),o=r("b418"),l=r("c11d"),c=r("a187"),u=r("1a58"),m=r("5a62"),p=r("7ce6"),d=[].push,f=Math.min,g=4294967295,b=!p((function(){return!RegExp(g,"y")}));s("split",2,(function(t,e,r){var s;return s="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var s=String(i(this)),n=void 0===r?g:r>>>0;if(0===n)return[];if(void 0===t)return[s];if(!a(t))return e.call(s,t,n);var o,l,c,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,b=new RegExp(t.source,p+"g");while(o=m.call(b,s)){if(l=b.lastIndex,l>f&&(u.push(s.slice(f,o.index)),o.length>1&&o.index<s.length&&d.apply(u,o.slice(1)),c=o[0].length,f=l,u.length>=n))break;b.lastIndex===o.index&&b.lastIndex++}return f===s.length?!c&&b.test("")||u.push(""):u.push(s.slice(f)),u.length>n?u.slice(0,n):u}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:e.call(this,t,r)}:e,[function(e,r){var a=i(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,a,r):s.call(String(a),e,r)},function(t,a){var i=r(s,t,this,a,s!==e);if(i.done)return i.value;var m=n(t),p=String(this),d=o(m,RegExp),h=m.unicode,v=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(b?"y":"g"),_=new d(b?m:"^(?:"+m.source+")",v),y=void 0===a?g:a>>>0;if(0===y)return[];if(0===p.length)return null===u(_,p)?[p]:[];var w=0,x=0,k=[];while(x<p.length){_.lastIndex=b?x:0;var j,A=u(_,b?p:p.slice(x));if(null===A||(j=f(c(_.lastIndex+(b?0:x)),p.length))===w)x=l(p,x,h);else{if(k.push(p.slice(w,x)),k.length===y)return k;for(var C=1;C<=A.length-1;C++)if(k.push(A[C]),k.length===y)return k;x=w=j}}return k.push(p.slice(w)),k}]}),!b)},"7ddf":function(t,e,r){},"987c":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box"},[r("el-form",{attrs:{"label-width":"auto"}},[r("el-row",{attrs:{type:"flex",gutter:30}},[r("el-col",{attrs:{xs:24,md:10}},[r("el-card",[r("el-form-item",{attrs:{label:"服务器ip："}},[r("span",[t._v(t._s(t.listArray.server_ip))])]),r("el-form-item",{attrs:{label:"域名："}},[r("span",[t._v(t._s(t.listArray.server_name))])]),r("el-form-item",{attrs:{label:"系统号："}},[r("span",[t._v(t._s(t.listArray.system_token))])]),r("el-form-item",{attrs:{label:"系统当前版本："}},[r("span",[t._v(t._s(t.listArray.install_version)+"-"+t._s(t.listArray.zjmf_system_version_type_last))])]),r("el-form-item",{attrs:{label:"系统最新版本："}},[t.dataLoading?r("span",{staticClass:"el-icon-loading"}):r("span",["no_response"===t.lastVersionCheck?r("el-link",{staticStyle:{"line-height":"20px"},attrs:{href:"https://bbs.idcsmart.com/thread-615-1-1.html",target:"blank"}},[t._v("未检测到最新版本, 请前往手动更新")]):r("span",[r("span",{staticClass:"cursor-pointer mr-10",staticStyle:{color:"#2f54ea"},on:{click:function(e){t.updateContentDialog=!0}}},[t._v("更新内容")]),t._v(t._s(t.lastVersion))])],1)]),r("el-form-item",{attrs:{label:"版本："}},[t.listArray.system_version_type?r("span",{staticClass:"cursor-pointer mr-10",staticStyle:{color:"#2f54ea"},on:{click:t.toggleVersion}},[t._v("更换版本")]):t._e(),t.dataLoading?t._e():r("span",[t._v(t._s("stable"===t.listArray.system_version_type?"正式版":"内测版"))])]),r("el-form-item",{attrs:{label:"授权类型："}},[t.dataLoading?r("span",{staticClass:"el-icon-loading"}):r("span",[0===t.licenseType?r("span",[t._v("免费版")]):t._e(),1===t.licenseType?r("span",[t._v("专业版")]):t._e()])]),r("el-form-item",{attrs:{label:"授权码："}},[r("span",{staticClass:"cursor-pointer mr-10",staticStyle:{color:"#2f54ea"},on:{click:t.openAuthorize}},[t._v("更换授权码")]),t.clientWidth>1366?r("span",[t._v(t._s(t.listArray.system_license))]):t._e()]),t.clientWidth<=1366?r("el-form-item",{staticClass:"systemCode",staticStyle:{"margin-left":"0 !important"},attrs:{label:" "}},[r("span",[t._v(t._s(t.listArray.system_license))])]):t._e(),r("el-form-item",{staticClass:"upload-button",attrs:{label:""}},[t.isLastestVersion?t._e():r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload",loading:t.updateLoading,disabled:t.dataLoading},on:{click:t.updateHandleClick}},[t._v(t._s(t.dataLoading?"正在检查更新":"更新系统"))]),t.isLastestVersion?r("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-upload",disabled:""}},[t._v(t._s(t.dataLoading?"正在检查更新":"您已是最新版本"))]):t._e()],1)],1)],1),r("el-col",{attrs:{xs:24,md:14}},[r("el-card",[r("el-form-item",{attrs:{label:"端口号："}},[r("span",[t._v(t._s(t.listArray.server_port))])]),r("el-form-item",{attrs:{label:"服务器系统版本："}},[r("span",[t._v(t._s(t.listArray.server_version))])]),r("el-form-item",{attrs:{label:"服务器操作系统："}},[r("span",[t._v(t._s(t.listArray.server_system))])]),r("el-form-item",{attrs:{label:"php版本："}},[r("span",[t._v(t._s(t.listArray.php_version))])]),r("el-form-item",{attrs:{label:"获取PHP安装路径："}},[r("span",[t._v(t._s(t.listArray.include_path))])]),r("el-form-item",{attrs:{label:"PHP运行方式："}},[r("span",[t._v(t._s(t.listArray.php_sapi_name))])]),r("el-form-item",{attrs:{label:"服务器时间："}},[r("span",[t._v(t._s(t.listArray.now_time))])]),r("el-form-item",{attrs:{label:"服务器上传限制："}},[r("span",[t._v(t._s(t.listArray.upload_max_filesize))])]),r("el-form-item",{attrs:{label:"服务脚本最大执行时间："}},[r("span",[t._v(t._s(t.listArray.max_execution_time))])]),r("el-form-item",{attrs:{label:"内存占用："}},[r("span",[t._v(t._s(t.listArray.memory_limit))])]),r("el-form-item",{attrs:{label:"脚本运行占用最大内存："}},[r("span",[t._v(t._s(t.listArray.processor_identifier))])]),r("el-form-item",{attrs:{label:"系统根目录："}},[r("span",[t._v(t._s(t.listArray.system_root))])]),r("el-form-item",{attrs:{label:"获取服务器语言："}},[r("span",[t._v(t._s(t.listArray.http_accept_language))])]),r("el-form-item",{attrs:{label:"数据库版本："}},[r("span",[t._v(t._s(t.listArray.mysql_version))])])],1)],1)],1)],1),r("el-dialog",{attrs:{title:"系统更新进度",visible:t.dialogVisible,width:"30%","show-close":!1,close:t.clearTimer},on:{"update:visible":function(e){t.dialogVisible=e},open:t.getUpdateProgress}},[r("el-progress",{class:{"progress-clear":100===t.progress},attrs:{"text-inside":!0,"stroke-width":26,percentage:t.progress}}),r("div",{staticClass:"tac mt-10"},[r("span",[t._v(t._s(t.updateDesc))])]),100===t.progress?r("div",{staticClass:"tac mt-10"},[r("el-button",{attrs:{size:"small"},on:{click:t.goToInstall}},[t._v("前往安装")])],1):t._e()],1),r("el-dialog",{attrs:{title:"更新内容",visible:t.updateContentDialog,width:"60%"},on:{"update:visible":function(e){t.updateContentDialog=e}}},[r("div",{staticStyle:{width:"100%","max-height":"600px",height:"-webkit-fill-available","overflow-y":"auto"},domProps:{innerHTML:t._s(t.updataContent)}})]),r("el-dialog",{attrs:{title:"更换授权码",visible:t.authorizeVisable,width:"550px"},on:{"update:visible":function(e){t.authorizeVisable=e}}},[r("el-form",{ref:"formData",attrs:{model:t.formData,size:"medium","label-width":"120px"}},[r("el-form-item",{attrs:{label:"授权码",prop:"license",rules:{required:!0,message:"请输入授权码"}}},[r("el-input",{model:{value:t.formData.license,callback:function(e){t.$set(t.formData,"license",e)},expression:"formData.license"}})],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.authorizeVisable=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary",loading:t.authorizeLoading},on:{click:t.submitForm}},[t._v("确 定")])],1)],1)],1)},a=[],n=r("60b5"),i=(r("5b12"),r("9b5f"),r("3bae"),r("24a8"),r("6a61"),r("51bf")),o={metaInfo:{title:"系统升级"},data:function(){return{listArray:{},updateLoading:!1,dialogVisible:!1,authorizeVisable:!1,timer:null,progress:0,updateDesc:"",preWindow:null,formData:{license:null},isLastestVersion:!0,updateContentDialog:!1,updataContent:"",dataLoading:!0,lastVersion:"",licenseType:-1,lastVersionCheck:"",authorizeLoading:!1}},methods:{getSystemInfo:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dataLoading=!0,e.next=3,Object(i["h"])();case 3:r=e.sent,s=r.data,200!==s.status||(t.listArray=s.data,t.getLastVersion(s.data.install_version)),t.dataLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},getLastVersion:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a,n,o,l,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.dataLoading=!0,r.next=3,Object(i["e"])();case 3:s=r.sent,a=s.data,e.dataLoading=!1,200!==a.status?e.$message.error(a.msg):(e.lastVersion=a.data.last_version,e.licenseType=a.data.license_type,e.lastVersionCheck=a.data.last_version_check,n=t.split("."),o=a.data.last_version.split("."),l="",c="",n.forEach((function(t){l+=t})),o.forEach((function(t){c+=t})),Number(l)<Number(c)?e.isLastestVersion=!1:e.isLastestVersion=!0);case 7:case"end":return r.stop()}}),r)})))()},updateHandleClick:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$confirm("我已备份数据, 确认更新","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.dialogVisible=!0,e.next=3,Object(i["k"])();case 3:r=e.sent,s=r.data,200===s.status?(t.$message.success(s.msg),t.getSystemInfo()):503===s.status||s&&t.$message.error(s.msg);case 6:case"end":return e.stop()}}),e)})))).catch((function(){}));case 1:case"end":return e.stop()}}),e)})))()},getUpdateProgress:function(){var t=this;this.timer=setInterval(Object(n["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["b"])();case 2:r=e.sent,s=r.data,1001===s.status?(t.progress=Number(s.progress.split("%")[0]),t.updateDesc=s.msg,t.clearTimer()):200===s.status?(t.progress=Number(s.progress.split("%")[0]),t.updateDesc=s.msg):400===s.status&&(t.$message.error(s.msg),t.dialogVisible=!1,t.clearTimer());case 5:case"end":return e.stop()}}),e)}))),2e3)},goToInstall:function(){var t="/upgrade/install.php";this.preWindow&&this.preWindow.close(),this.preWindow=window.open(t)},clearTimer:function(){clearInterval(this.timer)},toggleVersion:function(){var t=this,e="";e="stable"===this.listArray.system_version_type?"\n          当前为正式版，您可升级为内测版<br>\n          1、注意，请不要在商用环境申请内测版。<br>\n          2、所有新功能做完内部初审后都会第一时间向内测用户推送。<br>\n          3、内测版会有诸多小Bug，如遇到，可以论坛或QQ找我们，我们一定负责到底。<br>\n          4、内测意义在于为广大用户找Bug，魔方团队再一次感谢您的积极参与。<br>\n          5、如果你不是愿意付出及肯折腾学习的人，我们不建议申请内测。\n        ":"\n          当前为内测版，您可切换为正式版<br>\n          1.注意，只有当系统有更高版本正式版时，您才可以进行升级<br>\n          2.正式版不在提供新的功能测试<br>\n          3.转为正式版后，您可继续申请为内测版。\n        ",this.$confirm(e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"",dangerouslyUseHTMLString:!0,customClass:"custom-width"}).then(Object(n["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["i"])({type:"stable"===t.listArray.system_version_type?"beta":"stable"});case 2:r=e.sent,s=r.data,200!==s.status?t.$message.error(s.msg):(t.$message.success(s.msg),t.getSystemInfo());case 5:case"end":return e.stop()}}),e)})))).catch((function(){}))},getUpdateContent:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["j"])();case 2:r=e.sent,s=r.data,200!==s.status?t.$message.error(s.msg):t.updataContent=s.data;case 5:case"end":return e.stop()}}),e)})))()},openAuthorize:function(){this.formData.license=this.listArray.system_license,this.authorizeVisable=!0},submitForm:function(){var t=this;this.$refs.formData.validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=13;break}return t.authorizeLoading=!0,e.next=4,Object(i["a"])(t.formData);case 4:if(s=e.sent,a=s.data,t.authorizeLoading=!1,200===a.status){e.next=10;break}return t.$message.error(a.msg),e.abrupt("return",!1);case 10:t.getSystemInfo(),t.$message.success(a.msg),t.authorizeVisable=!1;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getSystemInfo();case 2:t.getUpdateContent();case 3:case"end":return e.stop()}}),e)})))()},computed:{clientWidth:function(){return document.body.clientWidth}}},l=o,c=(r("e5059"),r("5d22")),u=Object(c["a"])(l,s,a,!1,null,"11c475f6",null);e["default"]=u.exports},d192:function(t,e,r){var s=r("97f5"),a=r("36b2"),n=r("3086"),i=n("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==a(t))}},e5059:function(t,e,r){"use strict";r("7ddf")}}]);