(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ServiceSupport~f71cff67"],{4374:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"service_support"},[a("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center"}},[e.isMobile?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addGroup}},[e._v("新建分组")]):e._e()],1),e.isMobile?[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.groupID,callback:function(t){e.groupID=t},expression:"groupID"}},e._l(e.pageData.level_data,(function(t,n){return a("el-tab-pane",{key:n+"a",attrs:{label:t.name.toString(),name:t.id.toString()}},[a("div",{staticClass:"groupInfo"},[a("span",{staticStyle:{"font-size":"14px",color:"#333"}},[e._v(e._s(t.description))]),a("el-dropdown",{attrs:{trigger:"click"},on:{command:function(a){return e.handleCommand(a,t)}}},[a("span",[a("el-button",{attrs:{icon:"el-icon-setting",circle:""}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"editGroup"}},[e._v("修改名称")]),a("el-dropdown-item",{attrs:{command:"toTop"}},[e._v("移至顶部")]),a("el-dropdown-item",{attrs:{command:"toBottom"}},[e._v("移至底部")]),0!==n?a("el-dropdown-item",{attrs:{command:"moveUp"}},[e._v("上移")]):e._e(),e.pageData.level_data.length-1!==n?a("el-dropdown-item",{attrs:{command:"moveDown"}},[e._v("下移")]):e._e(),a("el-dropdown-item",{attrs:{command:"del"}},[e._v("删除")])],1)],1)],1)])})),1)]:e._e(),a("div",{staticClass:"box"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isMobile,expression:"!isMobile"}],staticClass:"file--group"},[a("div",{staticClass:"file--group_head"},[a("span",{staticClass:"file--group_title"},[e._v("文件分组")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addGroup}},[e._v("新建分组")])],1),a("ul",{staticClass:"group_ul"},e._l(e.pageData.level_data,(function(t,n){return a("li",{key:n,staticClass:"group_li",class:{active:e.groupID===t.id}},[a("el-tooltip",{staticClass:"item",attrs:{disabled:""===t.description,effect:"light",content:t.description,placement:"right"}},[a("span",{staticClass:"group_li_name",on:{click:function(a){return e.changeGroup(t)}}},[e._v(" "+e._s(t.name)+" "+e._s(0===t.file_count?"":"("+t.file_count+")")+" "),a("span",{staticStyle:{color:"#999"}},[e._v(e._s(1===t.hidden?"(隐藏)":""))])])]),a("el-dropdown",{on:{command:function(a){return e.handleCommand(a,t)}}},[a("span",[a("i",{staticClass:"el-icon-more li_more"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"editGroup"}},[e._v("修改名称")]),a("el-dropdown-item",{attrs:{command:"toTop"}},[e._v("移至顶部")]),a("el-dropdown-item",{attrs:{command:"toBottom"}},[e._v("移至底部")]),0!==n?a("el-dropdown-item",{attrs:{command:"moveUp"}},[e._v("上移")]):e._e(),e.pageData.level_data.length-1!==n?a("el-dropdown-item",{attrs:{command:"moveDown"}},[e._v("下移")]):e._e(),a("el-dropdown-item",{attrs:{command:"del"}},[e._v("删除")])],1)],1)],1)})),0)]),a("div",{staticClass:"file--table"},[a("div",{staticClass:"file--group_head"},[a("span",{staticClass:"file--group_title"},[e._v("文件列表")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.goFile}},[e._v("添加文件")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:this.pageData.files},on:{"selection-change":e.handleSelectionChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!this.pageData.files.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),this.pageData.files.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"title",label:"文件名称"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-link",{on:{click:function(t){return e.goEdit(n)}}},[e._v(e._s(n.title))])]}}])}),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),a("el-table-column",{attrs:{prop:"type",label:"文件类型",width:"110",align:"center"}}),a("el-table-column",{attrs:{prop:"clientsonly",label:"需要登录",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("span",[1===t.clientsonly?a("i",{staticClass:"el-icon-circle-check yes-icon"}):a("i",{staticClass:"el-icon-circle-close no-icon"})])]}}])}),a("el-table-column",{attrs:{prop:"productdownload",label:"需要购买",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("span",[1===t.productdownload?a("i",{staticClass:"el-icon-circle-check yes-icon "}):a("i",{staticClass:"el-icon-circle-close no-icon"})])]}}])}),a("el-table-column",{attrs:{prop:"hidden",label:"隐藏",width:"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[a("span",[1===t.hidden?a("i",{staticClass:"el-icon-circle-check yes-icon "}):a("i",{staticClass:"el-icon-circle-close no-icon"})])]}}])}),a("el-table-column",{attrs:{prop:"downloads",label:"下载次数",width:"90",align:"center"}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"145",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("div",[e._v(" "+e._s(n.create_time?e.$moment(1e3*n.create_time).format("YYYY-MM-DD HH:mm:ss"):"-")+" ")])]}}])})],1),a("el-row",{staticStyle:{"margin-top":"15px"}},[a("el-button",{attrs:{size:"small",type:"danger",disabled:0===e.delFileArr.length},on:{click:e.delFile}},[e._v("移除")])],1)],1)]),a("el-dialog",e._g(e._b({attrs:{visible:e.diaVis,title:e.isAdd?"添加分组":"修改分组"},on:{"update:visible":function(t){e.diaVis=t},open:e.onOpen,close:e.onClose}},"el-dialog",e.$attrs,!1),e.$listeners),[a("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,size:"medium","label-width":"auto"}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{style:{width:"100%"},attrs:{placeholder:"请输入分类名称",clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"分类描述",prop:"description"}},[a("el-input",{style:{width:"100%"},attrs:{maxlength:40,"show-word-limit":"",placeholder:"请输入分类描述"},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:"是否隐藏",prop:"hidden"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.formData.hidden,callback:function(t){e.$set(e.formData,"hidden",t)},expression:"formData.hidden"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handelConfirm}},[e._v("确定")])],1)],1)],2)},r=[],i=(a("4160"),a("159b"),a("96cf"),a("1da1")),o=a("6671"),s={inject:["reload"],metaInfo:{title:"文件下载"},data:function(){return{tableLoading:!1,activeName:"",isMobile:!1,clientWidth:document.body.clientWidth,isAdd:!1,idEdit:!1,diaVis:!1,pageData:{level_data:[],files:[]},groupID:0,delFileArr:[],formData:{id:0,name:void 0,description:void 0,hidden:0},rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}],description:[]}}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getDownloadList();case 2:"add"!==e.$store.state.fileOp?e.groupID=e.pageData.level_data.length>0?e.pageData.level_data[0].id:0:e.groupID=e.$store.state.fileGroupId;case 3:case"end":return t.stop()}}),t)})))()},mounted:function(){window.addEventListener("resize",this.resize)},methods:{handleClick:function(e){this.getDownloadList()},resize:function(){this.clientWidth=document.body.clientWidth},delFile:function(){var e=this;this.$confirm("将移除勾选的文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.delFileArr.forEach((function(e){t.push(e.id)})),Object(o["c"])(t).then((function(t){200!==t.data.status?e.$message.error(t.data.msg):(e.$message.success(t.data.msg),e.delFileArr=[],e.getDownloadList())})).then((function(){e.active=e.pageData.level_data.length>0?e.pageData.level_data[0].id:0}))})).catch((function(){}))},goEdit:function(e){this.$router.push({name:"File",query:{id:this.groupID,wid:e.id,type:"edit"}})},goFile:function(){this.groupID?this.$router.push({name:"File",query:{id:this.groupID,type:"add"}}):this.$message.error("请选择分类后添加")},handleSelectionChange:function(e){this.delFileArr=e},handleCommand:function(e,t){"editGroup"===e?this.editGroup(t.id):"del"===e?this.delGroup(t.id):"toTop"===e?this.toTop(t.id,1):"toBottom"===e?this.toTop(t.id,2):"moveUp"===e?this.moveUp(t.id,3):"moveDown"===e&&this.moveDown(t.id,4)},moveUp:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r={id:e,type:t,pre_id:a.getPreId(e)},-1!==r.pre_id){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Object(o["j"])(r);case 5:i=n.sent,s=i.data,200!==s.status?a.$message.error(s.msg):(a.$message.success(s.msg),a.reload());case 8:case"end":return n.stop()}}),n)})))()},moveDown:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r={id:e,type:t,pre_id:a.getNextId(e)},-1!==r.pre_id){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,Object(o["j"])(r);case 5:i=n.sent,s=i.data,200!==s.status?a.$message.error(s.msg):(a.$message.success(s.msg),a.reload());case 8:case"end":return n.stop()}}),n)})))()},toTop:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={id:e,type:t},n.next=3,Object(o["j"])(r);case 3:i=n.sent,s=i.data,200!==s.status?a.$message.error(s.msg):(a.$message.success(s.msg),a.reload());case 6:case"end":return n.stop()}}),n)})))()},getNextId:function(e){for(var t=this.pageData.level_data,a=0;a<t.length;a++){var n=t[a];if(n.id===e)return a+1===t.length?(this.$message.error("已经是最后一个了"),-1):t[a+1].id}},getPreId:function(e){for(var t=this.pageData.level_data,a=0;a<t.length;a++){var n=t[a];if(n.id===e)return a<1?(this.$message.error("已经是第一个了"),-1):t[a-1].id}},delGroup:function(e){var t=this;this.$confirm("将删除此分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["d"])(e).then((function(e){200!==e.data.status?t.$message.error(e.data.msg):(t.$message.success(e.data.msg),t.groupID=0,t.reload())}))})).catch((function(){}))},editGroup:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.isEdit=!0,a.next=3,Object(o["f"])(e);case 3:if(n=a.sent,r=n.data,200===r.status){a.next=8;break}return t.$message.error(r.msg),a.abrupt("return");case 8:t.formData=r.data.cats_data,t.diaVis=!0;case 10:case"end":return a.stop()}}),a)})))()},addGroup:function(){this.isAdd=!0,this.diaVis=!0},onOpen:function(){},onClose:function(){this.diaVis=!1,this.isAdd=!1,this.isEdit=!1,this.$refs.elForm.resetFields()},close:function(){this.diaVis=!1,this.isAdd=!1,this.isEdit=!1,this.$refs.elForm.resetFields(),this.$emit("update:diaVis",!1)},handelConfirm:function(){var e=this;this.$refs.elForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:if(!e.isAdd){t.next=10;break}return t.next=5,Object(o["b"])(e.formData);case 5:n=t.sent,r=n.data,200!==r.status?e.$message.error(r.msg):(e.$message.success(r.msg),e.onClose(),e.groupID=0,e.getDownloadList()),t.next=16;break;case 10:if(!e.isEdit){t.next=16;break}return t.next=13,Object(o["g"])(e.formData);case 13:i=t.sent,s=i.data,200!==s.status?e.$message.error(s.msg):(e.$message.success(s.msg),e.onClose(),e.groupID=0,e.getDownloadList());case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},changeGroup:function(e){this.groupID=e.id,this.getDownloadList()},getDownloadList:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,"add"===e.$store.state.fileOp&&0!==e.$store.state.fileGroupId&&(e.groupID=e.$store.state.fileGroupId),t.next=4,Object(o["h"])(e.groupID);case 4:if(a=t.sent,n=a.data,200===n.status){t.next=9;break}return e.$message.error(n.msg),t.abrupt("return");case 9:e.pageData=n.data,e.tableLoading=!1;case 11:case"end":return t.stop()}}),t)})))()}},computed:{},watch:{"pageData.level_data.length":{handler:function(e){"add"===this.$store.state.fileOp?this.groupID=this.$store.state.fileGroupId:e>0&&0!==this.$store.state.fileGroupId&&(this.groupID=this.pageData.level_data[0].id)},immediate:!0},clientWidth:{handler:function(e){this.clientWidth=document.body.clientWidth,this.isMobile=e<750},immediate:!0}},beforeDestroy:function(){this.$store.commit("fileGroupId",0),this.$store.commit("setFileOp","")}},l=s,d=(a("b4f9"),a("2877")),c=Object(d["a"])(l,n,r,!1,null,"aa545eac",null);t["default"]=c.exports},6671:function(e,t,a){"use strict";a.d(t,"h",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return d})),a.d(t,"i",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"j",(function(){return m}));var n=a("a27e");function r(e){return Object(n["a"])({url:"downloads/list",params:{id:e}})}function i(e){return Object(n["a"])({url:"downloads/create",method:"post",data:e})}function o(e){return Object(n["a"])({url:"downloads/edit",params:{id:e}})}function s(e){return Object(n["a"])({url:"downloads/update",method:"post",data:e})}function l(e){return Object(n["a"])({url:"downloads/cat",method:"delete",params:{id:e}})}function d(e){return Object(n["a"])({url:"downloads/file",method:"delete",params:{id:e}})}function c(e){return Object(n["a"])({url:"downloads/filepage",params:{id:e}})}function u(e){return Object(n["a"])({url:"downloads/addfile",method:"post",data:e})}function p(e){return Object(n["a"])({url:"downloads/savefile",method:"post",data:e})}function m(e){return Object(n["a"])({url:"downloads/updatesort",method:"post",data:e})}},b4f9:function(e,t,a){"use strict";var n=a("db71"),r=a.n(n);r.a},db71:function(e,t,a){}}]);