(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ZjmfApi~31ecd969"],{1201:function(t,e,a){},"129f":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"1c84":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h5",{staticClass:"mt-0"},[t._v(" 提供财务系统之间的互相代理，在此添加API接口信息即可成为代理商。 "),a("el-link",{attrs:{type:"primary",href:"https://bbs.idcsmart.com/forum.php?mod=viewthread&tid=136&extra=page%3D1%26filter%3Dtypeid%26typeid%3D7",target:"blank"}},[t._v("帮助文档")])],1),a("el-button",{attrs:{size:"small",type:"success"},on:{click:t.toAdd}},[t._v("添加API")]),a("el-table",{staticClass:"mt-10 datatable",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""},on:{"sort-change":t.sortChange}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!t.tableData.length&&t.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),t._v(" 正在加载 ... ")]):t._e(),t.tableData.length||t.tableLoading?t._e():a("span",[t._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"name",label:"名称",sortable:""}}),a("el-table-column",{attrs:{prop:"hostname",label:"接口地址",sortable:""}}),a("el-table-column",{attrs:{prop:"username",label:"鉴权信息"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("span",[t._v(t._s(r.username))]),t._v(" / "),a("span",[t._v(t._s(r.password.replace(/[^]/g,"*")))])]}}])}),a("el-table-column",{attrs:{prop:"product_num",label:"可售/已设置商品",sortable:"",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("span",[t._v(t._s(r.product_num))]),t._v("/ "),a("span",[t._v(t._s(r.set_product_num))])]}}])},[a("template",{slot:"header"},[a("span",{staticClass:"mr-5"},[t._v("可售/已设置商品")]),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("可售：上游购物车接口中商品数量的总数")]),a("el-col",{attrs:{span:24}},[t._v("已设置：系统中使用该接口对接的商品数量")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"active_host_num",label:"产品数量(正常/总)",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("span",[t._v(t._s(r.active_host_num))]),t._v("/ "),a("span",[t._v(t._s(r.host_num))])]}}])},[a("template",{slot:"header"},[a("span",{staticClass:"mr-5"},[t._v("产品数量(正常/总)")]),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("正常：您系统购买使用此接口的产品且状态为已激活。")]),a("el-col",{attrs:{span:24}},[t._v("总：所有使用该接口购买的产品，不管状态。")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1)],2),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"120",sortable:"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[r.loading||1!==r.status?t._e():a("el-tooltip",{attrs:{effect:"dark",content:r.desc,placement:"right"}},[a("i",{staticClass:"el-icon-circle-check yes-icon",on:{click:function(e){return t.refreashStatus(r)}}})]),r.loading||0!==r.status?t._e():a("el-tooltip",{attrs:{effect:"dark",content:r.desc,placement:"right"}},[a("i",{staticClass:"el-icon-circle-close no-icon",staticStyle:{color:"#fff","background-color":"red"},on:{click:function(e){return t.refreashStatus(r)}}})]),r.loading?a("i",{staticClass:"el-icon-loading"}):t._e()]}}])},[a("template",{slot:"header"},[a("span",{staticClass:"mr-5"},[t._v("状态")]),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("点此刷新，鼠标放在图标上可显示连接信息，绿色即正常。")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),a("template",{slot:"header"},[a("i",{staticClass:"el-icon-refresh mr-5",staticStyle:{cursor:"pointer"},on:{click:function(e){return e.stopPropagation(),t.getAllStatus(e)}}})])],2),a("el-table-column",{attrs:{prop:"des",label:"描述"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.des||"-")+" ")]}}])}),a("el-table-column",{attrs:{label:"管理",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.toEdit(e.row)}}},[t._v("编辑 ")]),a("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.deleteHandleClick(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":t.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":t.search.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.getData,"update:currentPage":function(e){return t.$set(t.search,"page",e)},"update:current-page":function(e){return t.$set(t.search,"page",e)},"update:pageSize":function(e){return t.$set(t.search,"limit",e)},"update:page-size":function(e){return t.$set(t.search,"limit",e)}}}),a("el-dialog",{attrs:{visible:t.dialogVisiable,title:t.formData.id?"编辑API":"添加API",width:"25%"},on:{"update:visible":function(e){t.dialogVisiable=e},close:t.dialogClose}},[a("el-form",{ref:"elForm",attrs:{model:t.formData,rules:t.rules,"label-width":"auto"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 名称 "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("自定义，建议填写上游的公司名称，便于查看")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),a("el-input",{attrs:{size:"small"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"接口地址(IP或者域名)",prop:"hostname"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 接口地址(IP或者域名) "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"230",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("上游魔方财务系统的访问地址或ip")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),a("el-input",{attrs:{size:"small"},model:{value:t.formData.hostname,callback:function(e){t.$set(t.formData,"hostname",e)},expression:"formData.hostname"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 用户名 "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("您在上游注册的账号，手机/邮箱")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),a("el-input",{attrs:{size:"small"},model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}})],1),a("el-form-item",{attrs:{label:"API密钥",prop:"password"}},[a("span",{attrs:{slot:"label"},slot:"label"},[t._v(" API密钥 "),a("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[a("el-row",[a("el-col",{attrs:{span:24}},[t._v("您在上游获取的api密钥，【上游客户中心-安全中心-API】点击【查看密钥】")])],1),a("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),a("el-input",{attrs:{size:"small","show-password":""},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"des"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.des,callback:function(e){t.$set(t.formData,"des",e)},expression:"formData.des"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogVisiable=!1}}},[t._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:t.btnLoading},on:{click:t.submit}},[t._v("确定")])],1)],1)],1)},s=[],n=(a("4de4"),a("4160"),a("b0c0"),a("a9e3"),a("ac1f"),a("841c"),a("159b"),a("96cf"),a("1da1")),o=a("a27e");function l(t){return Object(o["a"])({url:"zjmf_finance_api",method:"post",data:t})}function i(t){return Object(o["a"])({url:"zjmf_finance_api",method:"put",data:t})}function c(t){return Object(o["a"])({url:"zjmf_finance_api/".concat(t)})}function u(t){return Object(o["a"])({url:"zjmf_finance_api/".concat(t),method:"delete"})}function d(t){return Object(o["a"])({url:"zjmf_finance_api",params:t})}function p(t){return Object(o["a"])({url:"zjmf_finance_api/".concat(t,"/status")})}var f={metaInfo:{title:"魔方财务API列表"},data:function(){return{tableLoading:!1,search:{page:1,limit:Number(localStorage.getItem("limit"))||50,orderby:"id",sort:"desc"},tableData:[],total:0,dialogVisiable:!1,formData:{id:0,name:"",hostname:"",username:"",password:"",des:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],hostname:[{required:!0,message:"请输入接口地址",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},btnLoading:!1}},methods:{getData:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableLoading=!0,e.next=3,d(t.search);case 3:a=e.sent,r=a.data,200!==r.status?t.$message.error(r.msg):((r.data.list||[]).forEach((function(t){t.status?t.desc="链接成功":t.desc="链接失败",t.loading=!1})),t.tableData=r.data.list,t.total=r.data.sum),t.tableLoading=!1;case 7:case"end":return e.stop()}}),e)})))()},handleSizeChange:function(t){this.search.page=1,this.getData()},sortChange:function(t,e,a){this.search.orderby=t.prop,"ascending"===t.order?this.search.sort="asc":this.search.sort="desc",this.getData()},toAdd:function(){this.formData.id=0,this.formData.name="",this.formData.hostname="",this.formData.username="",this.formData.password="",this.dialogVisiable=!0},toEdit:function(t){this.formData.id=t.id,this.formData.name=t.name,this.formData.hostname=t.hostname,this.formData.username=t.username,this.formData.password=t.password,this.formData.des=t.des,this.dialogVisiable=!0},getApiDetail:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,c(t);case 2:r=a.sent,s=r.data,200!==s.status&&e.$message.error(s.msg);case 5:case"end":return a.stop()}}),a)})))()},dialogClose:function(){this.$refs.elForm.resetFields()},submit:function(){var t=this;this.$refs.elForm.validate(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(a){var r,s,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",!1);case 2:if(t.formData.id){e.next=20;break}return t.btnLoading=!0,e.next=6,l(t.formData);case 6:if(r=e.sent,s=r.data,200===s.status){e.next=12;break}t.$message.error(s.msg),e.next=17;break;case 12:return t.$message.success(s.msg),t.dialogVisiable=!1,e.next=16,t.getData();case 16:t.refreashStatus(t.tableData[0]);case 17:t.btnLoading=!1,e.next=35;break;case 20:return t.btnLoading=!0,e.next=23,i(t.formData);case 23:if(n=e.sent,o=n.data,200===o.status){e.next=29;break}t.$message.error(o.msg),e.next=34;break;case 29:return t.$message.success(o.msg),t.dialogVisiable=!1,e.next=33,t.getData();case 33:t.refreashStatus(t.tableData.filter((function(e){return e.id===t.formData.id}))[0]);case 34:t.btnLoading=!1;case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},deleteHandleClick:function(t){var e=this;this.$confirm("将删除此API, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){u(t.id).then((function(t){200!==t.data.status?e.$message.error(t.data.msg):(e.$message.success(t.data.msg),e.getData())}))})).catch((function(){}))},refreashStatus:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,a.next=3,p(t.id);case 3:r=a.sent,s=r.data,200!==s.status?e.$message.error(s.msg||"刷新失败"):(t.desc=s.data.desc||"刷新失败",t.status=s.data.status),t.loading=!1;case 7:case"end":return a.stop()}}),a)})))()},getAllStatus:function(){var t=this;(this.tableData||[]).forEach((function(e){t.refreashStatus(e)}))}},created:function(){this.getData()}},m=f,g=(a("6a5c"),a("2877")),h=Object(g["a"])(m,r,s,!1,null,"500a1a44",null);e["default"]=h.exports},"1dde":function(t,e,a){var r=a("d039"),s=a("b622"),n=a("2d00"),o=s("species");t.exports=function(t){return n>=51||!r((function(){var e=[],a=e.constructor={};return a[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"4de4":function(t,e,a){"use strict";var r=a("23e7"),s=a("b727").filter,n=a("1dde"),o=a("ae40"),l=n("filter"),i=o("filter");r({target:"Array",proto:!0,forced:!l||!i},{filter:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}})},"6a5c":function(t,e,a){"use strict";var r=a("1201"),s=a.n(r);s.a},"841c":function(t,e,a){"use strict";var r=a("d784"),s=a("825a"),n=a("1d80"),o=a("129f"),l=a("14c3");r("search",1,(function(t,e,a){return[function(e){var a=n(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,a):new RegExp(e)[t](String(a))},function(t){var r=a(e,t,this);if(r.done)return r.value;var n=s(t),i=String(this),c=n.lastIndex;o(c,0)||(n.lastIndex=0);var u=l(n,i);return o(n.lastIndex,c)||(n.lastIndex=c),null===u?-1:u.index}]}))}}]);