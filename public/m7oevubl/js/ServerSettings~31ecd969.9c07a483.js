(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ServerSettings~31ecd969"],{"1dde":function(e,t,r){var n=r("d039"),a=r("b622"),s=r("2d00"),i=a("species");e.exports=function(e){return s>=51||!n((function(){var t=[],r=t.constructor={};return r[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"4de4":function(e,t,r){"use strict";var n=r("23e7"),a=r("b727").filter,s=r("1dde"),i=r("ae40"),o=s("filter"),u=i("filter");n({target:"Array",proto:!0,forced:!o||!u},{filter:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},a6a6:function(e,t,r){},bdf0:function(e,t,r){"use strict";r.d(t,"l",(function(){return a})),r.d(t,"g",(function(){return s})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return u})),r.d(t,"k",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"c",(function(){return f})),r.d(t,"j",(function(){return m})),r.d(t,"h",(function(){return v})),r.d(t,"a",(function(){return g}));var n=r("a27e");function a(e,t){return Object(n["a"])({url:"servers_list",params:{limit:e,page:t}})}function s(e){return Object(n["a"])({url:"delete_servers/".concat(e)})}function i(){return Object(n["a"])({url:"servers_add"})}var o={headers:{"Content-Type":"multipart/form-data"}};function u(e){return Object(n["a"])({url:"servers_add_post",method:"post",data:e,config:o})}function c(e){return Object(n["a"])({url:"edit_servers/".concat(e),method:"get"})}function l(e){return Object(n["a"])({url:"delete_server_groups/".concat(e)})}function d(){return Object(n["a"])({url:"create_groups"})}function p(e){return Object(n["a"])({url:"edit_server_groups/".concat(e)})}function f(e){return Object(n["a"])({url:"create_groups_post",method:"post",data:e})}function m(e){return Object(n["a"])({url:"edit_server_groups_post",method:"post",data:e})}function v(e){return Object(n["a"])({url:"edit_servers_post",method:"post",data:e})}function g(e){return Object(n["a"])({url:"server_test_link/".concat(e)})}},c5dc:function(e,t,r){"use strict";var n=r("a6a6"),a=r.n(n);a.a},e6c4:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"server"},[r("h5",{staticClass:"mt-0"},[e._v("在这里配置与我们通信的所有接口。每个模块的默认接口都标有星号（*）。为保证接口自动设置正常运行，您必须选择一个默认的接口。")]),r("el-button",{staticClass:"tit-btn",attrs:{size:"small",type:"success",icon:"el-icon-circle-plus-outline"},on:{click:e.toAdd}},[e._v("添加新接口 ")]),r("el-button",{staticClass:"tit-btn",attrs:{size:"small",icon:"el-icon-bottom",type:"primary",plain:""},on:{click:function(t){return e.serverGroupSet(null)}}},[e._v(" 创建新的分组 ")]),r("el-row",{attrs:{gutter:20}},e._l(e.tableData,(function(t,n){return r("el-col",{key:n,attrs:{xs:24,sm:24,md:12,lg:12,xl:12}},[r("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[r("h5",[e._v(e._s(t.name)+" ("+e._s(t.type)+")")]),r("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"}},[r("el-button",{staticClass:"fr oper-btn",attrs:{size:"small",type:"primary",plain:""},on:{click:function(r){return e.serverGroupSet(t.id)}}},[e._v("修改该分组 ")]),r("el-button",{staticClass:"fr oper-btn",attrs:{size:"small",type:"danger",plain:""},on:{click:function(r){return e.deleteServerGroup(t)}}},[e._v("删除该分组 ")])],1)]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.child,height:"400",border:""}},[r("div",{attrs:{slot:"empty"},slot:"empty"},[!t.child.length&&e.tableLoading?r("span",[r("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),t.child.length||e.tableLoading?e._e():r("span",[e._v("暂无数据")])]),r("el-table-column",{attrs:{prop:"id",label:"ID",width:"70",align:"center"}}),r("el-table-column",{attrs:{label:"状态",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[0!==n.link_status||n.statusLoading?e._e():r("el-tooltip",{attrs:{effect:"dark",content:n.msg?n.msg:"连接失败",placement:"right"}},[r("i",{staticClass:"el-icon-circle-close no-icon",on:{click:function(t){return e.getSingleStatus(n)}}})]),0===n.link_status||n.statusLoading?e._e():r("el-tooltip",{attrs:{effect:"dark",content:n.msg?n.msg:"连接成功",placement:"right"}},[r("i",{staticClass:"el-icon-circle-check yes-icon",on:{click:function(t){return e.getSingleStatus(n)}}})]),n.statusLoading?r("i",{staticClass:"el-icon-loading"}):e._e()]}}],null,!0)},[r("template",{slot:"header"},[r("i",{staticClass:"el-icon-refresh mr-5",staticStyle:{cursor:"pointer"},on:{click:function(r){return e.getAllStatus(t)}}}),r("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[r("el-row",[r("el-col",{attrs:{span:24}},[e._v("点此刷新，状态为绿色代表可以成功连接。")])],1),r("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1)],2),r("el-table-column",{attrs:{label:"接口名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",[e._v(e._s(t.row.name))])]}}],null,!0)}),r("el-table-column",{attrs:{prop:"ip_address",label:"IP地址",width:"130",align:"center"}}),r("el-table-column",{attrs:{label:"操作",width:"135",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(r){return e.editServer(t.row)}}},[e._v("编辑 ")]),r("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(r){return e.deleteServer(t.row)}}},[e._v(" 删除 ")])]}}],null,!0)})],1)],1)})),1),r("el-dialog",{attrs:{title:e.serverGroupTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"elForm",attrs:{model:e.saveServeGroup,rules:e.rules,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"接口组名",prop:"group_name"}},[r("el-input",{attrs:{size:"small",clearable:"",autocomplete:"off"},model:{value:e.saveServeGroup.group_name,callback:function(t){e.$set(e.saveServeGroup,"group_name",t)},expression:"saveServeGroup.group_name"}})],1),r("el-form-item",{attrs:{label:"模块选择",prop:"type"}},[r("el-select",{attrs:{size:"small",placeholder:"请选择模块",clearable:""},model:{value:e.saveServeGroup.type,callback:function(t){e.$set(e.saveServeGroup,"type",t)},expression:"saveServeGroup.type"}},e._l(e.serverGroupModel,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.resetData}},[e._v("取 消")]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveServerGroup}},[e._v("确 定")])],1)],1)],1)},a=[],s=(r("4de4"),r("4160"),r("b0c0"),r("159b"),r("96cf"),r("1da1")),i=r("bdf0"),o={metaInfo:{title:"通用接口"},data:function(){return{tableLoading:!1,tableData:[],search:"",dialogFormVisible:!1,serverGroupTitle:"",serverGroupModel:[],saveServeGroup:{id:"",group_name:"",type:""},rules:{id:[],group_name:[{required:!0,message:"请输入分组名"}],type:[{required:!0,message:"请选择模块"}]}}},methods:{getServerList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(i["l"])();case 3:r=t.sent,n=r.data,200!==n.status?e.$message.error(n.msg):((n.servergrouplist||[]).forEach((function(e){(e.child||[]).forEach((function(e){e.statusLoading=!1}))})),e.tableData=n.servergrouplist.filter((function(e){return"ipmi"!==e.type}))),e.tableLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},deleteServer:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("请问是否要删除该接口","删除提示",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(n=r.sent,"confirm"===n){r.next=5;break}return r.abrupt("return",t.$message.info("已经取消删除"));case 5:return r.next=7,Object(i["g"])(e.id);case 7:if(a=r.sent,200===a.data.status){r.next=10;break}return r.abrupt("return",t.$message.error(a.data.msg));case 10:t.$message.success(a.data.msg),t.getServerList();case 12:case"end":return r.stop()}}),r)})))()},toAdd:function(){this.$router.push({name:"addServer"})},editServer:function(e){this.$router.push({name:"addServer",query:{id:e.id}})},deleteServerGroup:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("请问是否要删除该接口分组","删除提示",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(n=r.sent,"confirm"===n){r.next=5;break}return r.abrupt("return",t.$message.info("已经取消删除"));case 5:return r.next=7,Object(i["f"])(e.id);case 7:if(a=r.sent,200===a.data.status){r.next=10;break}return r.abrupt("return",t.$message.error(a.data.msg));case 10:t.$message.success(a.data.msg),t.getServerList();case 12:case"end":return r.stop()}}),r)})))()},serverGroupSet:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,a,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.dialogFormVisible=!0,null!==e){r.next=10;break}return t.serverGroupTitle="新增接口分组",r.next=5,Object(i["b"])();case 5:n=r.sent,a=n.data,t.serverGroupModel=a.module.filter((function(e){return"ipmi"!==e.value})),r.next=19;break;case 10:return t.serverGroupTitle="修改接口分组",r.next=13,Object(i["i"])(e);case 13:s=r.sent,o=s.data,t.serverGroupModel=o.module,t.saveServeGroup.id=o.server_group.id,t.saveServeGroup.group_name=o.server_group.name,t.saveServeGroup.type=o.server_group.type;case 19:case"end":return r.stop()}}),r)})))()},saveServerGroup:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.elForm.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r&&(""!==e.saveServeGroup.id?e.eidServerGroup():e.addServerGroup());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},addServerGroup:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["c"])(e.saveServeGroup);case 2:r=t.sent,n=r.data,200===n.status?(e.$message.success(n.msg),e.$refs.elForm.resetFields(),e.dialogFormVisible=!1,e.getServerList()):e.$message.error(n.msg);case 5:case"end":return t.stop()}}),t)})))()},eidServerGroup:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["j"])(e.saveServeGroup);case 2:r=t.sent,n=r.data,200===n.status?(e.$message.success(n.msg),e.$refs.elForm.resetFields(),e.dialogFormVisible=!1,e.getServerList()):e.$message.error(n.msg);case 5:case"end":return t.stop()}}),t)})))()},resetData:function(){this.dialogFormVisible=!1,this.$refs.elForm.resetFields()},getAllStatus:function(e){var t=this;(e.child||[]).forEach((function(e){t.getSingleStatus(e)}))},getSingleStatus:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.statusLoading=!0,t.$forceUpdate(),r.next=4,Object(i["a"])(e.id);case 4:n=r.sent,a=n.data,200!==a.status?e.msg=a.msg:(e.link_status=a.data.server_status,0===a.data.server_status?e.msg=a.data.msg:e.msg="连接成功"),e.statusLoading=!1,t.$forceUpdate();case 9:case"end":return r.stop()}}),r)})))()}},created:function(){this.getServerList()}},u=o,c=(r("c5dc"),r("2877")),l=Object(c["a"])(u,n,a,!1,null,"4ee2e075",null);t["default"]=l.exports}}]);