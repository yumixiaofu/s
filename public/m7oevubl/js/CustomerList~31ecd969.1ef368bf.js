(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["CustomerList~31ecd969"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"41f5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customerlist"},[a("h5",{staticStyle:{"margin-top":"0"}},[e._v("系统内所有客户信息，点击姓名可查看更多详细信息并对客户进行管理。"),a("el-link",{on:{click:e.openDoc}},[e._v("帮助文档")])],1),a("div",{staticClass:"customerlist_header mb-20"},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-circle-plus-outline"},on:{click:e.goToAddCustomer}},[e._v("添加客户 ")]),a("el-select",{style:{width:"150px"},attrs:{size:"small",placeholder:"请选择条件"},on:{change:e.clearSearch},model:{value:e.searchSelect,callback:function(t){e.searchSelect=t},expression:"searchSelect"}},e._l(e.searchOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1),"status"===e.searchSelect?a("el-select",{style:{width:"150px"},attrs:{size:"small",clearable:"",placeholder:"请选择"},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}},e._l(e.StatusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):a("el-input",{style:{width:"150px"},attrs:{size:"small",placeholder:"输入关键字",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getData(t)}},model:{value:e.searchStr,callback:function(t){e.searchStr=t},expression:"searchStr"}}),a("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search",loading:e.btnLoading},on:{click:e.searchClick}},[e._v("搜索 ")])],1),a("el-row",[a("el-col",[a("el-table",{attrs:{data:e.customerListTableData,border:""},on:{"sort-change":e.changeSort}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.customerListTableData.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" 正在加载 ... ")]):e._e(),e.customerListTableData.length||e.tableLoading?e._e():a("span",[e._v("暂无数据")])]),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70",sortable:"custom",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("router-link",{attrs:{to:{path:"/customer-view/abstract",query:{id:r.id}}}},[a("el-link",{on:{click:function(t){return e.goToView(r.id)}}},[e._v(e._s(r.id))])],1)]}}])}),a("el-table-column",{attrs:{prop:"username",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",{staticClass:"first-row"},[a("router-link",{attrs:{to:{path:"/customer-view/abstract",query:{id:r.id}}}},[a("el-link",{style:{color:r.group_colour},attrs:{type:"primary"},on:{click:function(t){return e.goToView(r.id)}}},[e._v(" "+e._s(r.username)+" ")])],1),"已认证"===r.company_status?a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"企业认证",placement:"right"}},[a("i",{staticClass:"iconfont icon-qiyerenzheng color-suc indent2"})]):"未认证"===r.company_status&&"已认证"===r.person_status?a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:"个人认证",placement:"right"}},[a("i",{staticClass:"iconfont icon-gerenrenzheng1 color-suc indent2"})]):e._e()],1),a("div",{staticClass:"second-row"},[e._v(" "+e._s(r.companyname||"")+" ")])]}}])}),a("el-table-column",{attrs:{prop:"phonenumber",label:"手机号/邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-row",[a("el-col",{staticStyle:{"min-height":"17px"}},[e._v(e._s(r.phonenumber))]),a("el-col",{staticClass:"second-row",staticStyle:{"min-height":"17px"}},[e._v(e._s(r.email))])],1)]}}])}),a("el-table-column",{attrs:{prop:"host_total",label:"服务","min-width":"70"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("router-link",{attrs:{to:{path:"/customer-view/product-list",query:{id:r.id,currency_id:r.currency_id}}}},[a("el-link",[e._v(e._s(r.host_total))])],1)]}}])}),a("el-table-column",{attrs:{prop:"amount_in",label:"收入/支出",width:"115",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",[a("span",[e._v(e._s(r.prefix)+e._s(r.amount_in))])]),a("div",{staticClass:"second-row"},[a("span",[e._v(e._s(r.prefix)+e._s(r.amount_out))])])]}}])}),a("el-table-column",{attrs:{prop:"credit",label:"余额","min-width":"70",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",sortable:"custom",width:"135",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(0===a.create_time?"-":e.$moment(1e3*a.create_time).format("YYYY-MM-DD HH:mm"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"level",label:"客户等级",sortable:"custom",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(a.level||"-")+" ")]}}])}),a("el-table-column",{attrs:{prop:"group_name",label:"客户分组",sortable:"custom",width:"135",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",{style:{color:r.group_colour||"#333"}},[e._v(e._s(r.group_name||"-"))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"状态",sortable:"custom",width:"85",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[0===r.status?a("el-tag",{attrs:{size:"small",type:"danger"}},[e._v(e._s(r.client_status))]):1===r.status?a("el-tag",{attrs:{size:"small",type:"success"}},[e._v(e._s(r.client_status))]):a("el-tag",{attrs:{size:"small",type:"info"}},[e._v(e._s(r.client_status))])]}}])}),a("el-table-column",{attrs:{prop:"user_nickname",label:"销售",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.sale_id?a("span",[e._v(e._s(r.user_nickname)+" ("+e._s(r.track_status_zh)+")")]):e._e()]}}])})],1)],1)],1),e.adPageFlag&&!e.OriginalSearch?a("el-pagination",{attrs:{"current-page":e.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":e.search.limit,layout:"total, prev, pager, next, jumper",total:e.vuexTotal},on:{"current-change":e.adSizeChange,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)},"update:pageSize":function(t){return e.$set(e.search,"limit",t)},"update:page-size":function(t){return e.$set(e.search,"limit",t)}}}):a("el-pagination",{attrs:{"current-page":e.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":e.search.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getData,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)},"update:pageSize":function(t){return e.$set(e.search,"limit",t)},"update:page-size":function(t){return e.$set(e.search,"limit",t)}}})],1)},n=[],s=(a("b0c0"),a("a9e3"),a("ac1f"),a("5319"),a("841c"),a("96cf"),a("1da1")),c=a("f6b0"),i=a("dd77"),o={metaInfo:{title:"客户列表"},data:function(){return{levelLength:1,activeName:"999",adPageFlag:!1,OriginalSearch:void 0,first:!0,vuexTotal:this.$store.state.searchObj.total,searchStr:"",searchSelect:"username",customerListTableData:[],total:0,search:{page:1,limit:Number(localStorage.getItem("limit"))||50,order:"id",sort:"DESC",username:void 0,companyname:void 0,email:void 0,phonenumber:void 0,status:void 0,qq:void 0,custom:void 0,level:void 0},StatusOptions:[{label:"正常",value:1},{label:"停用",value:0},{label:"关闭",value:2}],searchOptions:[{label:"姓名",value:"username"},{label:"公司名",value:"companyname"},{label:"邮箱",value:"email"},{label:"QQ",value:"qq"},{label:"手机号",value:"phonenumber"},{label:"客户状态",value:"status"}],btnLoading:!1,tableLoading:!1}},methods:{openDoc:function(){open("https://www.idcsmart.com/wiki_list/366.html")},tabsStatusClick:function(e){"999"===e.name?(window.cancel(),this.search.page=1,delete this.search.level):(window.cancel(),this.search.page=1,this.search.level=e.name),this.getData()},adSearch:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,n,s,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r={},Object.assign(r,t.$route.query),r.page=e,r.table=t.$route.query.type,r.limit=Number(localStorage.getItem("limit"))||50,a.next=7,Object(i["a"])(r);case 7:n=a.sent,s=n.data,t.customerListTableData=s.list,t.vuexTotal=s.total,t.btnLoading=!1,c=JSON.parse(JSON.stringify(t.$route.query)),c.page=e,delete c.request_time,t.$router.replace({query:c});case 16:case"end":return a.stop()}}),a)})))()},adSizeChange:function(e){this.adSearch(e)},searchClick:function(){this.adPageFlag=!1,this.OriginalSearch=!0,this.btnLoading=!0,this.search.page=1,this.getData()},getData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,r,n,s,o,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.$route.query.type||e.OriginalSearch){t.next=19;break}return e.adPageFlag=!0,a={},Object.assign(a,e.$route.query),a.table=e.$route.query.type,a.limit=Number(localStorage.getItem("limit"))||50,a.customize&&(a.customfields=[],a.customfields[a.customize]=a.value),e.search.page=e.$route.query.page||1,delete a.type,delete a.customize,t.next=12,Object(i["a"])(e.$qs.stringify(a));case 12:r=t.sent,n=r.data,e.customerListTableData=n.list,e.vuexTotal=n.total,e.btnLoading=!1,t.next=50;break;case 19:if(!e.$store.state.adFlag||!e.first){t.next=28;break}e.adPageFlag=e.$store.state.adFlag,e.customerListTableData=e.$store.state.searchObj.list,e.vuexTotal=e.$store.state.searchObj.total,e.btnLoading=!1,e.first=!1,e.$store.commit("setAdFlag",!1),t.next=50;break;case 28:return e.search.username=void 0,e.search.companyname=void 0,e.search.email=void 0,e.search.phonenumber=void 0,e.search.status=void 0,e.search.qq=void 0,e.search.custom=void 0,"username"===e.searchSelect?e.search.username=e.searchStr:"companyname"===e.searchSelect?e.search.companyname=e.searchStr:"email"===e.searchSelect?e.search.email=e.searchStr:"phonenumber"===e.searchSelect?e.search.phonenumber=e.searchStr:"status"===e.searchSelect?e.search.status=e.searchStr:"qq"===e.searchSelect?e.search.qq=e.searchStr:(e.search.custom=[],e.search.custom[e.searchSelect]=e.searchStr),e.tableLoading=!0,t.next=39,Object(c["q"])(e.$qs.stringify(e.search));case 39:for(u in s=t.sent,o=s.data,e.customerListTableData=o.list,e.levelLength=o.level_search.length,o.level_search.unshift({id:999,level_name:"全部"}),e.total=o.total,e.btnLoading=!1,e.tableLoading=!1,l=[],o.search)l.push({label:o.search[u],value:u});e.searchOptions=l.reverse();case 50:case"end":return t.stop()}}),t)})))()},clearSearch:function(){"status"===this.searchSelect?(this.searchStr="",this.search.page=1,this.search.limit=Number(localStorage.getItem("limit"))||50,this.search.order="id",this.search.sort="DESC"):(this.search.page=1,this.search.limit=Number(localStorage.getItem("limit"))||50,this.search.order="id",this.search.sort="DESC")},goToView:function(e){this.$router.push({path:"/customer-view/abstract",query:{id:e}})},goToAddCustomer:function(){this.$router.push("/customer-add")},handleSizeChange:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.search.page=1,e.getData();case 2:case"end":return t.stop()}}),t)})))()},changeSort:function(e){if("amount_in"!==e.column.property&&"amount_out"!==e.column.property){if(!e.order)return this.getData(),!1;"descending"===e.order?(this.search.order=e.prop,this.search.sort="DESC"):(this.search.order=e.prop,this.search.sort="AESC"),this.getData()}}},beforeDestroy:function(){this.$store.commit("searchQuery",{}),this.$store.commit("setAdFlag",!1)},watch:{vuexData:function(e){this.adPageFlag=!0,this.customerListTableData=e.list,this.vuexTotal=e.total,this.btnLoading=!1,this.OriginalSearch=!1,this.first=!1,this.$store.commit("setAdFlag",!1)}},computed:{vuexData:function(){return this.$store.state.searchObj}},created:function(){this.getData()}},l=o,u=(a("e04b"),a("2877")),d=Object(u["a"])(l,r,n,!1,null,"3a471ddc",null);t["default"]=d.exports},"841c":function(e,t,a){"use strict";var r=a("d784"),n=a("825a"),s=a("1d80"),c=a("129f"),i=a("14c3");r("search",1,(function(e,t,a){return[function(t){var a=s(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,a):new RegExp(t)[e](String(a))},function(e){var r=a(t,e,this);if(r.done)return r.value;var s=n(e),o=String(this),l=s.lastIndex;c(l,0)||(s.lastIndex=0);var u=i(s,o);return c(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},ca94:function(e,t,a){},dd77:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("a27e");function n(e){return Object(r["a"])({url:"searchfornamelist",method:"post",data:e})}},e04b:function(e,t,a){"use strict";var r=a("ca94"),n=a.n(r);n.a},f6b0:function(e,t,a){"use strict";a.d(t,"q",(function(){return n})),a.d(t,"s",(function(){return s})),a.d(t,"n",(function(){return c})),a.d(t,"a",(function(){return i})),a.d(t,"r",(function(){return o})),a.d(t,"m",(function(){return l})),a.d(t,"l",(function(){return u})),a.d(t,"g",(function(){return d})),a.d(t,"j",(function(){return h})),a.d(t,"h",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"e",(function(){return f})),a.d(t,"u",(function(){return b})),a.d(t,"x",(function(){return g})),a.d(t,"c",(function(){return v})),a.d(t,"b",(function(){return _})),a.d(t,"p",(function(){return y})),a.d(t,"A",(function(){return S})),a.d(t,"k",(function(){return w})),a.d(t,"B",(function(){return O})),a.d(t,"t",(function(){return k})),a.d(t,"y",(function(){return j})),a.d(t,"z",(function(){return x})),a.d(t,"d",(function(){return $})),a.d(t,"v",(function(){return q})),a.d(t,"o",(function(){return D})),a.d(t,"i",(function(){return z})),a.d(t,"w",(function(){return C}));var r=a("a27e");function n(e){return Object(r["a"])({url:"client_list",method:"post",data:e})}function s(e){return Object(r["a"])({url:"summary?client_id=".concat(e)})}function c(){return Object(r["a"])({url:"create_client"})}function i(e){return Object(r["a"])({url:"create_client_post",method:"post",data:e})}function o(e){return Object(r["a"])({url:"profile/".concat(e)})}function l(e){return Object(r["a"])({url:"profile_post",method:"post",data:e})}function u(e){return Object(r["a"])({url:"delete_client/".concat(e)})}function d(e){return Object(r["a"])({url:"close_client/".concat(e)})}function h(e){return Object(r["a"])({url:"user_invoice",params:e})}function p(e,t){return Object(r["a"])({url:"close_client/".concat(e),params:t})}function m(e){return Object(r["a"])({url:"client_ticket",params:e})}function f(e){return Object(r["a"])({url:"log_record",params:e})}function b(e){return Object(r["a"])({url:"login_by_user/"+e})}function g(e){return Object(r["a"])({url:"certifi_person_detail/".concat(e)})}function v(e){return Object(r["a"])({url:"add_user_invoice",method:"post",data:e})}function _(e){return Object(r["a"])({url:"add_recharge_invoice/"+e.uid,method:"post",data:e})}function y(e){return Object(r["a"])({url:"get_user",params:e})}function S(e){return Object(r["a"])({url:"request_cancel_list",params:e})}function w(e){return Object(r["a"])({url:"request_cancel_list/".concat(e),method:"delete"})}function O(e){return Object(r["a"])({url:"searchlist",params:{value:e}})}function k(e){return Object(r["a"])({url:"hostbyuid",params:e})}function j(e){return Object(r["a"])({url:"clients_services/host_batch_renew_page",method:"post",data:e})}function x(e){return Object(r["a"])({url:"clients_services/host_batch_renew",method:"post",data:e})}function $(e){return Object(r["a"])({url:"clients_services/apply_credit",method:"post",data:e})}function q(e){return Object(r["a"])({url:"invoice/paid",params:e})}function D(e){return Object(r["a"])({url:"get_combine_invoices",params:e})}function z(e){return Object(r["a"])({url:"combine_invoices",method:"post",data:e})}function C(e){return Object(r["a"])({url:"post_client_notes",method:"post",data:e})}}}]);