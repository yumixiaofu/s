(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["DcimTraffic~31ecd969"],{"4f86":function(t,e,a){"use strict";a("5fdd")},"5fdd":function(t,e,a){},7041:function(t,e,a){var r=a("7ce6"),s=a("3086"),i=a("69a9"),o=s("species");t.exports=function(t){return i>=51||!r((function(){var e=[],a=e.constructor={};return a[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"8e8d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dcimTraffic"},[a("h5",{staticClass:"mt-0"},[t._v("创建流量包，所有关联流量包并限制流量的产品均可以订购流量包")]),a("div",{staticClass:"dcimTraffic_title"},[a("div",[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:t.showDialog}},[t._v("新增流量包")]),a("el-input",{style:{width:"200px",marginLeft:"10px"},attrs:{size:"small",placeholder:"按名称搜索",clearable:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("el-button",{attrs:{slot:"append",size:"small",icon:"el-icon-search"},on:{click:t.searchData},slot:"append"})],1)],1)]),a("div",{staticClass:"dcimTraffic_box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""},on:{"sort-change":t.changeSort}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"70",sortable:"custom",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"流量包名称"}}),a("el-table-column",{attrs:{prop:"capacity",label:"流量（GB）",sortable:"custom",width:"130"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",sortable:"custom"}}),a("el-table-column",{attrs:{prop:"status",label:"启用",sortable:"custom",width:"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":1,"inactive-value":0},on:{change:function(e){return t.changeSataus(e,r.id)}},model:{value:r.status,callback:function(e){t.$set(r,"status",e)},expression:"row.status"}})]}}])}),a("el-table-column",{attrs:{prop:"sale_times",label:"已售/库存",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.sale_times+"/"+(a.stock?a.stock:"不限"))+" ")]}}])}),a("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"135",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v(" "+t._s(a.create_time?t.$moment(1e3*a.create_time).format("YYYY-MM-DD HH:mm"):"-")+" ")]}}])}),a("el-table-column",{attrs:{label:"管理",width:"140",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[a("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(e){return t.showEditDialog(r.id)}}},[t._v("编辑")]),a("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(e){return t.deleteTraffic(r.id)}}},[t._v("删除")])]}}])})],1)],1),a("el-pagination",{attrs:{"current-page":t.page,"page-sizes":[10,15,20,25,50,100],"page-size":t.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"新增流量包",visible:t.addDialogVisible,width:"50%"},on:{"update:visible":function(e){t.addDialogVisible=e},close:t.onClose}},[a("el-row",{attrs:{gutter:15}},[a("el-form",{ref:"addTrafficFormRef",attrs:{model:t.addTrafficFormData,rules:t.addTrafficFormRules,"label-width":"auto"}},[a("el-col",{attrs:{span:23}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入名称",clearable:""},model:{value:t.addTrafficFormData.name,callback:function(e){t.$set(t.addTrafficFormData,"name",e)},expression:"addTrafficFormData.name"}})],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"流量包大小",prop:"capacity"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:1,controls:!1},model:{value:t.addTrafficFormData.capacity,callback:function(e){t.$set(t.addTrafficFormData,"capacity",e)},expression:"addTrafficFormData.capacity"}})],1),a("el-col",{attrs:{span:12,offset:1}},[t._v(" G ")])],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:.01,controls:!1,precision:2},model:{value:t.addTrafficFormData.price,callback:function(e){t.$set(t.addTrafficFormData,"price",e)},expression:"addTrafficFormData.price"}})],1),a("el-col",{attrs:{span:12,offset:1}})],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"选择则,启用"},model:{value:t.addTrafficFormData.status,callback:function(e){t.$set(t.addTrafficFormData,"status",e)},expression:"addTrafficFormData.status"}})],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"库存",prop:"stock"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:0,controls:!1},model:{value:t.addTrafficFormData.stock,callback:function(e){t.$set(t.addTrafficFormData,"stock",e)},expression:"addTrafficFormData.stock"}})],1),a("el-col",{attrs:{span:12,offset:1}},[t._v(" 0则表示不限 ")])],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"可绑定的产品",prop:"allow_products"}},[a("el-select",{style:{width:"100%"},attrs:{size:"small",filterable:"","collapse-tags":"",multiple:"",placeholder:"请选择可绑定的产品"},model:{value:t.addTrafficFormData.allow_products,callback:function(e){t.$set(t.addTrafficFormData,"allow_products",e)},expression:"addTrafficFormData.allow_products"}},t._l(t.options,(function(e){return a("el-option-group",{key:e.id,attrs:{label:e.name}},t._l(e.product,(function(t,e){return a("el-option",{key:t.id+"assd"+e,attrs:{label:t.name,value:t.id}})})),1)})),1)],1)],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.addCancel}},[t._v("取消更改")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addTraffic}},[t._v("保存更改")])],1)],1),a("el-dialog",{attrs:{title:"编辑流量包",visible:t.editDialogVisible,width:"50%"},on:{"update:visible":function(e){t.editDialogVisible=e},close:t.onCloseEdit}},[a("el-row",{attrs:{gutter:15}},[a("el-form",{ref:"editTrafficFormRef",attrs:{model:t.editTrafficFormData,rules:t.addTrafficFormRules,"label-width":"auto"}},[a("el-col",{attrs:{span:23}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入名称",clearable:""},model:{value:t.editTrafficFormData.name,callback:function(e){t.$set(t.editTrafficFormData,"name",e)},expression:"editTrafficFormData.name"}})],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"流量包大小",prop:"capacity"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:1,controls:!1},model:{value:t.editTrafficFormData.capacity,callback:function(e){t.$set(t.editTrafficFormData,"capacity",e)},expression:"editTrafficFormData.capacity"}})],1),a("el-col",{attrs:{span:12,offset:1}},[t._v(" G ")])],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"价格",prop:"price"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:.01,controls:!1,precision:2},model:{value:t.editTrafficFormData.price,callback:function(e){t.$set(t.editTrafficFormData,"price",e)},expression:"editTrafficFormData.price"}})],1),a("el-col",{attrs:{span:12,offset:1}})],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"选择则,启用"},model:{value:t.editTrafficFormData.status,callback:function(e){t.$set(t.editTrafficFormData,"status",e)},expression:"editTrafficFormData.status"}})],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"库存",prop:"stock"}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small",min:0,controls:!1},model:{value:t.editTrafficFormData.stock,callback:function(e){t.$set(t.editTrafficFormData,"stock",e)},expression:"editTrafficFormData.stock"}})],1),a("el-col",{attrs:{span:12,offset:1}},[t._v(" 0则表示不限 ")])],1)],1)],1),a("el-col",{attrs:{span:23}},[a("el-form-item",{attrs:{label:"可绑定的产品",prop:"allow_products"}},[a("el-select",{style:{width:"100%"},attrs:{size:"small",filterable:"","collapse-tags":"",multiple:"",placeholder:"请选择可绑定的产品",clearable:""},model:{value:t.editTrafficFormData.allow_products,callback:function(e){t.$set(t.editTrafficFormData,"allow_products",e)},expression:"editTrafficFormData.allow_products"}},t._l(t.editOptions,(function(e){return a("el-option-group",{key:e.id,attrs:{label:e.name}},t._l(e.product,(function(t,e){return a("el-option",{key:t.id+"a2sd"+e,attrs:{label:t.name,value:t.id}})})),1)})),1)],1)],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:t.editCancel}},[t._v("取消更改")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.editTraffic}},[t._v("保存更改")])],1)],1)],1)},s=[],i=a("60b5"),o=(a("6a61"),a("24a8"),a("c22d"),a("9b5f"),a("1d43"),a("3bae"),a("bf2f"),a("a27e"));function l(t,e,a,r,s){return Object(o["a"])({url:"dcim/flowpacket",params:{page:t,limit:e,orderby:a,sort:r,search:s}})}function n(){return Object(o["a"])({url:"dcim/flowpacket_page"})}function c(t){return Object(o["a"])({url:"dcim/flowpacket",method:"post",data:t})}function u(t){return Object(o["a"])({url:"dcim/flowpacket_page/".concat(t)})}function f(t){return Object(o["a"])({url:"dcim/flowpacket",method:"put",data:t})}function d(t){return Object(o["a"])({url:"dcim/flowpacket",method:"delete",data:{id:t}})}var p={metaInfo:{title:"流量包设置"},data:function(){return{tableData:[],page:1,limit:Number(localStorage.getItem("limit"))||50,total:0,orderby:"id",sort:"desc",search:"",addDialogVisible:!1,addTrafficFormData:{name:"",capacity:0,price:.01,status:0,stock:0,allow_products:[]},addTrafficFormRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],capacity:[{required:!0,message:"请输入流量包大小",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"}]},options:[],editDialogVisible:!1,editTrafficFormData:{id:0,name:"",capacity:0,price:.01,status:0,stock:0,allow_products:[]},editOptions:[]}},methods:{getData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,l(t.page,t.limit,t.orderby,t.sort,t.search);case 2:if(a=e.sent,r=a.data,200===r.status){e.next=6;break}return e.abrupt("return",!1);case 6:t.tableData=r.data.list,t.total=r.data.sum,t.orderby=r.data.orderby;case 9:case"end":return e.stop()}}),e)})))()},handleSizeChange:function(t){this.limit=t,this.getData()},handleCurrentChange:function(t){this.page=t,this.getData()},changeSort:function(t){"descending"===t.order?(this.orderby=t.prop,this.sort="desc"):(this.orderby=t.prop,this.sort="asc"),this.getData()},searchData:function(){this.getData()},changeSataus:function(t,e){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={id:e,status:t},r.next=3,f(s);case 3:if(i=r.sent,o=i.data,200===o.status){r.next=8;break}return a.$message({message:o.msg,type:"error"}),r.abrupt("return",!1);case 8:a.$message({message:o.msg,type:"success"}),a.getData();case 10:case"end":return r.stop()}}),r)})))()},showDialog:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(a=e.sent,r=a.data,200===r.status){e.next=6;break}return e.abrupt("return",!1);case 6:t.options=r.data.products,t.addDialogVisible=!0;case 8:case"end":return e.stop()}}),e)})))()},addCancel:function(){this.$refs.addTrafficFormRef.resetFields(),this.addDialogVisible=!1},onClose:function(){this.$refs.addTrafficFormRef.resetFields()},addTraffic:function(){var t=this;this.$refs.addTrafficFormRef.validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=13;break}return e.next=3,c(t.addTrafficFormData);case 3:if(r=e.sent,s=r.data,200===s.status){e.next=8;break}return t.$message({message:s.msg,type:"error"}),e.abrupt("return",!1);case 8:t.$message({message:s.msg,type:"success"}),t.addDialogVisible=!1,t.getData(),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},deleteTraffic:function(t){var e=this;this.$confirm("此操作将永久删除该流量包, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,d(t);case 2:if(r=a.sent,s=r.data,200===s.status){a.next=7;break}return e.$message({type:"error",message:s.msg}),a.abrupt("return",!1);case 7:e.$message({type:"success",message:"删除成功!"}),e.getData();case 9:case"end":return a.stop()}}),a)})))).catch((function(){e.$message({type:"info",message:"已取消本次操作!"})}))},showEditDialog:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,u(t);case 2:if(r=a.sent,s=r.data,200===s.status){a.next=7;break}return e.$message({message:s.msg,type:"error"}),a.abrupt("return",!1);case 7:e.editTrafficFormData.id=s.flowpacket.id,e.editTrafficFormData.name=s.flowpacket.name,e.editTrafficFormData.capacity=s.flowpacket.capacity,e.editTrafficFormData.price=s.flowpacket.price,e.editTrafficFormData.status=s.flowpacket.status,e.editTrafficFormData.stock=s.flowpacket.stock,(s.flowpacket.allow_products||[]).forEach((function(t,e){0===t&&s.flowpacket.allow_products.splice(e,1)})),e.editTrafficFormData.allow_products=s.flowpacket.allow_products,e.editOptions=s.products,e.editDialogVisible=!0;case 17:case"end":return a.stop()}}),a)})))()},editCancel:function(){this.$refs.editTrafficFormRef.resetFields(),this.editDialogVisible=!1},onCloseEdit:function(){this.$refs.editTrafficFormRef.resetFields()},editTraffic:function(){var t=this;this.$refs.editTrafficFormRef.validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(a){var r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=13;break}return e.next=3,f(t.editTrafficFormData);case 3:if(r=e.sent,s=r.data,200===s.status){e.next=8;break}return t.$message({type:"error",message:s.msg}),e.abrupt("return",!1);case 8:t.$message({type:"success",message:s.msg}),t.editDialogVisible=!1,t.getData(),e.next=14;break;case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},created:function(){this.getData()},watch:{search:function(t){""===t&&this.getData()}}},m=p,b=(a("4f86"),a("5d22")),g=Object(b["a"])(m,r,s,!1,null,"b2138f2a",null);e["default"]=g.exports},"98a5":function(t,e,a){"use strict";var r=a("3de9"),s=a("d320"),i=a("1f88");t.exports=function(t,e,a){var o=r(e);o in t?s.f(t,o,i(0,a)):t[o]=a}},a756:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},bf2f:function(t,e,a){"use strict";var r=a("1f04"),s=a("5156"),i=a("e6d2"),o=a("a187"),l=a("f8d3"),n=a("6827"),c=a("98a5"),u=a("7041"),f=u("splice"),d=Math.max,p=Math.min,m=9007199254740991,b="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!f},{splice:function(t,e){var a,r,u,f,g,h,v=l(this),w=o(v.length),D=s(t,w),k=arguments.length;if(0===k?a=r=0:1===k?(a=0,r=w-D):(a=k-2,r=p(d(i(e),0),w-D)),w+a-r>m)throw TypeError(b);for(u=n(v,r),f=0;f<r;f++)g=D+f,g in v&&c(u,f,v[g]);if(u.length=r,a<r){for(f=D;f<w-r;f++)g=f+r,h=f+a,g in v?v[h]=v[g]:delete v[h];for(f=w;f>w-r+a;f--)delete v[f-1]}else if(a>r)for(f=w-r;f>D;f--)g=f+r-1,h=f+a-1,g in v?v[h]=v[g]:delete v[h];for(f=0;f<a;f++)v[f+D]=arguments[f+2];return v.length=w-r+a,u}})},c22d:function(t,e,a){"use strict";var r=a("9194"),s=a("baa9"),i=a("4023"),o=a("a756"),l=a("1a58");r("search",1,(function(t,e,a){return[function(e){var a=i(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,a):new RegExp(e)[t](String(a))},function(t){var r=a(e,t,this);if(r.done)return r.value;var i=s(t),n=String(this),c=i.lastIndex;o(c,0)||(i.lastIndex=0);var u=l(i,n);return o(i.lastIndex,c)||(i.lastIndex=c),null===u?-1:u.index}]}))}}]);